2018-01-22 09:39:22.238  INFO 10944 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/webjars/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:39:22.252  INFO 10944 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:39:22.305  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in baseController
2018-01-22 09:39:22.306  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in diseaseController
2018-01-22 09:39:22.308  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in medicareController
2018-01-22 09:39:22.308  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in loginController
2018-01-22 09:39:22.309  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in rangeController
2018-01-22 09:39:22.309  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in userController
2018-01-22 09:39:22.309  INFO 10944 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in earlyWarningController
2018-01-22 09:39:22.373  INFO 10944 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**/favicon.ico] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:39:23.216  INFO 10944 --- [main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
2018-01-22 09:39:23.226  INFO 10944 --- [main] o.s.c.support.DefaultLifecycleProcessor  : Starting beans in phase 2147483647
2018-01-22 09:39:23.226  INFO 10944 --- [main] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2018-01-22 09:39:23.241  INFO 10944 --- [main] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2018-01-22 09:39:23.272  INFO 10944 --- [main] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2018-01-22 09:39:23.498  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: addUsingPOST_1
2018-01-22 09:39:23.505  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: delUsingPOST_1
2018-01-22 09:39:23.512  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: findUsingPOST_1
2018-01-22 09:39:23.545  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: updateUsingPOST_1
2018-01-22 09:39:24.750  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: addUsingPOST_2
2018-01-22 09:39:24.757  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: delUsingPOST_2
2018-01-22 09:39:24.764  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: findUsingPOST_2
2018-01-22 09:39:24.771  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: importFileUsingPOST_1
2018-01-22 09:39:24.776  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: importFileUsingGET_1
2018-01-22 09:39:24.784  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: updateUsingPOST_2
2018-01-22 09:39:24.791  INFO 10944 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadUsingPOST_1
2018-01-22 09:39:24.817  INFO 10944 --- [main] s.a.ScheduledAnnotationBeanPostProcessor : No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2018-01-22 09:39:24.866  INFO 10944 --- [main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 9998 (http)
2018-01-22 09:39:24.871  INFO 10944 --- [main] com.firesoon.drgs.DrgsApplication        : Started DrgsApplication in 7.916 seconds (JVM running for 8.722)
2018-01-22 09:39:27.139  INFO 10944 --- [http-nio-9998-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/drgs]   : Initializing Spring FrameworkServlet 'dispatcherServlet'
2018-01-22 09:39:27.139  INFO 10944 --- [http-nio-9998-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization started
2018-01-22 09:39:27.166  INFO 10944 --- [http-nio-9998-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization completed in 26 ms
2018-01-22 09:39:27.738 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 09:39:27.806 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:39:27.834 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:41:22.742 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:41:22.742 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:41:22.749 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:41:23.439 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 09:41:23.439 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 09:41:23.440 DEBUG 10944 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 09:41:23.440 DEBUG 10944 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 09:41:23.445 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:41:23.445 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:41:23.447 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 09:41:23.447 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:41:23.453 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 09:41:23.455 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 09(String), 2018-01-22 09(String)
2018-01-22 09:41:23.469 DEBUG 10944 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 09:41:23.483 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:41:23.484 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 09:41:23.615 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 09:41:23.641 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:41:45.690 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:41:45.690 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:41:45.703 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:41:45.708 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:41:45.708 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:45.866 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:41:45.866 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:41:45.866 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:46.024 DEBUG 10944 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-22 09:41:51.021 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:41:51.021 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:41:51.033 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:41:51.038 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:41:51.039 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:51.276 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:41:51.277 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通','省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:41:51.277 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:51.511 DEBUG 10944 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-22 09:41:52.846 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:41:52.846 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:41:52.859 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:41:52.863 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:41:52.864 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:53.096 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:41:53.097 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:41:53.098 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:53.334 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-22 09:41:59.158 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:41:59.159 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:41:59.171 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:41:59.175 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:41:59.175 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:59.388 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:41:59.388 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:41:59.388 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:41:59.611 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-22 09:42:02.256 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:42:02.257 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:42:02.269 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:42:02.273 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:42:02.273 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:42:02.491 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:42:02.492 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:42:02.492 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:42:02.714 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-22 09:42:04.260 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:42:04.260 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:42:04.273 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:42:04.276 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:42:04.276 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:42:04.296 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:42:05.741 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:42:05.741 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:42:05.754 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:42:05.757 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:42:05.757 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:42:05.956 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:42:05.956 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:42:05.957 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-22 16(String)
2018-01-22 09:42:06.158 DEBUG 10944 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-22 09:42:17.809 DEBUG 10944 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:42:17.810 DEBUG 10944 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:42:17.813 DEBUG 10944 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:42:18.442 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:42:18.442 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:42:18.466 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:42:18.467 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:42:18.611 DEBUG 10944 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:42:18.629 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:42:18.629 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:42:18.630 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:42:18.644 DEBUG 10944 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:42:26.034 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:42:26.034 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:42:26.040 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:42:26.040 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:42:26.189 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:42:26.189 DEBUG 10944 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:42:26.189 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:42:26.189 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:42:26.203 DEBUG 10944 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:42:28.493 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:42:28.494 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:42:28.499 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:42:28.499 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:42:28.643 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:42:28.643 DEBUG 10944 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:42:28.643 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:42:28.643 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:42:28.658 DEBUG 10944 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:43:05.544  INFO 9000 --- [main] com.firesoon.drgs.DrgsApplication        : Starting DrgsApplication on TSJ0573 with PID 9000 (E:\ideaworkspace\DRGs\target\classes started by yingjie.chen in E:\ideaworkspace\DRGs)
2018-01-22 09:43:05.547  INFO 9000 --- [main] com.firesoon.drgs.DrgsApplication        : No active profile set, falling back to default profiles: default
2018-01-22 09:43:05.596  INFO 9000 --- [main] ationConfigEmbeddedWebApplicationContext : Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@700fb871: startup date [Mon Jan 22 09:43:05 CST 2018]; root of context hierarchy
2018-01-22 09:43:06.430  INFO 9000 --- [main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'dataSource' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Dbcp2; factoryMethodName=dataSource; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Dbcp2.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Tomcat; factoryMethodName=dataSource; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Tomcat.class]]
2018-01-22 09:43:06.494  INFO 9000 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2018-01-22 09:43:06.566  INFO 9000 --- [main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'propertySourcesPlaceholderConfigurer' with a different definition: replacing [Root bean: class [org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=propertySourcesPlaceholderConfigurer; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/context/PropertyPlaceholderAutoConfiguration.class]] with [Root bean: class [org.springframework.boot.autoconfigure.session.RedisSessionConfiguration$SpringBootRedisHttpSessionConfiguration]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=propertySourcesPlaceholderConfigurer; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/session/RedisSessionConfiguration$SpringBootRedisHttpSessionConfiguration.class]]
2018-01-22 09:43:06.743  INFO 9000 --- [main] f.a.AutowiredAnnotationBeanPostProcessor : JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-01-22 09:43:06.766  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'shiroCasConfiguration' of type [com.firesoon.drgs.shiro.cas.ShiroCasConfiguration$$EnhancerBySpringCGLIB$$bbb576c6] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:06.878  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'getEhCacheManager' of type [org.apache.shiro.cache.ehcache.EhCacheManager] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:06.882  INFO 9000 --- [main] o.a.shiro.cache.ehcache.EhCacheManager   : Cache with name 'com.firesoon.drgs.shiro.cas.MyShiroCasRealm.authorizationCache' does not yet exist.  Creating now.
2018-01-22 09:43:06.900  INFO 9000 --- [main] o.a.shiro.cache.ehcache.EhCacheManager   : Added EhCache named [com.firesoon.drgs.shiro.cas.MyShiroCasRealm.authorizationCache]
2018-01-22 09:43:07.103  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'mybatis-org.mybatis.spring.boot.autoconfigure.MybatisProperties' of type [org.mybatis.spring.boot.autoconfigure.MybatisProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.112  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration' of type [org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$bece7d9] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.119  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Tomcat' of type [org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Tomcat] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.136  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties' of type [org.springframework.boot.autoconfigure.jdbc.DataSourceProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.208  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'dataSource' of type [org.apache.tomcat.jdbc.pool.DataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.418  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'sqlSessionFactory' of type [org.apache.ibatis.session.defaults.DefaultSqlSessionFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.429  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'sqlSessionTemplate' of type [org.mybatis.spring.SqlSessionTemplate] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.430  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'userMapper' of type [org.mybatis.spring.mapper.MapperFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.432  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'userMapper' of type [com.sun.proxy.$Proxy64] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.437  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'userSerivceImpl' of type [com.firesoon.drgs.services.user.impl.UserSerivceImpl] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.461  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'myShiroCasRealm' of type [com.firesoon.drgs.shiro.cas.MyShiroCasRealm] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.613  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'securityManager' of type [org.apache.shiro.web.mgt.DefaultWebSecurityManager] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.624  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'cas' of type [com.firesoon.drgs.shiro.cas.filter.CasFilter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.632  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'user' of type [com.firesoon.drgs.shiro.cas.filter.UserFilter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.691  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$d91896a9] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:07.706  INFO 9000 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'getAuthorizationAttributeSourceAdvisor' of type [org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:43:08.026  INFO 9000 --- [main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat initialized with port(s): 9998 (http)
2018-01-22 09:43:08.035  INFO 9000 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2018-01-22 09:43:08.036  INFO 9000 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/8.5.23
2018-01-22 09:43:08.173  INFO 9000 --- [localhost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/drgs]   : Initializing Spring embedded WebApplicationContext
2018-01-22 09:43:08.173  INFO 9000 --- [localhost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 2580 ms
2018-01-22 09:43:08.762  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2018-01-22 09:43:08.762  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'springSessionRepositoryFilter' to: [/*]
2018-01-22 09:43:08.762  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2018-01-22 09:43:08.762  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpPutFormContentFilter' to: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'singleSignOutFilter' to urls: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'delegatingFilterProxy' to urls: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'shiroFilter' to: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'cas' to: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'user' to: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'logout' to: [/*]
2018-01-22 09:43:08.763  INFO 9000 --- [localhost-startStop-1] o.s.b.w.servlet.ServletRegistrationBean  : Mapping servlet: 'dispatcherServlet' to [/]
2018-01-22 09:43:08.779  INFO 9000 --- [localhost-startStop-1] o.j.c.c.session.SingleSignOutFilter      : Property [artifactParameterName] not found.  Using default value [ticket]
2018-01-22 09:43:08.779  INFO 9000 --- [localhost-startStop-1] o.j.c.c.session.SingleSignOutFilter      : Property [logoutParameterName] not found.  Using default value [logoutRequest]
2018-01-22 09:43:09.769  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/enable],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.enable(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:43:09.770  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/add],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.add(java.util.List<com.firesoon.drgs.dto.disease.Disease>)
2018-01-22 09:43:09.770  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/update],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.update(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:43:09.771  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/find],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.find(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:43:09.771  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/upload],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.upload(org.springframework.web.multipart.MultipartFile,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:43:09.771  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/import],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.importFile(java.lang.String,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:43:09.772  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/findDisease],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.findDisease(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:43:09.772  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/findMedicare],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.findMedicare(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:43:09.772  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/getFilterData],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.getFilterData(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.772  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/del],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.del(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:43:09.773  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/importProjectsettlement],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.importProjectsettlement(java.lang.String,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:43:09.780  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/export],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.export(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.780  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportDateReport],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportDateReport(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.781  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportPatient],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportPatient(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.782  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportMonitor],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportMonitor(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.782  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getTitle],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getTitle(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.782  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getMedicares],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getMedicares(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.783  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getDetail],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getDetail(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.783  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/costMonitoring],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.costMonitoring(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.784  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getDetailMsg],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getDetailMsg(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.784  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/outMedicare],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.outMedicare(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.785  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/testdownload],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.testdownload(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.785  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/testdownloadword],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.testdownloadword(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.785  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findZhiFuBZ],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findZhiFuBZ(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.786  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportMedicareSettlementListDetail],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportMedicareSettlementListDetail(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.786  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportTotalCostForm],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportTotalCostForm(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.786  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findDateReportChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findDateReportChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.787  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getMedicareDateReport],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getMedicareDateReport(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.787  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadKongFeiBLS],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadKongFeiBLS(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.787  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadKongFeiZFY],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadKongFeiZFY(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.787  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findPerHospitalReportChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findPerHospitalReportChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.788  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findPerHospitalReportPieChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findPerHospitalReportPieChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.788  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.788  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportPieChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportPieChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.789  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findMedicareSettlementList],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findMedicareSettlementList(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.789  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/cancelOutmedicare],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.cancelOut_medicare(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.789  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportMedicareSettlementList],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportMedicareSettlementList(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.790  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportForm],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportForm(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.790  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/tuichuyibaokfjsbl],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.tuichuyibaokfjsbl(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.790  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/tuichuyibaokfjsblxx],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.tuichuyibaokfjsblxx(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.790  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findFeiKongFeiTZ],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findFeiKongFeiZhuZhenDuanTZ(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.791  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadFeiKongFeiTZ],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadFeiKongFeiZhuZhenDuanTZ(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.791  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadtuichuyibaokfjsblxx],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadtuichuyibaokfjsblxx(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.791  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/saveFeiKongFeiZhuZhenDuanTZ],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.saveFeiKongFeiZhuZhenDuanTZ(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.792  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getFeiKongFeiTitle],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getFeiKongFeiTitle(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.792  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getXiangMuJieSuanKKBL],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getXiangMuJieSuanKKBL(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.792  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadXiangMuJieSuanKKBL],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadXiangMuJieSuanKKBL(java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.792  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getXiangMuJieSuanKKMX],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getXiangMuJieSuanKKXX(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.793  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findApplicationtemplatecol],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findApplicationtemplatecol()
2018-01-22 09:43:09.793  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/addApplicationtemplate],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.addApplicationtemplate(java.util.ArrayList<java.util.Map<java.lang.String, java.lang.Object>>)
2018-01-22 09:43:09.793  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findApplicationtemplate],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findApplicationtemplate()
2018-01-22 09:43:09.793  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportNoSettledPatient],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportNoSettledPatient(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:43:09.794  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findNoSettledPatient],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findNoSettledPatient(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.794  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findNoSettledPatientTitle],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findNoSettledPatientTitle(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:43:09.795  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/login],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.login.LoginController.login(com.firesoon.drgs.dto.user.User)
2018-01-22 09:43:09.795  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/logout],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.login.LoginController.logout()
2018-01-22 09:43:09.796  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/add],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.add(java.util.List<com.firesoon.drgs.dto.range.Range>)
2018-01-22 09:43:09.796  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/update],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.update(com.firesoon.drgs.dto.range.Range)
2018-01-22 09:43:09.796  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/find],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.find(com.firesoon.drgs.dto.range.Range)
2018-01-22 09:43:09.796  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/upload],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.upload(org.springframework.web.multipart.MultipartFile,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:43:09.797  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/import],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.importFile(java.lang.String,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:43:09.797  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/del],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.del(com.firesoon.drgs.dto.range.Range)
2018-01-22 09:43:09.797  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/user/findUser],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.user.UserController.findUser(com.firesoon.drgs.dto.user.User)
2018-01-22 09:43:09.799  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/add],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.add(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:43:09.799  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/update],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.update(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:43:09.800  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/find],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.find(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:43:09.800  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getParams],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getParams()
2018-01-22 09:43:09.800  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getCondition],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getCondition()
2018-01-22 09:43:09.801  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getDoctors],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getDoctors()
2018-01-22 09:43:09.801  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getNotices],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getNotices()
2018-01-22 09:43:09.801  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getCondiValues],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getCondiValues()
2018-01-22 09:43:09.801  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/del],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.del(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:43:09.805  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/swagger-resources/configuration/ui]}" onto public org.springframework.http.ResponseEntity<springfox.documentation.swagger.web.UiConfiguration> springfox.documentation.swagger.web.ApiResourceController.uiConfiguration()
2018-01-22 09:43:09.806  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/swagger-resources]}" onto public org.springframework.http.ResponseEntity<java.util.List<springfox.documentation.swagger.web.SwaggerResource>> springfox.documentation.swagger.web.ApiResourceController.swaggerResources()
2018-01-22 09:43:09.806  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/swagger-resources/configuration/security]}" onto public org.springframework.http.ResponseEntity<springfox.documentation.swagger.web.SecurityConfiguration> springfox.documentation.swagger.web.ApiResourceController.securityConfiguration()
2018-01-22 09:43:09.809  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/error]}" onto public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.Object>> org.springframework.boot.autoconfigure.web.BasicErrorController.error(javax.servlet.http.HttpServletRequest)
2018-01-22 09:43:09.809  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/error],produces=[text/html]}" onto public org.springframework.web.servlet.ModelAndView org.springframework.boot.autoconfigure.web.BasicErrorController.errorHtml(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)
2018-01-22 09:43:10.041  INFO 9000 --- [main] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2018-01-22 09:43:10.473  INFO 9000 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : Looking for @ControllerAdvice: org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@700fb871: startup date [Mon Jan 22 09:43:05 CST 2018]; root of context hierarchy
2018-01-22 09:43:10.613  INFO 9000 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/webjars/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:43:10.613  INFO 9000 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:43:10.664  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in baseController
2018-01-22 09:43:10.665  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in diseaseController
2018-01-22 09:43:10.666  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in medicareController
2018-01-22 09:43:10.667  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in loginController
2018-01-22 09:43:10.667  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in rangeController
2018-01-22 09:43:10.667  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in userController
2018-01-22 09:43:10.668  INFO 9000 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in earlyWarningController
2018-01-22 09:43:10.726  INFO 9000 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**/favicon.ico] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:43:11.591  INFO 9000 --- [main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
2018-01-22 09:43:11.602  INFO 9000 --- [main] o.s.c.support.DefaultLifecycleProcessor  : Starting beans in phase 2147483647
2018-01-22 09:43:11.602  INFO 9000 --- [main] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2018-01-22 09:43:11.616  INFO 9000 --- [main] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2018-01-22 09:43:11.648  INFO 9000 --- [main] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2018-01-22 09:43:11.877  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: addUsingPOST_1
2018-01-22 09:43:11.883  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: delUsingPOST_1
2018-01-22 09:43:11.890  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: findUsingPOST_1
2018-01-22 09:43:11.924  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: updateUsingPOST_1
2018-01-22 09:43:13.096  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: addUsingPOST_2
2018-01-22 09:43:13.104  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: delUsingPOST_2
2018-01-22 09:43:13.113  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: findUsingPOST_2
2018-01-22 09:43:13.123  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: importFileUsingPOST_1
2018-01-22 09:43:13.128  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: importFileUsingGET_1
2018-01-22 09:43:13.136  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: updateUsingPOST_2
2018-01-22 09:43:13.143  INFO 9000 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadUsingPOST_1
2018-01-22 09:43:13.187  INFO 9000 --- [main] s.a.ScheduledAnnotationBeanPostProcessor : No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2018-01-22 09:43:13.241  INFO 9000 --- [main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 9998 (http)
2018-01-22 09:43:13.245  INFO 9000 --- [main] com.firesoon.drgs.DrgsApplication        : Started DrgsApplication in 8.045 seconds (JVM running for 9.106)
2018-01-22 09:43:54.186  INFO 9000 --- [http-nio-9998-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/drgs]   : Initializing Spring FrameworkServlet 'dispatcherServlet'
2018-01-22 09:43:54.187  INFO 9000 --- [http-nio-9998-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization started
2018-01-22 09:43:54.207  INFO 9000 --- [http-nio-9998-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization completed in 20 ms
2018-01-22 09:43:54.767 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:43:54.779 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:43:54.813 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:43:54.846 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:43:54.846 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:43:54.846 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:43:54.872 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:43:55.060 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:43:55.060 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:43:55.063 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:43:55.063 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:43:55.069 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:43:58.012 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:43:58.013 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:43:58.016 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:43:58.017 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:43:58.147 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:43:58.147 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:43:58.147 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:43:58.147 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:43:58.153 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:44:06.353 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:44:06.354 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:44:06.359 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:44:06.360 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:44:06.493 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:44:06.494 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:44:06.495 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:44:06.499 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:44:06.499 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:44:42.331 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:44:42.331 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:44:42.337 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:44:42.337 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:44:42.459 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:44:42.459 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:44:42.459 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:44:42.460 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:44:42.464 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:45:04.056 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%xxxxx%' OR doctorname LIKE '%xxxxx%') 
2018-01-22 09:45:04.057 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:45:04.062 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:45:19.241 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:45:19.242 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:45:19.247 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:45:19.558 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:45:19.559 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:45:19.565 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:45:19.566 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:45:19.684 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:45:19.696 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:45:19.697 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:45:19.697 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:45:19.703 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:45:22.477 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:45:22.478 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:45:22.486 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:45:22.486 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:45:22.611 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:45:22.617 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:45:22.618 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:45:22.618 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:45:22.622 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:02.732 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:46:02.732 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:46:02.737 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:46:03.088 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:03.088 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:03.096 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:03.096 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:03.212 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:03.230 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:03.230 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:03.230 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:03.234 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:09.867 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:46:09.867 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:46:09.870 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:46:10.173 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:10.173 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:10.181 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:10.181 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:10.304 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:10.309 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:10.310 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:10.310 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:10.315 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:14.632 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:14.634 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:14.637 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:14.637 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:14.797 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:14.804 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:14.804 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:14.804 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:14.808 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:15.985 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:15.985 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:15.991 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-06', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:15.992 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:16.147 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:16.148 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:16.148 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:16.149 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:16.153 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:20.319 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:20.319 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:20.324 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-06', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:20.324 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:20.473 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:20.479 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:20.480 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:20.480 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:20.484 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:21.441 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:21.442 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:21.448 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-08', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:21.448 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:21.613 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:21.613 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:21.614 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:21.614 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:21.618 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:29.672 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:29.673 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:29.678 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-12', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:29.678 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:29.839 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:29.839 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:29.840 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:29.840 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:29.843 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:30.557 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-09', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-09', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:30.557 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:30.563 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-10', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-09', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-09', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:30.564 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:30.727 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:30.727 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:30.727 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:30.727 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:30.731 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:48.279 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:46:48.280 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:46:48.284 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:46:48.599 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 09:46:48.600 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 09:46:48.606 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 09:46:48.607 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 09:46:48.738 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 09:46:48.744 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 09:46:48.745 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 09:46:48.745 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:46:48.749 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:46:59.428 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:46:59.429 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:46:59.432 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:03.283 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:03.283 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:03.286 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:04.437 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:04.437 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:04.441 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:04.875 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 09:47:04.876 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 09(String), 2018-01-22 09(String)
2018-01-22 09:47:04.877 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:47:04.878 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:47:04.880 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:47:04.881 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 09:47:04.882 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 09:47:04.882 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 09:47:04.882 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 09:47:04.884 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:47:04.885 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 09:47:04.898 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 09:47:04.899 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 09:47:04.988 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 09:47:04.989 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:47:06.117 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:06.117 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:06.120 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:39.457 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:39.458 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:39.461 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:40.372 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 09:47:40.373 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 09(String), 2018-01-22 09(String)
2018-01-22 09:47:40.376 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:47:40.377 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:47:40.377 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 09:47:40.377 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:40.377 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 09:47:40.377 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:40.378 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 09:47:40.379 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 09:47:40.381 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:40.394 DEBUG 9000 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 09:47:40.395 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:47:40.397 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:47:40.398 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 09:47:40.401 DEBUG 9000 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 09:47:40.475 DEBUG 9000 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 09:47:40.556 DEBUG 9000 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:47:42.832 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:42.832 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:42.836 DEBUG 9000 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:43.513 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 09:47:43.513 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 09(String), 2018-01-22 09(String)
2018-01-22 09:47:43.515 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:47:43.516 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:47:43.516 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 09:47:43.516 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 09:47:43.517 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:47:43.518 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:47:43.518 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 09:47:43.518 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:47:43.518 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 09:47:43.520 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:47:43.520 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 09:47:43.522 DEBUG 9000 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:47:43.530 DEBUG 9000 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 09:47:43.541 DEBUG 9000 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 09:47:43.625 DEBUG 9000 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:47:43.629 DEBUG 9000 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 09:49:56.246  INFO 11252 --- [main] com.firesoon.drgs.DrgsApplication        : Starting DrgsApplication on TSJ0573 with PID 11252 (E:\ideaworkspace\DRGs\target\classes started by yingjie.chen in E:\ideaworkspace\DRGs)
2018-01-22 09:49:56.273  INFO 11252 --- [main] com.firesoon.drgs.DrgsApplication        : No active profile set, falling back to default profiles: default
2018-01-22 09:49:56.376  INFO 11252 --- [main] ationConfigEmbeddedWebApplicationContext : Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@49b2a47d: startup date [Mon Jan 22 09:49:56 CST 2018]; root of context hierarchy
2018-01-22 09:49:57.392  INFO 11252 --- [main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'dataSource' with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Dbcp2; factoryMethodName=dataSource; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Dbcp2.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Tomcat; factoryMethodName=dataSource; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Tomcat.class]]
2018-01-22 09:49:57.463  INFO 11252 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode!
2018-01-22 09:49:57.543  INFO 11252 --- [main] o.s.b.f.s.DefaultListableBeanFactory     : Overriding bean definition for bean 'propertySourcesPlaceholderConfigurer' with a different definition: replacing [Root bean: class [org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=propertySourcesPlaceholderConfigurer; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/context/PropertyPlaceholderAutoConfiguration.class]] with [Root bean: class [org.springframework.boot.autoconfigure.session.RedisSessionConfiguration$SpringBootRedisHttpSessionConfiguration]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=propertySourcesPlaceholderConfigurer; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [org/springframework/boot/autoconfigure/session/RedisSessionConfiguration$SpringBootRedisHttpSessionConfiguration.class]]
2018-01-22 09:49:57.759  INFO 11252 --- [main] f.a.AutowiredAnnotationBeanPostProcessor : JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-01-22 09:49:57.783  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'shiroCasConfiguration' of type [com.firesoon.drgs.shiro.cas.ShiroCasConfiguration$$EnhancerBySpringCGLIB$$db961f5c] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:57.915  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'getEhCacheManager' of type [org.apache.shiro.cache.ehcache.EhCacheManager] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:57.919  INFO 11252 --- [main] o.a.shiro.cache.ehcache.EhCacheManager   : Cache with name 'com.firesoon.drgs.shiro.cas.MyShiroCasRealm.authorizationCache' does not yet exist.  Creating now.
2018-01-22 09:49:57.940  INFO 11252 --- [main] o.a.shiro.cache.ehcache.EhCacheManager   : Added EhCache named [com.firesoon.drgs.shiro.cas.MyShiroCasRealm.authorizationCache]
2018-01-22 09:49:58.148  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'mybatis-org.mybatis.spring.boot.autoconfigure.MybatisProperties' of type [org.mybatis.spring.boot.autoconfigure.MybatisProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.159  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration' of type [org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration$$EnhancerBySpringCGLIB$$2bcd906f] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.164  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Tomcat' of type [org.springframework.boot.autoconfigure.jdbc.DataSourceConfiguration$Tomcat] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.182  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'spring.datasource-org.springframework.boot.autoconfigure.jdbc.DataSourceProperties' of type [org.springframework.boot.autoconfigure.jdbc.DataSourceProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.259  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'dataSource' of type [org.apache.tomcat.jdbc.pool.DataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.448  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'sqlSessionFactory' of type [org.apache.ibatis.session.defaults.DefaultSqlSessionFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.462  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'sqlSessionTemplate' of type [org.mybatis.spring.SqlSessionTemplate] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.462  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'userMapper' of type [org.mybatis.spring.mapper.MapperFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.463  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'userMapper' of type [com.sun.proxy.$Proxy64] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.465  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'userSerivceImpl' of type [com.firesoon.drgs.services.user.impl.UserSerivceImpl] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.467  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'myShiroCasRealm' of type [com.firesoon.drgs.shiro.cas.MyShiroCasRealm] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.627  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'securityManager' of type [org.apache.shiro.web.mgt.DefaultWebSecurityManager] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.639  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'cas' of type [com.firesoon.drgs.shiro.cas.filter.CasFilter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.648  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'user' of type [com.firesoon.drgs.shiro.cas.filter.UserFilter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.720  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerBySpringCGLIB$$f8f93f3f] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:58.740  INFO 11252 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'getAuthorizationAttributeSourceAdvisor' of type [org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2018-01-22 09:49:59.112  INFO 11252 --- [main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat initialized with port(s): 9998 (http)
2018-01-22 09:49:59.122  INFO 11252 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2018-01-22 09:49:59.123  INFO 11252 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/8.5.23
2018-01-22 09:49:59.258  INFO 11252 --- [localhost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/drgs]   : Initializing Spring embedded WebApplicationContext
2018-01-22 09:49:59.259  INFO 11252 --- [localhost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 2887 ms
2018-01-22 09:49:59.892  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'characterEncodingFilter' to: [/*]
2018-01-22 09:49:59.892  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'springSessionRepositoryFilter' to: [/*]
2018-01-22 09:49:59.892  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
2018-01-22 09:49:59.893  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'httpPutFormContentFilter' to: [/*]
2018-01-22 09:49:59.893  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'requestContextFilter' to: [/*]
2018-01-22 09:49:59.893  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'singleSignOutFilter' to urls: [/*]
2018-01-22 09:49:59.893  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'delegatingFilterProxy' to urls: [/*]
2018-01-22 09:49:59.893  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'shiroFilter' to: [/*]
2018-01-22 09:49:59.893  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'cas' to: [/*]
2018-01-22 09:49:59.894  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'user' to: [/*]
2018-01-22 09:49:59.894  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.FilterRegistrationBean   : Mapping filter: 'logout' to: [/*]
2018-01-22 09:49:59.894  INFO 11252 --- [localhost-startStop-1] o.s.b.w.servlet.ServletRegistrationBean  : Mapping servlet: 'dispatcherServlet' to [/]
2018-01-22 09:49:59.916  INFO 11252 --- [localhost-startStop-1] o.j.c.c.session.SingleSignOutFilter      : Property [artifactParameterName] not found.  Using default value [ticket]
2018-01-22 09:49:59.916  INFO 11252 --- [localhost-startStop-1] o.j.c.c.session.SingleSignOutFilter      : Property [logoutParameterName] not found.  Using default value [logoutRequest]
2018-01-22 09:50:00.946  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/enable],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.enable(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:50:00.948  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/add],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.add(java.util.List<com.firesoon.drgs.dto.disease.Disease>)
2018-01-22 09:50:00.948  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/update],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.update(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:50:00.949  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/find],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.find(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:50:00.949  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/del],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.del(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:50:00.949  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/upload],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.upload(org.springframework.web.multipart.MultipartFile,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:50:00.950  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/import],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.importFile(java.lang.String,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:50:00.950  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/findDisease],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.findDisease(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:50:00.950  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/findMedicare],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.findMedicare(com.firesoon.drgs.dto.disease.Disease)
2018-01-22 09:50:00.951  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/getFilterData],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.getFilterData(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.951  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/disease/importProjectsettlement],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.DiseaseController.importProjectsettlement(java.lang.String,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:50:00.961  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/export],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.export(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.962  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportDateReport],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportDateReport(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.962  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportPatient],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportPatient(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.962  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportMonitor],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportMonitor(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.963  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getTitle],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getTitle(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.963  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getMedicares],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getMedicares(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.963  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getDetail],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getDetail(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.964  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/costMonitoring],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.costMonitoring(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.964  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getDetailMsg],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getDetailMsg(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.964  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/outMedicare],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.outMedicare(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.965  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/testdownload],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.testdownload(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.965  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/testdownloadword],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.testdownloadword(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.965  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findZhiFuBZ],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findZhiFuBZ(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.966  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findDateReportChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findDateReportChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.966  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getMedicareDateReport],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getMedicareDateReport(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.966  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadKongFeiBLS],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadKongFeiBLS(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.967  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadKongFeiZFY],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadKongFeiZFY(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.967  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findPerHospitalReportChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findPerHospitalReportChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.967  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findPerHospitalReportPieChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findPerHospitalReportPieChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.967  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.970  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportPieChart],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportPieChart(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.970  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findMedicareSettlementList],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findMedicareSettlementList(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.970  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/cancelOutmedicare],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.cancelOut_medicare(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.971  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportMedicareSettlementList],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportMedicareSettlementList(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.971  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportForm],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportForm(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.971  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/tuichuyibaokfjsbl],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.tuichuyibaokfjsbl(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.972  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/tuichuyibaokfjsblxx],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.tuichuyibaokfjsblxx(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.972  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findFeiKongFeiTZ],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findFeiKongFeiZhuZhenDuanTZ(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.972  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadFeiKongFeiTZ],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadFeiKongFeiZhuZhenDuanTZ(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.972  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadtuichuyibaokfjsblxx],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadtuichuyibaokfjsblxx(java.lang.String,java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.973  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/saveFeiKongFeiZhuZhenDuanTZ],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.saveFeiKongFeiZhuZhenDuanTZ(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.973  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getFeiKongFeiTitle],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getFeiKongFeiTitle(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.973  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getXiangMuJieSuanKKBL],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getXiangMuJieSuanKKBL(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.974  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/downloadXiangMuJieSuanKKBL],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.downloadXiangMuJieSuanKKBL(java.lang.String,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.974  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/getXiangMuJieSuanKKMX],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.getXiangMuJieSuanKKXX(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.975  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findApplicationtemplatecol],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findApplicationtemplatecol()
2018-01-22 09:50:00.975  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/addApplicationtemplate],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.addApplicationtemplate(java.util.ArrayList<java.util.Map<java.lang.String, java.lang.Object>>)
2018-01-22 09:50:00.975  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findApplicationtemplate],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findApplicationtemplate()
2018-01-22 09:50:00.976  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportNoSettledPatient],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportNoSettledPatient(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.976  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findNoSettledPatient],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findNoSettledPatient(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.976  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findNoSettledPatientTitle],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findNoSettledPatientTitle(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.977  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/exportMedicareSettlementListDetail],methods=[POST || GET]}" onto public void com.firesoon.drgs.controller.disease.MedicareController.exportMedicareSettlementListDetail(javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String,javax.servlet.http.HttpServletResponse) throws java.io.IOException
2018-01-22 09:50:00.977  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/medicare/findCostHospitalReportTotalCostForm],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.disease.MedicareController.findCostHospitalReportTotalCostForm(java.util.Map<java.lang.String, java.lang.Object>)
2018-01-22 09:50:00.978  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/logout],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.login.LoginController.logout()
2018-01-22 09:50:00.979  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/login],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.login.LoginController.login(com.firesoon.drgs.dto.user.User)
2018-01-22 09:50:00.980  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/add],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.add(java.util.List<com.firesoon.drgs.dto.range.Range>)
2018-01-22 09:50:00.980  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/update],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.update(com.firesoon.drgs.dto.range.Range)
2018-01-22 09:50:00.980  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/find],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.find(com.firesoon.drgs.dto.range.Range)
2018-01-22 09:50:00.981  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/del],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.del(com.firesoon.drgs.dto.range.Range)
2018-01-22 09:50:00.981  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/upload],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.upload(org.springframework.web.multipart.MultipartFile,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:50:00.981  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/range/import],methods=[POST || GET]}" onto public java.lang.Object com.firesoon.drgs.controller.range.RangeController.importFile(java.lang.String,javax.servlet.http.HttpServletRequest) throws java.lang.Exception
2018-01-22 09:50:00.982  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/user/findUser],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.user.UserController.findUser(com.firesoon.drgs.dto.user.User)
2018-01-22 09:50:00.983  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/add],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.add(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:50:00.983  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/update],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.update(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:50:00.983  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/find],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.find(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:50:00.984  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getParams],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getParams()
2018-01-22 09:50:00.984  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getCondition],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getCondition()
2018-01-22 09:50:00.984  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/del],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.del(com.firesoon.drgs.dto.warn.EarlyWarning)
2018-01-22 09:50:00.984  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getCondiValues],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getCondiValues()
2018-01-22 09:50:00.985  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getDoctors],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getDoctors()
2018-01-22 09:50:00.985  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/webservice/warn/getNotices],methods=[POST]}" onto public java.lang.Object com.firesoon.drgs.controller.warn.EarlyWarningController.getNotices()
2018-01-22 09:50:00.989  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/swagger-resources/configuration/security]}" onto public org.springframework.http.ResponseEntity<springfox.documentation.swagger.web.SecurityConfiguration> springfox.documentation.swagger.web.ApiResourceController.securityConfiguration()
2018-01-22 09:50:00.990  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/swagger-resources/configuration/ui]}" onto public org.springframework.http.ResponseEntity<springfox.documentation.swagger.web.UiConfiguration> springfox.documentation.swagger.web.ApiResourceController.uiConfiguration()
2018-01-22 09:50:00.991  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/swagger-resources]}" onto public org.springframework.http.ResponseEntity<java.util.List<springfox.documentation.swagger.web.SwaggerResource>> springfox.documentation.swagger.web.ApiResourceController.swaggerResources()
2018-01-22 09:50:00.994  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/error]}" onto public org.springframework.http.ResponseEntity<java.util.Map<java.lang.String, java.lang.Object>> org.springframework.boot.autoconfigure.web.BasicErrorController.error(javax.servlet.http.HttpServletRequest)
2018-01-22 09:50:00.994  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped "{[/error],produces=[text/html]}" onto public org.springframework.web.servlet.ModelAndView org.springframework.boot.autoconfigure.web.BasicErrorController.errorHtml(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)
2018-01-22 09:50:01.241  INFO 11252 --- [main] pertySourcedRequestMappingHandlerMapping : Mapped URL path [/v2/api-docs] onto method [public org.springframework.http.ResponseEntity<springfox.documentation.spring.web.json.Json> springfox.documentation.swagger2.web.Swagger2Controller.getDocumentation(java.lang.String,javax.servlet.http.HttpServletRequest)]
2018-01-22 09:50:01.725  INFO 11252 --- [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : Looking for @ControllerAdvice: org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@49b2a47d: startup date [Mon Jan 22 09:49:56 CST 2018]; root of context hierarchy
2018-01-22 09:50:01.876  INFO 11252 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/webjars/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:50:01.876  INFO 11252 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:50:01.930  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in baseController
2018-01-22 09:50:01.930  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in diseaseController
2018-01-22 09:50:01.932  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in medicareController
2018-01-22 09:50:01.932  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in loginController
2018-01-22 09:50:01.932  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in rangeController
2018-01-22 09:50:01.933  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in userController
2018-01-22 09:50:01.933  INFO 11252 --- [main] .m.m.a.ExceptionHandlerExceptionResolver : Detected @ExceptionHandler methods in earlyWarningController
2018-01-22 09:50:01.989  INFO 11252 --- [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**/favicon.ico] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2018-01-22 09:50:02.853  INFO 11252 --- [main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
2018-01-22 09:50:02.863  INFO 11252 --- [main] o.s.c.support.DefaultLifecycleProcessor  : Starting beans in phase 2147483647
2018-01-22 09:50:02.863  INFO 11252 --- [main] d.s.w.p.DocumentationPluginsBootstrapper : Context refreshed
2018-01-22 09:50:02.876  INFO 11252 --- [main] d.s.w.p.DocumentationPluginsBootstrapper : Found 1 custom documentation plugin(s)
2018-01-22 09:50:02.908  INFO 11252 --- [main] s.d.s.w.s.ApiListingReferenceScanner     : Scanning for api listing references
2018-01-22 09:50:03.146  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: addUsingPOST_1
2018-01-22 09:50:03.152  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: delUsingPOST_1
2018-01-22 09:50:03.159  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: findUsingPOST_1
2018-01-22 09:50:03.190  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: updateUsingPOST_1
2018-01-22 09:50:04.263  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: addUsingPOST_2
2018-01-22 09:50:04.269  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: delUsingPOST_2
2018-01-22 09:50:04.275  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: findUsingPOST_2
2018-01-22 09:50:04.282  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: importFileUsingPOST_1
2018-01-22 09:50:04.287  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: importFileUsingGET_1
2018-01-22 09:50:04.293  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: updateUsingPOST_2
2018-01-22 09:50:04.301  INFO 11252 --- [main] .d.s.w.r.o.CachingOperationNameGenerator : Generating unique operation named: uploadUsingPOST_1
2018-01-22 09:50:04.329  INFO 11252 --- [main] s.a.ScheduledAnnotationBeanPostProcessor : No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2018-01-22 09:50:04.396  INFO 11252 --- [main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 9998 (http)
2018-01-22 09:50:04.400  INFO 11252 --- [main] com.firesoon.drgs.DrgsApplication        : Started DrgsApplication in 8.531 seconds (JVM running for 9.979)
2018-01-22 09:50:51.242  INFO 11252 --- [http-nio-9998-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/drgs]   : Initializing Spring FrameworkServlet 'dispatcherServlet'
2018-01-22 09:50:51.242  INFO 11252 --- [http-nio-9998-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization started
2018-01-22 09:50:51.263  INFO 11252 --- [http-nio-9998-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization completed in 21 ms
2018-01-22 09:50:51.830 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:50:51.899 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:50:51.928 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:51:03.134  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 09:51:03.134  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 09:51:03.280 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 09:51:03.290 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-22 09:51:03.299 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 09:51:03.446 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:03.447 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 09:51:03.449 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:51:03.456 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:03.456 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 09:51:03.463 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 09:51:03.463 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:51:03.467 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:03.467 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 09:51:03.470 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 09:51:03.470 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:51:03.479 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 09:51:03.479 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 09:51:03.481 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:51:03.487 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 09:51:03.489 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:03.489 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 09:51:03.507 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:03.508 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:03.508 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 09:51:03.513 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:03.513 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:03.514 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 09:51:03.517 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:51:03.517 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:51:03.518 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:03.519 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:03.519 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:51:03.521 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 09:51:03.521 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:51:03.521 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:51:03.524 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 09:51:03.527 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:51:05.251 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:51:05.251 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:51:05.260 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:51:06.671 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:51:06.671 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:51:06.675 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:51:07.090 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 09:51:07.091 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 09:51:07.095 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 09:51:07.095 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 09:51:07.097 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:51:07.097 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:51:07.098 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 09:51:07.099 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 09(String), 2018-01-22 09(String)
2018-01-22 09:51:07.100 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:51:07.108 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 09:51:07.115 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:51:07.116 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 09:51:07.129 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 09:51:07.261 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:51:07.270 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 09:51:09.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:51:09.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:51:09.652 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:51:10.032 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:10.033 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 09:51:10.033 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:10.033 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 09:51:10.034 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 09:51:10.034 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 09:51:10.036 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 09:51:10.036 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:10.037 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 09:51:10.037 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:51:10.039 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 09:51:10.040 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:51:10.041 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:51:10.041 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:51:10.041 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:51:10.042 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 09:51:10.042 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:10.042 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 09:51:10.043 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:51:10.043 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:51:10.043 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:51:10.044 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:10.045 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:10.045 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 09:51:10.045 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:51:10.046 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:10.046 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:10.046 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 09:51:10.048 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:10.048 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:10.048 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 09:51:10.049 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 09:51:10.056 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:51:16.011 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:51:16.011 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:51:16.012 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:51:16.012 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:51:16.012 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:51:16.014 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:51:19.954 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:51:19.954 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:51:19.955 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:51:19.955 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:51:19.955 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:51:19.957 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:51:42.294 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:51:42.294 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:51:42.298 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:51:42.537 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:42.537 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 09:51:42.539 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:51:42.539 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:42.539 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 09:51:42.539 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 09:51:42.540 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 09:51:42.540 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:51:42.540 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 09:51:42.540 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:51:42.541 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:51:42.541 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:51:42.541 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 09:51:42.542 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:42.542 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:51:42.542 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 09:51:42.542 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 09:51:42.543 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 09:51:42.546 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:42.546 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:51:42.546 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:42.546 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 09:51:42.548 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:51:42.548 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:51:42.548 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 09:51:42.550 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 09:51:42.557 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:51:46.772 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:51:46.772 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:51:46.773 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:51:46.773 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:51:46.773 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:51:46.775 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:52:59.928  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/find
2018-01-22 09:52:59.928  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 09:53:01.393 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 09:53:01.393 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-22 09:53:01.395 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 09:53:03.249 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:53:03.249 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:53:03.253 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:53:09.633 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:53:09.634 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:53:09.638 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:53:10.552 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:53:10.552 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:53:10.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:53:10.945 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 09:53:10.945 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 09(String), 2018-01-22 09(String)
2018-01-22 09:53:10.949 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 09:53:10.949 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:53:10.950 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 09:53:10.951 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 09:53:10.952 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 09:53:10.952 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 09:53:10.952 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 09:53:10.957 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 09:53:10.957 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 09:53:10.963 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 09:53:10.969 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 09:53:11.056 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 09:53:11.061 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 09:53:13.062 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:53:13.063 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:53:13.071 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 09:53:13.274 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:53:13.274 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 09:53:13.274 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:53:13.274 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 09:53:13.277 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:53:13.277 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 09:53:13.277 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 09:53:13.277 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 09:53:13.278 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 09:53:13.279 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 09:53:13.280 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 09:53:13.280 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 09:53:13.280 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 09:53:13.281 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:53:13.281 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:13.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:53:13.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:53:13.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:53:13.285 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:53:13.290 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 09:53:13.290 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:53:13.290 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 09:53:13.292 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:53:13.292 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:53:13.292 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 09:53:13.293 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:53:13.293 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:53:13.294 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 09:53:13.295 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 09:53:13.295 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 09:53:13.295 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 09:53:13.296 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 09:53:13.296 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 09:53:16.335 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%aa%' OR doctorname LIKE '%aa%') 
2018-01-22 09:53:16.335 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:16.340 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:53:21.059 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%aa%' OR doctorname LIKE '%aa%') 
2018-01-22 09:53:21.059 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:21.061 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:53:48.725 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.add      : ==>  Preparing: INSERT INTO early_warning VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ) 
2018-01-22 09:53:48.725 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.add      : ==> Parameters: e36b10c2-f16e-4856-903a-a097129df490(String), b(String), 0(String), 剩余病种比例金额,剩余病种比例金额(String), >,<(String), 400,1000(String), 10003,10002,10005(String), 林医生,刘老师,米意思(String), 2018-01-22 09:53:48.724(Timestamp), admin(String), (String), 主诊断,疾病编码(String), 1(String), 13958067777,222222222,14754789874(String)
2018-01-22 09:53:48.727 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.add      : <==    Updates: 1
2018-01-22 09:53:48.819 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:53:48.820 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:48.821 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:53:48.821 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:53:48.821 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:53:48.823 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:53:52.903 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%b%' OR doctorname LIKE '%b%') 
2018-01-22 09:53:52.903 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:52.906 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:53:52.906 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t WHERE (t.name like '%b%' or doctorname like '%b%') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:53:52.906 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:53:52.910 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:53:55.581 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%a%' OR doctorname LIKE '%a%') 
2018-01-22 09:53:55.582 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:55.584 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:53:55.584 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t WHERE (t.name like '%a%' or doctorname like '%a%') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:53:55.584 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:53:55.587 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:53:58.793 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%ab%' OR doctorname LIKE '%ab%') 
2018-01-22 09:53:58.793 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:53:58.795 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:01.983 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:54:01.984 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:54:01.985 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:01.985 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:54:01.985 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:54:01.987 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:54:19.327 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%米%' OR doctorname LIKE '%米%') 
2018-01-22 09:54:19.327 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:54:19.330 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:19.330 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t WHERE (t.name like '%米%' or doctorname like '%米%') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:54:19.331 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:54:19.336 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:54:23.840 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%林%' OR doctorname LIKE '%林%') 
2018-01-22 09:54:23.840 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:54:23.843 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:23.844 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t WHERE (t.name like '%林%' or doctorname like '%林%') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:54:23.844 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:54:23.848 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:54:30.031 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%郭%' OR doctorname LIKE '%郭%') 
2018-01-22 09:54:30.031 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:54:30.034 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:30.034 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t WHERE (t.name like '%郭%' or doctorname like '%郭%') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:54:30.034 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:54:30.037 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:54:32.261 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:54:32.261 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:54:32.262 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:32.262 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:54:32.263 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:54:32.264 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:54:37.838 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t WHERE (t.name LIKE '%刘%' OR doctorname LIKE '%刘%') 
2018-01-22 09:54:37.838 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:54:37.841 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:54:37.841 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t WHERE (t.name like '%刘%' or doctorname like '%刘%') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:54:37.841 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:54:37.844 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 1
2018-01-22 09:57:04.551 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:57:04.551 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:57:04.553 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:57:04.553 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:57:04.553 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:57:04.555 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:57:06.808 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.update   : ==>  Preparing: UPDATE early_warning t SET t.flag = ? WHERE id = ? 
2018-01-22 09:57:06.808 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.update   : ==> Parameters: 0(String), bd7aa1ed-08bd-4af0-802e-b8ea2b6250bb(String)
2018-01-22 09:57:06.810 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.update   : <==    Updates: 1
2018-01-22 09:57:06.858 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:57:06.858 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:57:06.859 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:57:06.859 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:57:06.859 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:57:06.861 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:57:08.028 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.update   : ==>  Preparing: UPDATE early_warning t SET t.flag = ? WHERE id = ? 
2018-01-22 09:57:08.028 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.update   : ==> Parameters: 1(String), bd7aa1ed-08bd-4af0-802e-b8ea2b6250bb(String)
2018-01-22 09:57:08.029 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.update   : <==    Updates: 1
2018-01-22 09:57:08.100 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 09:57:08.100 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 09:57:08.101 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 09:57:08.101 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 09:57:08.101 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 09:57:08.103 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 09:59:22.188 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 09:59:22.189 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 09:59:22.193 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:08:13.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.update   : ==>  Preparing: UPDATE early_warning t SET t.name = ?, t.condition = ?, t.rulecode = ?, t.rulecond = ?, t.value = ?, t.doctorcode = ?, t.doctorname = ?, t.remark = ?, t.message = ?, t.flag = ? WHERE id = ? 
2018-01-22 10:08:13.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.update   : ==> Parameters: a(String), 1(String), 病种比例,剩余病种比例金额(String), =,>(String), 1,500(String), 10001,10003,10006(String), 郭老师,林医生,米例子(String), (String), 病人姓名,住院号(String), 1(String), bd7aa1ed-08bd-4af0-802e-b8ea2b6250bb(String)
2018-01-22 10:08:13.058 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.update   : <==    Updates: 1
2018-01-22 10:08:13.142 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 10:08:13.142 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 10:08:13.143 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 10:08:13.144 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:08:13.144 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 10:08:13.145 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 10:09:17.662 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.warn.EarlyWarningMapper.update   : ==>  Preparing: UPDATE early_warning t SET t.name = ?, t.condition = ?, t.rulecode = ?, t.rulecond = ?, t.value = ?, t.doctorcode = ?, t.doctorname = ?, t.remark = ?, t.message = ?, t.flag = ? WHERE id = ? 
2018-01-22 10:09:17.663 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.warn.EarlyWarningMapper.update   : ==> Parameters: a(String), 1(String), 病种比例,剩余病种比例金额,病种比例(String), =,>,<>(String), 1,500,0.8(String), 10001,10003,10006(String), 郭老师,林医生,米例子(String), (String), 病人姓名,住院号(String), 1(String), bd7aa1ed-08bd-4af0-802e-b8ea2b6250bb(String)
2018-01-22 10:09:17.664 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.warn.EarlyWarningMapper.update   : <==    Updates: 1
2018-01-22 10:09:17.749 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 10:09:17.749 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 10:09:17.750 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 10:09:17.750 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:09:17.750 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 10:09:17.752 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 10:11:17.298 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:11:17.298 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:11:17.301 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:11:46.300 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:11:46.300 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:11:46.304 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:12:25.430 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:12:25.430 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:12:25.433 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:15:10.131 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:15:10.131 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:15:10.135 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:16:02.359 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:16:02.359 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:16:02.362 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:16:16.131 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:16:16.131 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:16:16.135 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:16:43.220 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:16:43.220 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:16:43.225 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:17:20.301 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:17:20.301 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:17:20.305 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:17:22.227 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:17:22.227 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:17:22.234 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:17:29.498 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:17:29.498 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:17:29.502 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:17:45.672 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:17:45.672 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:17:45.676 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:18:01.759 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:18:01.759 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:18:01.763 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:18:05.285 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:18:05.285 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:18:05.290 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:18:05.539 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:18:05.539 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:05.544 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:18:05.544 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:05.544 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:18:05.545 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:18:05.545 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:05.547 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:18:05.547 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:18:05.547 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:05.682 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:18:05.683 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:18:05.683 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:18:05.700 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:18:05.702 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:18:05.702 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:18:05.702 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:05.800 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:18:23.134 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:18:23.134 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:18:23.139 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:18:24.480 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:18:24.480 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:24.483 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:18:24.483 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:18:24.483 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:24.484 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:18:24.485 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:24.485 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:18:24.485 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:18:24.487 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:18:24.487 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:18:24.488 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:24.488 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:18:24.595 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:18:24.596 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:18:24.596 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:18:24.612 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:18:24.612 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:18:24.613 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:18:24.613 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:18:24.696 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:18:26.289 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:18:26.290 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:18:26.293 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:18:41.696 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:18:41.696 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:18:41.700 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:19:25.827 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:19:25.827 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:19:25.831 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:19:26.083 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 10:19:26.083 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 10:19:26.085 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 10:19:26.087 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 10:19:26.087 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 10:19:26.087 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 10:19:26.087 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 10:19:26.089 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 10:19:26.089 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:19:26.089 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 10:19:26.089 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 10:19:26.090 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 10:19:26.090 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 10:19:26.091 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 10:19:26.091 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 10:19:26.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 10:19:26.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:19:26.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 10:19:26.095 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 10:19:26.103 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:19:26.103 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 10:19:26.103 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:26.104 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 10:19:26.105 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 10:19:26.105 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:26.105 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 10:19:26.107 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 10:19:26.107 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:26.107 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 10:19:26.108 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 10:19:26.108 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:26.108 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 10:19:26.110 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 10:19:40.675 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:19:40.675 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:19:40.678 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:19:40.871 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 10:19:40.871 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 10:19:40.873 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 10:19:40.873 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 10:19:40.874 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 10:19:40.874 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 10:19:40.874 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:19:40.874 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 10:19:40.875 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 10:19:40.875 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 10:19:40.875 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 10:19:40.875 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 10:19:40.875 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 10:19:40.876 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 10:19:40.876 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 10:19:40.877 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 10:19:40.877 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:19:40.877 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 10:19:40.878 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:19:40.879 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 10:19:40.891 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 10:19:40.891 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:40.891 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 10:19:40.893 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 10:19:40.893 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:40.893 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 10:19:40.894 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 10:19:40.894 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:40.894 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 10:19:40.896 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 10:19:40.896 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 10:19:40.896 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 10:19:40.898 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 10:22:17.106 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.update   : ==>  Preparing: UPDATE early_warning t SET t.name = ?, t.condition = ?, t.rulecode = ?, t.rulecond = ?, t.value = ?, t.doctorcode = ?, t.doctorname = ?, t.remark = ?, t.message = ?, t.flag = ? WHERE id = ? 
2018-01-22 10:22:17.106 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.update   : ==> Parameters: a(String), 1(String), 病种比例,剩余病种比例金额,剩余病种比例金额(String), =,>,<>(String), 1,500,1232(String), 10001,10003,10006(String), 郭老师,林医生,米例子(String), (String), 主诊断,疾病编码(String), 1(String), bd7aa1ed-08bd-4af0-802e-b8ea2b6250bb(String)
2018-01-22 10:22:17.108 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.update   : <==    Updates: 1
2018-01-22 10:22:17.192 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 10:22:17.192 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 10:22:17.193 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 10:22:17.194 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:22:17.194 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 10:22:17.195 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 10:22:46.106 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:22:46.106 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:22:46.110 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:22:56.185 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:22:56.185 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:22:56.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:22:57.390 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:22:57.390 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:22:57.394 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:22:57.642 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:22:57.642 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:22:57.645 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:22:57.645 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:22:57.645 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:22:57.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:22:57.647 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:22:57.647 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:22:57.649 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:22:57.649 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:22:57.741 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:22:57.742 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:22:57.742 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:22:57.797 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:22:57.798 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:22:57.798 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:22:57.815 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:22:57.832 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:24:27.464 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:24:27.464 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:24:27.468 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:24:27.801 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:24:27.802 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:27.803 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:24:27.804 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:24:27.804 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:27.807 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:24:27.807 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:24:27.807 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:27.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:24:27.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:27.906 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:24:27.907 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:24:27.907 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:27.912 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:24:27.912 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:24:27.912 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:24:27.932 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:24:28.009 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:24:46.916 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:24:46.916 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:24:46.919 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:24:47.263 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:24:47.263 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:47.265 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:24:47.266 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:24:47.266 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:47.267 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:24:47.267 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:24:47.267 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:47.269 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:24:47.269 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:47.368 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:24:47.368 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:24:47.369 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:24:47.376 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:24:47.377 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:24:47.377 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:24:47.393 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:24:47.469 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:25:10.218 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:25:10.218 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:25:10.222 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:25:10.589 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:25:10.589 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:10.591 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:25:10.591 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:25:10.591 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:10.592 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:25:10.592 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:10.593 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:25:10.593 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:25:10.594 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:10.713 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:25:10.713 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:25:10.713 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:10.730 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:25:10.730 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:25:10.730 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:25:10.745 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:25:10.814 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:25:44.575 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:25:44.575 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:25:44.579 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:25:44.908 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:25:44.909 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:44.911 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:25:44.911 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:25:44.911 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:44.912 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:25:44.912 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:25:44.912 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:44.913 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:25:44.913 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:45.029 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:25:45.030 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:25:45.030 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:25:45.053 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:25:45.053 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:25:45.053 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:25:45.070 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:25:45.131 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:26:38.388 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:26:38.388 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:26:38.391 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:26:38.748 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:26:38.748 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:26:38.750 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:26:38.750 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:26:38.751 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:26:38.752 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:26:38.752 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:26:38.752 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:26:38.752 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:26:38.752 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:26:38.856 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:26:38.856 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:26:38.856 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:26:38.865 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:26:38.865 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:26:38.865 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:26:38.881 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:26:38.956 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:22.971 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:27:22.971 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:27:22.976 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:27:23.358 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:23.359 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:23.360 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:23.361 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:23.361 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:23.363 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:23.363 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:27:23.364 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:23.365 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:23.365 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:23.463 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:23.463 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:23.463 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:23.473 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:27:23.474 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:27:23.474 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:27:23.490 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:27:23.558 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:29.262 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:27:29.262 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:27:29.266 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:27:29.629 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:29.629 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:29.631 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:29.632 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:29.632 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:29.632 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:27:29.632 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:29.633 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:29.634 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:29.634 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:29.734 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:29.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:29.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:29.745 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:27:29.746 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:27:29.746 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:27:29.762 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:27:29.830 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:31.893 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:27:31.893 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:27:31.897 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:27:32.915 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:32.915 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:32.916 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:27:32.916 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:27:32.917 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:32.917 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:32.917 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:32.917 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:27:32.917 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:32.919 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:32.919 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:32.920 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:32.921 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:27:33.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:27:33.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:27:33.017 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:27:33.021 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:27:33.022 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:33.023 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:33.023 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:33.123 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:35.089 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:27:35.089 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:27:35.093 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:27:35.748 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:35.748 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:35.749 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:27:35.749 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:27:35.749 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:35.749 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:27:35.750 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:27:35.750 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:35.750 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:35.751 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:27:35.752 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:35.752 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:35.754 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:27:35.844 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:27:35.845 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:27:35.845 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:27:35.851 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:27:35.852 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:27:35.852 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:27:35.870 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:27:35.946 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:28.579 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:28.579 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:28.582 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:28.900 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:28.900 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:28.902 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:28.902 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:28.903 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:28.904 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:28.904 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:28.904 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:28.905 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:28.905 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:29.005 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:29.005 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:29.005 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:29.013 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:29.013 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:28:29.013 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:29.033 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:29.105 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:42.225 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:42.225 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:42.229 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:42.548 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:42.548 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:42.549 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:42.550 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:42.550 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:42.551 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:42.551 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:42.551 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:42.552 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:42.552 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:42.656 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:42.657 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:42.657 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:42.664 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:42.664 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:28:42.665 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:42.681 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:42.756 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:44.372 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:44.372 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:44.375 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:45.572 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:45.572 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:45.573 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:45.573 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:45.573 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:45.574 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:45.574 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:45.574 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:45.574 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:45.576 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:45.576 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:45.576 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:45.578 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:45.669 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:45.669 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:45.670 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:45.672 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:45.672 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:28:45.672 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:45.677 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:45.772 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:51.428 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:51.428 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:51.432 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:53.349 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:53.350 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:53.353 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:54.358 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:54.359 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:54.362 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:54.552 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:54.553 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:54.553 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:54.553 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:54.554 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:54.554 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:54.555 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:54.556 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:54.556 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:54.556 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:54.651 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:54.652 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:54.652 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:54.656 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:54.657 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:28:54.657 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:54.661 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:54.752 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:56.207 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:56.207 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:56.211 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:56.460 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:56.461 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:56.462 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:56.462 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:56.462 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:56.463 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:56.463 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:56.464 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:56.464 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:56.464 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:56.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:56.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-01-22 10:28:56.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:56.558 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:56.558 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:56.558 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:56.561 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:56.657 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:56.697 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:56.697 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:56.700 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:56.958 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:56.958 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 4(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:57.218 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:57.218 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:57.220 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:57.220 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:57.221 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:57.221 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:57.221 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:57.222 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:57.222 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:57.222 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:57.223 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:57.223 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:57.225 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:57.309 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:57.309 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:57.309 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:57.314 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:57.314 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:28:57.314 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:57.319 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:57.392 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:57.635 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:57.636 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeibztz') ORDER BY column_id 
2018-01-22 10:28:57.636 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:57.652 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:28:58.429 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:58.430 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:58.433 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:58.433 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:28:58.433 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:28:58.433 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:28:58.433 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:58.434 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:28:58.434 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:58.435 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:28:58.435 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:58.435 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:58.436 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:28:58.522 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:28:58.522 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:28:58.522 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:28:58.527 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:28:58.527 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-01-22 10:28:58.527 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:28:58.531 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:28:58.604 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:00.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:00.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:00.075 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:38.415 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:38.415 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:38.419 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:54.859 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:54.859 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:54.862 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:55.070 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:55.070 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:55.072 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:55.072 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:55.072 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:55.073 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:55.073 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:55.074 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:55.074 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:29:55.074 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:55.164 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:55.165 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:55.165 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:55.169 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:29:55.169 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:29:55.169 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:29:55.174 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:29:55.252 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:56.430 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:56.430 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:56.434 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:56.685 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:56.685 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:56.687 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:56.687 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:56.687 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:56.687 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:29:56.688 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:56.688 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:56.689 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:56.689 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:56.776 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:56.777 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:56.777 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:56.781 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:29:56.781 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-01-22 10:29:56.781 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:29:56.786 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:29:56.824 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:56.824 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:56.828 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:56.865 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:57.159 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:29:57.160 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 4(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.488 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:57.489 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.490 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:57.490 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:57.490 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.492 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:57.492 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:57.492 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.493 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:57.493 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:57.493 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:29:57.493 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.496 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:57.581 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:57.581 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:57.581 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.601 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:29:57.602 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:29:57.602 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:29:57.619 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:29:57.664 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:57.812 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:57.812 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.814 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:57.814 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:57.814 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:29:57.814 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:57.814 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.815 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:29:57.815 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.816 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:29:57.817 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:57.817 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.819 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:57.821 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:29:57.822 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeibztz') ORDER BY column_id 
2018-01-22 10:29:57.822 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:29:57.826 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:29:57.900 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:57.900 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:29:57.900 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:57.913 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:29:57.913 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-01-22 10:29:57.913 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:29:57.931 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:29:57.982 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:29:58.393 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:29:58.393 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 4(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:29:58.393 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:29:58.394 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:29:58.397 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:29:59.066 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:29:59.066 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeibztz') ORDER BY column_id 
2018-01-22 10:29:59.067 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:29:59.083 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:30:36.853 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:30:36.853 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:30:36.856 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:30:37.033 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:30:37.033 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 4(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:30:37.707 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:30:37.708 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeibztz') ORDER BY column_id 
2018-01-22 10:30:37.708 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:30:37.724 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:30:42.461 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:30:42.461 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:30:42.464 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:30:48.869 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:30:48.869 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:30:48.872 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:31:04.290 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:31:04.290 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:31:04.294 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:31:10.310 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:31:10.310 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:31:10.314 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:32:29.887 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:32:29.887 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:32:29.890 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:33:48.502 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:33:48.503 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:33:48.506 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:33:48.789 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:33:48.789 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:48.791 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:33:48.791 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:33:48.791 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:48.795 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:33:48.795 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:33:48.795 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:48.797 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:33:48.797 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:48.881 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:33:48.881 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:33:48.881 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:48.902 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:33:48.902 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:33:48.902 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:33:48.919 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:33:48.963 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:33:53.916 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:33:53.916 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:33:53.920 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:33:54.182 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:33:54.182 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:54.184 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:33:54.184 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:33:54.184 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:54.187 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:33:54.187 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:33:54.187 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:54.188 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:33:54.188 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:54.271 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:33:54.271 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:33:54.271 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:33:54.298 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:33:54.299 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:33:54.299 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:33:54.320 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:33:54.354 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:34:08.052 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:34:08.052 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:34:08.056 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:34:08.313 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:34:08.313 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:08.314 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:34:08.315 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:34:08.315 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:08.316 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:34:08.316 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:08.317 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:34:08.317 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:34:08.317 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:08.400 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:34:08.401 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:34:08.401 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:08.423 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:34:08.423 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-01-22 10:34:08.423 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:34:08.443 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:34:08.482 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:34:08.932 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:34:08.932 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:34:08.936 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:34:10.059 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:34:10.059 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:10.060 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:34:10.061 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:34:10.061 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:10.063 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:34:10.063 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:34:10.063 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:34:10.063 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:10.063 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:10.065 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:34:10.065 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:34:10.069 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:34:10.147 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:34:10.147 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:34:10.147 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:34:10.172 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:34:10.172 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:34:10.172 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:34:10.190 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:34:10.229 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:34:11.783 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:34:11.783 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:34:11.786 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:34:32.762 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:34:32.762 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:34:32.765 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:37:17.390 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:37:17.390 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:37:17.394 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:48:06.723 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:48:06.723 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:48:06.727 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:48:06.910 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:48:06.910 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:48:06.913 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:48:06.914 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:48:06.914 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:48:06.915 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:48:06.915 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:48:06.916 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:48:06.916 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:48:06.916 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:48:07.000 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:48:07.000 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:48:07.001 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:48:07.021 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:48:07.021 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:48:07.021 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:48:07.039 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:48:07.083 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:48:09.381 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:48:09.381 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:48:09.385 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:49:41.698 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:49:41.698 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:49:41.702 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:49:43.358 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:49:43.358 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:49:43.362 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:49:43.534 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:49:43.534 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:43.535 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:49:43.536 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:49:43.536 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:43.537 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:49:43.537 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:49:43.538 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:43.540 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:49:43.540 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:43.622 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:49:43.623 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:49:43.623 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:43.647 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:49:43.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:49:43.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:49:43.666 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:49:43.705 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:49:44.420 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:49:44.420 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:49:44.425 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:49:46.118 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:49:46.118 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:46.119 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:49:46.119 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:49:46.119 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:49:46.120 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:49:46.120 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:46.121 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:49:46.121 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:49:46.121 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:46.123 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:49:46.123 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:49:46.123 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:46.218 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:49:46.218 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:49:46.219 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:49:46.223 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:49:46.224 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:49:46.225 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:49:46.225 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:49:46.313 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:49:53.526 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:49:53.526 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:49:53.530 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:51:01.578 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:51:01.578 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:51:01.581 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:51:02.628 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:51:02.628 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:51:02.632 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:51:02.769 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:51:02.770 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:02.771 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:51:02.772 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:51:02.772 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:02.773 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:51:02.773 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:51:02.773 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:02.774 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:51:02.774 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:02.863 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:51:02.863 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:51:02.863 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:02.867 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:51:02.868 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:51:02.868 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:51:02.873 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:51:02.951 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:51:04.046 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:51:04.046 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:51:04.050 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:51:04.756 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:51:04.756 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:04.757 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:51:04.758 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 10:51:04.758 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:04.759 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 10:51:04.760 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:51:04.761 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:51:04.761 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:04.761 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:04.762 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:51:04.762 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:51:04.768 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:51:04.849 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:51:04.850 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 10:51:04.850 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 10:51:04.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 10:51:04.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 10:51:04.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:51:04.858 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 10:51:04.939 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 10:51:08.970 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:51:08.970 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:51:08.975 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:51:32.987 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:51:32.987 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:51:32.991 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:02.471 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:02.471 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:02.475 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:05.755 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:05.755 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:05.759 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:10.774 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:10.774 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:10.779 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:11.557 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:11.557 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:11.561 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:14.184 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:14.184 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:14.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:14.860 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:14.860 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:14.865 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:16.381 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:16.381 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:16.385 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:17.039 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:17.039 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:17.043 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:53:24.787 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:53:24.787 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:53:24.791 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:54:39.805 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:54:39.806 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:54:39.809 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:54:40.730 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:54:40.730 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:54:40.734 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:54:41.006 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 10:54:41.006 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 10:54:41.008 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 10:54:41.008 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:54:41.008 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 10:54:41.011 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 10:54:56.928 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 10:54:56.928 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 10:54:56.934 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 10:54:57.171 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 10:54:57.171 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 10:54:57.311 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 10:54:57.311 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 10:54:57.311 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 10:54:57.453 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 10:54:57.453 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 10:54:57.453 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:54:57.456 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 10:55:01.311 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 10:55:01.311 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:55:01.317 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:55:01.318 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:55:01.430 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:55:01.430 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:55:01.430 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:55:01.493 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 10:55:01.493 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 10:55:01.493 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:55:01.585 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 10:55:01.585 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:55:01.585 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:55:01.589 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:55:01.667 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 10:56:06.917 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 盈亏标识 IN ('1') 
2018-01-22 10:56:06.917 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:07.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:56:07.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 盈亏标识 in ('1') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:56:07.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:07.206 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 10:56:07.206 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:56:07.206 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:56:07.210 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:56:10.058 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:56:10.058 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:10.173 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:56:10.173 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:56:10.173 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:10.291 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 10:56:10.292 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:56:10.292 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:56:10.296 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:56:12.828 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 盈亏标识 IN ('0') 
2018-01-22 10:56:12.828 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:12.965 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:56:12.966 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 盈亏标识 in ('0') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:56:12.966 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:13.115 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 2
2018-01-22 10:56:13.117 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:56:13.117 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:56:13.121 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:56:15.316 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:56:15.316 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:15.430 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:56:15.430 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:56:15.430 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:15.548 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 10:56:15.548 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:56:15.548 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:56:15.552 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:56:22.236 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 状态 IN ('未退出') 
2018-01-22 10:56:22.237 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:22.372 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:56:22.372 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 状态 in ('未退出') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:56:22.372 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:22.522 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 10:56:22.523 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:56:22.523 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:56:22.526 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 10:56:24.894 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 10:56:24.895 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:25.009 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 10:56:25.009 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 10:56:25.009 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 10:56:25.127 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 10:56:25.127 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 10:56:25.127 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 10:56:25.131 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:01:46.539 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:01:46.539 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:01:46.542 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:01:46.773 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:01:46.774 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:01:46.888 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:01:46.888 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:01:46.888 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:01:47.005 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:01:47.006 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:01:47.006 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:01:47.008 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:01:49.246 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:01:49.246 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:01:49.249 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:01:49.658 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 11:01:49.658 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 11:01:49.664 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 11:01:49.664 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 11:01:49.828 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 11:01:49.852 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 11:01:49.852 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:01:49.852 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:01:49.855 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:01:52.450 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:01:52.451 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:01:52.454 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:01:52.455 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:01:52.455 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:01:52.569 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:01:52.569 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:01:52.569 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:01:52.685 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:01:52.687 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:01:52.687 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:01:52.689 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:01:54.381 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:01:54.381 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:01:54.387 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:01:54.387 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:01:54.500 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:01:54.500 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:01:54.500 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:01:54.519 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:01:54.520 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:01:54.520 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:01:54.618 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:01:54.619 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:01:54.619 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:01:54.623 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:01:54.658 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:02:02.270 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 盈亏标识 IN ('1') 
2018-01-22 11:02:02.271 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:02:02.385 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:02:02.385 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 盈亏标识 in ('1') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:02.385 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:02:02.502 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:02:02.503 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:02:02.503 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:02.507 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:02:10.430 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:02:10.430 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:02:10.433 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:02:10.815 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 11:02:10.815 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 11:02:10.816 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 11:02:10.816 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:02:10.816 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 11:02:10.825 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 11:02:10.877 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:02:10.877 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:02:10.880 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:02:11.130 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 11:02:11.130 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 11:02:11.132 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 11:02:11.133 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 11:02:11.133 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 11:02:11.135 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 11:02:11.135 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 11:02:11.135 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 11:02:11.136 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 11:02:11.136 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 11:02:11.136 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 11:02:11.137 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 11:02:11.138 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 11:02:11.138 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 11:02:11.138 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:11.140 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 11:02:11.140 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:02:11.140 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 11:02:11.142 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 11:02:11.148 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 11:02:11.149 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:02:11.149 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 11:02:11.150 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 11:02:11.150 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:02:11.150 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 11:02:11.152 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 11:02:11.152 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:02:11.152 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 11:02:11.153 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 11:02:11.153 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:02:11.153 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 11:02:11.154 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:02:11.154 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 11:02:18.140 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:02:18.140 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:02:18.144 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:02:18.145 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:02:18.145 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:02:18.271 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:02:18.271 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:02:18.271 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:02:18.397 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:02:18.398 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:02:18.398 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:18.417 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:02:19.234 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:02:19.235 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:02:19.237 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 盈亏标识 IN ('1') 
2018-01-22 11:02:19.237 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:02:19.372 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:02:19.372 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 盈亏标识 in ('1') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:19.372 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:02:19.400 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:02:19.401 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:02:19.401 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:02:19.502 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:02:19.502 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:02:19.502 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:19.517 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:02:19.557 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:02:24.780 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:02:24.780 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:02:24.784 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:02:25.139 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:02:25.139 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:02:25.141 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 11:02:25.141 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 11:02:25.142 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 11:02:25.142 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 11:02:25.144 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 11:02:25.144 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:02:25.160 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 11:02:25.168 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 11:02:25.256 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:02:25.256 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:02:25.256 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:02:25.272 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 11:02:25.272 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 11:02:25.272 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:25.276 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 11:02:25.394 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:02:29.871 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:02:29.871 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-22(String)
2018-01-22 11:02:29.874 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 11:02:29.875 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-22(String)
2018-01-22 11:02:29.996 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 11:02:29.996 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:02:29.996 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-22(String)
2018-01-22 11:02:30.008 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:02:30.008 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:02:30.008 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-22(String)
2018-01-22 11:02:30.143 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-22 11:02:30.143 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 11:02:30.144 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:30.147 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 11:02:30.158 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:02:31.463 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:02:31.463 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:31.467 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 11:02:31.467 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:31.590 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 11:02:31.590 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:02:31.590 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:31.604 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:02:31.604 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:02:31.604 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:31.705 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-22 11:02:31.705 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 11:02:31.705 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:31.708 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 11:02:31.760 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:02:32.982 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:02:32.983 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:33.043 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:02:33.043 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:33.043 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:33.108 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:02:36.197 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? GROUP BY t.医保类别) table_count 
2018-01-22 11:02:36.198 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String)
2018-01-22 11:02:36.258 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:02:36.258 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? group by t.医保类别 order by 支付标准 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:36.258 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String)
2018-01-22 11:02:36.329 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:02:39.082 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:02:39.082 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:39.126 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:02:39.126 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:39.126 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:39.170 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:02:42.605 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:02:42.605 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:42.652 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:02:42.652 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:42.652 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:42.699 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:02:45.454 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getDetailMsg_COUNT           : ==>  Preparing: SELECT count(0) FROM DetailMsg t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 = ? AND t.疾病编码 = ? AND t.手术医保编码 = ? 
2018-01-22 11:02:45.454 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getDetailMsg_COUNT           : ==> Parameters: 1(String), 出院(String), 新市医保(String), N87.901(String), f33130300400(String)
2018-01-22 11:02:45.479 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getDetailMsg_COUNT           : <==      Total: 1
2018-01-22 11:02:45.479 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getDetailMsg    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM DetailMsg t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 = ? AND t.疾病编码 = ? AND t.手术医保编码 = ? order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:45.479 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getDetailMsg    : ==> Parameters: 1(String), 出院(String), 新市医保(String), N87.901(String), f33130300400(String)
2018-01-22 11:02:45.520 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getDetailMsg    : <==      Total: 4
2018-01-22 11:02:45.520 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('detailmsg1') ORDER BY column_id 
2018-01-22 11:02:45.520 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:45.535 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 22
2018-01-22 11:02:49.862 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getDetailMsg_COUNT           : ==>  Preparing: SELECT count(0) FROM DetailMsg t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 = ? AND t.疾病编码 = ? AND t.手术医保编码 = ? AND 科室 IN ('妇科病区(钱江)', '产科病区(钱江)') 
2018-01-22 11:02:49.862 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getDetailMsg_COUNT           : ==> Parameters: 1(String), 出院(String), 新市医保(String), N87.901(String), f33130300400(String)
2018-01-22 11:02:49.889 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getDetailMsg_COUNT           : <==      Total: 1
2018-01-22 11:02:49.889 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getDetailMsg    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM DetailMsg t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 = ? AND t.疾病编码 = ? AND t.手术医保编码 = ? AND 科室 in ('妇科病区(钱江)','产科病区(钱江)') order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:49.889 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getDetailMsg    : ==> Parameters: 1(String), 出院(String), 新市医保(String), N87.901(String), f33130300400(String)
2018-01-22 11:02:49.930 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getDetailMsg    : <==      Total: 4
2018-01-22 11:02:49.930 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('detailmsg1') ORDER BY column_id 
2018-01-22 11:02:49.930 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:49.944 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 22
2018-01-22 11:02:52.869 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:02:52.869 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:52.912 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:02:52.912 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:52.912 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:02:52.955 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:02:54.802 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getDetailMsg_COUNT           : ==>  Preparing: SELECT count(0) FROM DetailMsg t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 = ? AND t.疾病编码 = ? AND t.手术医保编码 = ? 
2018-01-22 11:02:54.803 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getDetailMsg_COUNT           : ==> Parameters: 1(String), 出院(String), 新市医保(String), N87.901(String), f33130300400(String)
2018-01-22 11:02:54.818 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getDetailMsg_COUNT           : <==      Total: 1
2018-01-22 11:02:54.818 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getDetailMsg    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM DetailMsg t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 = ? AND t.疾病编码 = ? AND t.手术医保编码 = ? order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:02:54.818 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getDetailMsg    : ==> Parameters: 1(String), 出院(String), 新市医保(String), N87.901(String), f33130300400(String)
2018-01-22 11:02:54.841 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getDetailMsg    : <==      Total: 4
2018-01-22 11:02:54.841 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('detailmsg1') ORDER BY column_id 
2018-01-22 11:02:54.841 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:02:54.855 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 22
2018-01-22 11:03:13.861 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:03:13.861 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: D27.x00(String), f33000000001+f33130100200(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:03:13.919 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:03:13.919 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:03:13.919 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: D27.x00(String), f33000000001+f33130100200(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:03:13.980 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:03:18.607 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:03:18.607 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: D25.900(String), f33130301100(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:03:18.654 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:03:18.654 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:03:18.654 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: D25.900(String), f33130301100(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:03:18.701 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 11:03:22.867 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 11:03:22.867 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: D25.900(String), f33130600800(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:03:22.913 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 11:03:22.913 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:03:22.913 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: D25.900(String), f33130600800(String), 1(String), 出院(String), 2017-12-01(String), 2018-01-28(String)
2018-01-22 11:03:22.960 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 2
2018-01-22 11:03:39.205 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:03:39.205 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:03:39.208 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:03:39.208 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:03:39.234 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:03:39.346 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:03:39.346 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:03:39.346 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:03:39.458 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:03:39.458 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:03:39.458 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:03:39.460 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:04:33.220 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:04:33.220 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:04:33.223 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 盈亏标识 IN ('1') 
2018-01-22 11:04:33.223 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:04:33.349 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:04:33.350 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:04:33.350 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:04:33.352 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:04:33.352 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 盈亏标识 in ('1') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:04:33.352 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:04:33.482 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:04:33.489 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:04:33.489 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:04:33.489 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:04:33.504 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:08:16.240 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:08:16.240 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:08:16.244 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:08:16.567 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:08:16.567 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:16.691 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:08:16.692 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:08:16.692 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:16.820 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:08:16.820 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:08:16.820 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:16.836 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:08:21.577 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:08:21.577 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:08:21.581 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:08:21.933 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 11:08:21.933 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:21.936 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:08:21.936 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:21.949 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 11:08:22.048 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 11:08:22.048 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:08:22.049 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:22.117 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:08:22.117 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:08:22.120 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:08:22.120 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:22.121 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:08:22.186 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:08:22.250 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:08:22.251 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:08:22.251 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:22.379 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:08:22.379 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:08:22.379 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:22.394 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:08:24.836 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:08:24.836 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:24.838 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:08:24.838 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:24.950 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:08:24.951 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:08:24.951 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:25.004 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:08:25.004 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:08:25.004 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:25.065 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:08:25.067 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:08:25.067 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:25.071 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:08:25.172 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:08:29.518 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 IN ('新市医保', '新省一卡通') 
2018-01-22 11:08:29.518 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:29.734 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:08:29.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 in ('新市医保','新省一卡通') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:08:29.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:29.977 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:08:29.977 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:08:29.977 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:29.991 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:08:37.997 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 IN ('新省一卡通') 
2018-01-22 11:08:37.997 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:38.062 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:08:38.062 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 in ('新省一卡通') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:08:38.062 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:08:38.151 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 4
2018-01-22 11:08:38.151 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:08:38.151 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:38.166 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:08:41.595 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:08:41.596 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:41.598 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:08:41.598 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:41.713 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:08:41.713 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:08:41.713 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:41.745 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:08:41.745 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:08:41.746 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:08:41.832 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:08:41.833 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:08:41.833 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:08:41.838 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:08:41.901 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:09:00.072 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:09:00.073 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:00.075 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:09:00.075 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:00.187 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:09:00.187 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:09:00.187 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:00.218 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:09:00.219 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:09:00.219 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:00.302 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:09:00.302 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:09:00.302 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:09:00.306 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:09:00.379 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:09:17.327 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:09:17.327 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:09:17.330 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:09:17.654 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:09:17.654 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:09:17.783 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:09:17.783 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:09:17.783 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:09:17.911 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:09:17.911 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:09:17.911 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:09:17.927 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:09:23.053 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:09:23.053 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:23.056 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:09:23.056 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:23.168 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:09:23.168 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:09:23.168 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:23.197 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:09:23.198 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:09:23.198 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:23.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:09:23.284 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:09:23.284 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:09:23.287 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:09:23.358 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:09:25.380 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 11:09:25.380 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:09:25.533 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:09:25.534 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.住院号 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:09:25.534 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:09:25.717 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:09:25.717 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:09:25.717 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:09:25.732 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:09:29.702 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:09:29.702 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:29.704 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:09:29.704 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:29.816 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:09:29.816 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:09:29.817 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:29.851 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:09:29.851 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:09:29.852 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:09:29.933 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:09:29.933 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:09:29.933 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:09:29.937 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:09:30.011 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:09:38.293 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:09:38.293 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:09:38.297 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:09:38.584 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:09:38.584 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:09:38.713 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:09:38.713 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:09:38.713 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:09:38.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:09:38.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:09:38.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:09:38.854 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:12:13.660 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:12:13.660 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:12:13.664 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:12:13.844 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:12:13.844 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:12:13.974 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:12:13.975 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:12:13.975 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:12:14.103 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:12:14.103 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:12:14.103 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:12:14.116 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:12:17.065 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:12:17.066 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:17.071 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:12:17.071 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:17.186 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:12:17.186 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:12:17.186 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:17.211 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:12:17.212 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:12:17.212 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:17.300 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:12:17.300 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:12:17.301 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:12:17.305 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:12:17.380 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:12:22.081 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:12:22.081 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:12:22.147 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:12:22.147 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:12:22.147 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:12:22.237 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:12:22.238 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:12:22.238 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:12:22.255 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:12:28.908 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:12:28.908 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:28.911 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:12:28.911 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:29.023 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:12:29.023 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:12:29.023 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:29.055 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:12:29.055 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:12:29.056 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:29.141 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:12:29.142 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:12:29.142 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:12:29.145 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:12:29.214 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:12:32.709 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:12:32.709 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:32.713 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:12:32.713 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:32.825 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:12:32.825 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:12:32.825 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:32.856 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:12:32.856 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:12:32.857 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:12:32.940 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:12:32.940 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:12:32.941 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:12:32.944 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:12:33.039 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:13:20.367 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:13:20.367 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:13:20.371 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:13:29.284 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:13:29.284 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:13:29.289 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:13:29.639 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:13:29.640 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:29.772 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:13:29.772 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:13:29.772 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:29.908 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:13:29.909 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:13:29.909 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:13:29.921 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:13:36.454 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:13:36.455 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:36.458 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:13:36.459 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:36.571 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:13:36.571 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:13:36.571 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:36.609 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:13:36.609 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:13:36.610 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:36.690 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:13:36.690 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:13:36.690 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:13:36.694 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:13:36.828 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:13:43.606 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:13:43.606 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:43.644 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:13:43.644 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:13:43.644 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:43.683 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:13:43.684 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:13:43.684 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:13:43.698 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:13:47.093 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 11:13:47.094 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:47.223 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:13:47.223 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:13:47.223 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:47.412 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:13:47.413 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:13:47.413 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:13:47.427 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:13:53.297 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:13:53.297 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:53.300 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:13:53.300 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:53.414 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:13:53.414 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:13:53.414 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:53.439 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:13:53.439 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:13:53.440 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:13:53.529 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:13:53.530 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:13:53.530 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:13:53.533 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:13:53.602 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:13:56.830 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('成年居民(非从业)', '城乡居民') 
2018-01-22 11:13:56.830 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:56.891 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:13:56.891 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('成年居民(非从业)','城乡居民') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:13:56.891 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:13:56.974 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:13:56.975 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:13:56.975 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:13:56.988 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:14:16.891 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:14:16.891 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:14:16.895 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:14:18.506 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:14:18.506 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:14:18.510 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:14:19.279 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:14:19.280 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:14:19.410 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:14:19.410 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:14:19.410 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:14:19.538 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:14:19.538 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:14:19.538 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:14:19.553 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:14:41.340 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:14:41.340 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:14:41.344 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:14:41.679 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:14:41.679 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:14:41.809 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:14:41.809 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:14:41.809 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:14:41.936 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:14:41.937 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:14:41.937 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:14:41.953 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:14:49.846 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:14:49.846 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:14:49.847 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:14:49.847 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:14:49.959 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:14:49.959 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:14:49.959 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:14:49.995 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:14:49.995 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:14:49.995 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:14:50.073 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:14:50.074 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:14:50.074 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:14:50.078 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:14:50.161 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:14:58.596 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:14:58.596 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:14:58.632 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:14:58.633 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:14:58.633 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:14:58.671 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:14:58.672 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:14:58.672 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:14:58.686 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:16:23.881 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:23.881 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:23.885 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:24.055 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:16:24.055 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:16:24.185 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:16:24.185 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:16:24.185 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:16:24.321 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:16:24.322 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:16:24.322 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:16:24.335 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:16:25.395 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:25.396 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:25.401 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:25.671 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 11:16:25.672 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 11:16:25.673 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 11:16:25.673 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:16:25.673 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 11:16:25.676 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 11:16:25.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:25.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:25.850 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:26.029 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 11:16:26.029 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 11:16:26.032 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 11:16:26.036 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 11:16:26.036 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 11:16:26.036 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 11:16:26.036 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 11:16:26.037 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 11:16:26.037 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:16:26.037 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 11:16:26.037 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 11:16:26.037 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 11:16:26.038 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 11:16:26.040 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 11:16:26.040 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 11:16:26.042 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 11:16:26.042 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:16:26.042 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 11:16:26.044 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 2
2018-01-22 11:16:26.054 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 11:16:26.054 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:16:26.054 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 11:16:26.055 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:16:26.055 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 11:16:26.055 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:16:26.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 11:16:26.057 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 11:16:26.057 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:16:26.057 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 11:16:26.058 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 11:16:26.059 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 11:16:26.059 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 11:16:26.060 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 11:16:27.595 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:27.595 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:27.599 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:27.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 11:16:27.846 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:16:27.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 11:16:27.846 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:27.848 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 11:16:27.849 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:27.849 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 11:16:27.849 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 11:16:27.865 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 11:16:27.871 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 11:16:27.957 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 11:16:27.958 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 11:16:27.958 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:16:27.961 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 11:16:27.965 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:16:27.965 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:16:27.965 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:28.108 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:16:28.733 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:28.733 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:28.738 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:29.375 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 11:16:29.375 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 11:16:29.375 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 11:16:29.375 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:16:29.375 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:16:29.375 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 11(String), 2018-01-22 11(String)
2018-01-22 11:16:29.377 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 11:16:29.377 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 11:16:29.377 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 11:16:29.379 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 11:16:29.379 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 11:16:29.399 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 11:16:29.399 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 11:16:29.503 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 11:16:29.508 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 11:16:30.914 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:30.915 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:30.918 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:31.206 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:16:31.206 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:31.209 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:16:31.209 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:31.313 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:16:31.313 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:16:31.313 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:16:31.317 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:16:31.318 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:16:31.319 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:16:31.319 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:31.462 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:16:37.146 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:37.147 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:37.150 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:37.480 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:16:37.481 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 11:16:37.483 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:16:37.483 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 11:16:37.489 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 11:16:37.489 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:38.154 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 11:16:38.191 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 11:16:38.196 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 11:16:38.346 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:38.346 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:38.350 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:38.743 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:16:38.743 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 11:16:38.745 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:16:38.745 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 11:16:38.750 DEBUG 11252 --- [http-nio-9998-exec-8] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-22 11:16:38.750 DEBUG 11252 --- [http-nio-9998-exec-8] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:39.418 DEBUG 11252 --- [http-nio-9998-exec-8] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-22 11:16:39.442 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-22 11:16:39.468 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-22 11:16:41.382 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:16:41.382 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 11:16:41.384 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:16:41.384 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 11:16:41.384 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:16:41.385 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:16:41.388 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 11:16:41.388 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:16:41.389 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:16:42.043 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 11:16:42.043 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 11:16:42.046 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 11:16:52.215 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:16:52.216 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-09-15(String), 2018-01-22(String)
2018-01-22 11:16:52.891 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 11:16:53.692 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:16:53.692 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:16:54.362 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 11:16:54.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:16:54.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:16:55.560 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:16:55.561 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:16:55.561 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:16:56.224 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 10
2018-01-22 11:16:56.225 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:16:56.226 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:16:56.244 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:00.218 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '少年儿童') 
2018-01-22 11:17:00.218 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:00.324 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:00.324 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','少年儿童') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:00.324 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:00.468 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 10
2018-01-22 11:17:00.468 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:00.468 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:00.481 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:07.996 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('城乡居民(一)', '城乡居民(二)') 
2018-01-22 11:17:07.996 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:08.062 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:08.062 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('城乡居民(一)','城乡居民(二)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:08.062 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:08.153 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:17:08.154 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:08.154 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:08.167 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:14.140 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:17:14.140 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:14.271 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:14.271 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:14.271 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:14.402 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 10
2018-01-22 11:17:14.402 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:14.402 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:14.419 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:28.200 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:17:28.201 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:28.886 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:28.886 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:28.886 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:29.551 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 10
2018-01-22 11:17:29.552 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:29.552 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:29.567 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:34.307 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '少年儿童') 
2018-01-22 11:17:34.308 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:34.393 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:34.393 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','少年儿童') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:34.393 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:34.476 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 10
2018-01-22 11:17:34.476 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:34.476 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:34.489 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:40.306 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('城乡居民', '城乡居民(一)') 
2018-01-22 11:17:40.306 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:40.366 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:40.366 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('城乡居民','城乡居民(一)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:40.366 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:40.450 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 2
2018-01-22 11:17:40.450 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:40.450 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:40.464 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:46.277 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:17:46.277 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:46.975 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:46.975 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:17:46.975 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 4(String), 出院(String), 2017-09-15(String), 2018-01-19(String)
2018-01-22 11:17:47.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 10
2018-01-22 11:17:47.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:17:47.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:47.651 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:17:50.690 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:17:50.690 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 11:17:50.694 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:17:50.694 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 11:17:50.694 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:17:50.695 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:17:50.697 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-22 11:17:50.697 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:17:50.700 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:17:51.339 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-22 11:17:51.345 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-22 11:17:51.350 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-22 11:17:57.660 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:17:57.660 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:17:57.665 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:17:57.863 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:17:57.863 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:17:58.012 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:17:58.013 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 11:17:58.013 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:17:58.030 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:18:00.134 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:18:00.134 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:18:00.137 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:18:00.450 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:18:00.450 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 11:18:00.451 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:18:00.451 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 11:18:00.454 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 11:18:00.454 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:18:00.877 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 11:18:00.892 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 11:18:00.939 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 11:18:01.869 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:18:01.869 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:18:01.873 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:18:02.177 DEBUG 11252 --- [http-nio-9998-exec-9] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 11:18:02.177 DEBUG 11252 --- [http-nio-9998-exec-9] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 11:18:02.177 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 11:18:02.177 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 11:18:02.181 DEBUG 11252 --- [http-nio-9998-exec-6] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-22 11:18:02.181 DEBUG 11252 --- [http-nio-9998-exec-6] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 11:18:02.604 DEBUG 11252 --- [http-nio-9998-exec-6] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-22 11:18:02.611 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-22 11:18:02.653 DEBUG 11252 --- [http-nio-9998-exec-9] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-22 11:18:06.461 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:18:06.461 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:18:06.463 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:18:06.463 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:06.465 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:18:06.590 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:18:06.590 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:06.590 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:06.718 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:18:06.719 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:18:06.719 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:06.734 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:18:09.331 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:18:09.331 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:18:09.335 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:18:09.576 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 11:18:09.577 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:09.581 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:18:09.581 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:09.601 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 11:18:09.710 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 11:18:09.710 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:09.711 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:09.840 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:18:11.303 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:18:11.303 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:11.305 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:18:11.306 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:11.437 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:18:11.437 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:11.437 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:11.471 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:18:11.573 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:18:11.573 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:18:11.573 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:11.591 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:18:16.205 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:18:16.205 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:16.271 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:18:16.271 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:16.271 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:16.365 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 1
2018-01-22 11:18:16.365 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:18:16.365 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:16.382 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:18:20.463 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:18:20.463 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:20.465 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:18:20.465 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:20.588 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:18:20.588 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:18:20.589 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:20.589 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:20.720 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:18:20.720 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:18:20.720 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:20.735 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:18:25.417 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:18:25.418 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:25.419 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:18:25.419 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:25.546 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:18:25.547 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:25.547 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:25.549 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:18:25.679 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:18:25.680 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:18:25.680 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:25.694 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:18:29.788 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:18:29.788 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:29.827 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:18:29.827 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:29.827 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:29.869 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 1
2018-01-22 11:18:29.869 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:18:29.869 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:29.885 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:18:37.852 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:18:37.852 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:18:37.854 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:18:37.854 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:37.979 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:18:37.979 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:18:37.979 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:18:37.981 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:18:38.110 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:18:38.110 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:18:38.110 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:18:38.126 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:26:36.450 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:26:36.452 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:26:36.579 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:26:36.599 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:26:36.599 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:26:36.750 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:26:36.751 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:26:36.751 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:26:36.914 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:26:36.915 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:26:36.915 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:26:36.931 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:27:23.311 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:27:23.311 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:27:23.315 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:27:24.747 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:27:24.748 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:27:24.751 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:27:24.753 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:27:24.753 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:24.879 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:27:24.879 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:27:24.879 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:25.007 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:27:25.007 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:27:25.007 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:25.024 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:27:28.082 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:27:28.082 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:28.083 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:27:28.084 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:28.230 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:27:28.230 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:27:28.231 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:28.241 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:27:28.241 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:27:28.241 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:28.399 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:27:28.399 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:27:28.400 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:27:28.400 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:28.412 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:27:36.395 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:27:36.395 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:36.397 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:27:36.398 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:36.540 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:27:36.540 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:27:36.540 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:36.550 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:27:36.550 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:27:36.550 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:36.706 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:27:36.707 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:27:36.707 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:36.708 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:27:36.726 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:27:41.013 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:27:41.013 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:41.077 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:27:41.077 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:27:41.077 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:41.146 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:27:41.146 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:27:41.146 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:41.161 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:27:44.282 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:27:44.282 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:44.283 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:27:44.284 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:44.424 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:27:44.424 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:27:44.424 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:44.435 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:27:44.435 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:27:44.436 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:44.591 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:27:44.602 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:27:44.602 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:27:44.602 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:44.619 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:27:51.138 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 11:27:51.138 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:27:51.138 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:51.138 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:27:51.140 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:27:51.140 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:51.142 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:27:51.155 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 11:27:51.246 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 11:27:51.246 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:27:51.246 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:51.359 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:27:52.890 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:27:52.890 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:27:52.892 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:27:52.892 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:53.002 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:27:53.048 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:27:53.048 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:27:53.048 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:53.201 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:27:53.202 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:27:53.202 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:53.219 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:27:57.229 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('少年儿童') 
2018-01-22 11:27:57.230 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:27:57.267 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:27:57.268 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:27:57.268 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:27:57.282 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:28:00.101 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 11:28:00.101 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:28:00.104 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:28:00.104 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:28:00.228 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 11:28:00.244 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 11:28:00.244 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:28:00.244 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:28:00.388 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 11:28:00.389 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:28:00.389 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:28:00.392 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:30:16.711 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:30:16.712 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:30:16.824 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:30:16.824 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:30:16.824 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:30:16.936 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:30:16.936 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:30:16.936 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:30:16.938 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:30:16.951 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:30:16.951 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:30:16.955 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:30:17.747 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:30:17.747 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:17.753 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:30:17.754 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:17.877 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:30:17.877 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:30:17.877 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:17.908 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:30:17.908 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:30:17.908 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:18.009 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:30:18.076 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:30:18.076 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:30:18.076 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:30:18.094 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:30:21.558 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:30:21.558 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:30:21.622 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:30:21.622 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:30:21.622 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:30:21.687 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:30:21.687 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:30:21.687 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:30:21.703 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:30:24.597 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:30:24.598 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:24.602 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:30:24.602 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:24.743 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:30:24.743 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:30:24.743 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:24.746 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:30:24.746 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:30:24.746 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:30:24.887 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:30:24.888 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:30:24.888 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:30:24.891 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:30:24.908 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:36:13.418 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:36:13.419 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:36:13.422 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:36:13.659 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:36:13.659 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:36:13.785 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:36:13.785 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:36:13.786 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:36:13.916 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:36:13.916 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:36:13.916 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:36:13.932 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:36:17.159 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:36:17.159 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:17.162 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:36:17.162 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:17.300 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:36:17.300 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:36:17.300 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:17.302 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:36:17.302 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:36:17.304 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:17.438 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:36:17.438 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:36:17.438 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:36:17.442 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:36:17.457 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:36:22.071 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:36:22.071 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:36:22.141 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:36:22.141 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:36:22.141 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:36:22.208 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:36:22.209 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:36:22.209 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:36:22.224 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:36:25.790 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:36:25.790 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:25.794 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:36:25.794 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:25.934 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:36:25.934 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:36:25.934 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:36:25.934 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:25.934 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:36:25.935 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:36:26.079 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:36:26.079 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:36:26.079 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:36:26.084 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:36:26.092 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:36:31.785 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:36:31.785 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:36:31.789 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:36:32.000 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:36:32.000 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:36:32.126 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:36:32.126 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:36:32.126 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:36:32.254 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:36:32.254 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:36:32.254 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:36:32.270 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:37:19.565 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:37:19.565 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:37:19.569 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:37:19.774 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:37:19.774 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:37:19.900 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:37:19.900 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:37:19.900 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:37:20.031 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:37:20.031 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:37:20.031 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:37:20.044 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:37:20.672 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:37:20.672 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:37:20.677 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:37:20.852 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:37:20.852 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:37:20.977 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:37:20.977 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:37:20.977 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:37:21.105 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:37:21.105 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:37:21.105 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:37:21.121 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:37:23.734 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:37:23.735 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:23.739 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:37:23.739 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:23.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:37:23.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:37:23.875 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:23.877 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:37:23.877 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:37:23.879 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:24.031 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:37:24.031 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:37:24.031 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:37:24.034 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:37:24.043 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:37:30.023 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:37:30.023 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:37:30.088 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:37:30.088 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:37:30.088 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:37:30.151 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:37:30.152 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:37:30.152 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:37:30.169 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:37:33.698 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:37:33.698 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:33.702 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:37:33.703 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:33.840 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:37:33.840 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:37:33.841 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:37:33.841 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:33.841 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:37:33.844 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:37:33.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:37:33.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:37:33.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:37:33.988 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:37:34.002 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:37:59.771 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:37:59.771 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:37:59.774 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:38:00.122 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:38:00.122 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:38:00.247 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:38:00.247 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:38:00.247 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:38:00.378 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:38:00.378 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:38:00.378 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:38:00.394 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:38:01.818 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:38:01.818 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:01.821 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:38:01.821 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:01.961 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:38:01.961 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:38:01.961 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:01.963 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:38:01.963 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:38:01.963 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:02.110 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:38:02.110 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:38:02.110 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:38:02.113 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:38:02.123 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:38:07.562 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:38:07.562 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:38:07.623 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:38:07.623 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:38:07.623 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:38:07.690 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:38:07.691 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:38:07.691 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:38:07.713 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:38:18.197 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:38:18.197 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:18.199 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:38:18.199 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:18.337 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:38:18.337 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:38:18.337 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:18.340 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:38:18.340 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:38:18.342 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:38:18.488 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:38:18.489 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:38:18.489 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:38:18.492 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:38:18.508 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:55:31.896  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 11:55:31.896  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 11:55:31.985 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 11:55:31.985 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 11:55:31.987 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 11:55:33.048 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:55:33.048 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:55:33.052 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:55:33.652 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:55:33.652 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:55:33.656 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:55:33.876 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 11:55:33.876 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 11:55:33.877 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 11:55:33.877 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:55:33.877 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 11:55:33.880 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 11:55:36.558 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:55:36.558 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:55:36.562 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:55:36.704 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:55:36.704 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:55:36.830 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:55:36.830 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:55:36.830 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:55:36.959 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:55:36.959 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:55:36.959 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:55:36.978 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:55:38.378 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:55:38.378 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:38.382 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:55:38.382 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:38.522 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:55:38.522 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:55:38.523 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:38.552 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:55:38.552 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:55:38.553 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:38.678 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:55:38.726 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:55:38.726 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:55:38.726 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:55:38.729 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:55:42.929 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:55:42.929 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:55:42.999 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:55:42.999 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:55:42.999 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:55:43.087 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:55:43.087 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:55:43.087 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:55:43.090 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:55:45.724 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:55:45.724 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:45.727 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:55:45.727 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:45.852 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:55:45.853 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:55:45.853 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:45.882 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:55:45.882 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:55:45.882 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:55:45.985 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:55:46.050 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:55:46.050 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:55:46.050 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:55:46.065 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:58:57.681 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:58:57.681 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:58:57.685 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:59:05.738 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 11:59:05.738 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 11:59:05.742 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 11:59:06.110 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 11:59:06.110 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:59:06.234 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 11:59:06.235 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 11:59:06.235 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:59:06.363 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 11:59:06.363 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 11:59:06.363 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:59:06.379 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 11:59:18.067 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:59:18.067 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:18.071 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:59:18.071 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:18.207 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:59:18.207 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:59:18.207 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:18.217 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:59:18.217 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:59:18.218 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:18.364 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:59:18.364 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:59:18.364 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:59:18.369 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:59:18.369 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 11:59:21.914 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 11:59:21.914 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:59:21.979 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:59:21.979 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:59:21.979 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 11:59:22.052 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 11:59:22.052 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:59:22.052 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:59:22.070 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:59:24.482 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 11:59:24.482 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:24.487 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 11:59:24.487 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:24.624 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 11:59:24.625 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 11:59:24.625 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:24.637 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 11:59:24.637 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 11:59:24.637 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 11:59:24.784 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 11:59:24.784 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 11:59:24.784 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 11:59:24.788 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 11:59:24.793 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:31:56.929  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 13:31:56.930  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 13:31:57.091  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findMedicareSettlementList
2018-01-22 13:31:57.091  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 13:31:57.160 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 13:31:57.160 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 13:31:57.163 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 13:31:57.303 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:31:57.303 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:31:57.306 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:31:57.371 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 13:31:57.371 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 13:31:57.373 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 13:31:58.323 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:31:58.324 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:31:58.327 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:31:59.809 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:31:59.809 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:31:59.813 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:31:59.992 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 13:31:59.992 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 13:31:59.993 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 13:31:59.994 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:31:59.994 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 13:31:59.997 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 13:32:02.287 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:32:02.287 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:32:02.291 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:32:02.420 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:32:02.421 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:32:02.546 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:32:02.546 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:32:02.546 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:32:02.677 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:32:02.678 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:32:02.678 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:32:02.693 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:32:03.791 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:32:03.791 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:03.794 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:32:03.794 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:03.935 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:32:03.935 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:32:03.935 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:03.941 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:32:03.941 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:32:03.941 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:04.087 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:32:04.087 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:32:04.087 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:32:04.090 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:32:04.101 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:32:07.596 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 13:32:07.596 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:32:07.663 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:32:07.663 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:32:07.663 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:32:07.730 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:32:07.730 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:32:07.731 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:32:07.748 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:32:10.148 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:32:10.149 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:10.153 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:32:10.153 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:10.289 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:32:10.290 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:32:10.290 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:10.303 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:32:10.303 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:32:10.303 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:32:10.454 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:32:10.454 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:32:10.454 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:32:10.456 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:32:10.457 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:33:36.033 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:33:36.033 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:33:36.037 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:33:36.240 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:33:36.240 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:33:36.351 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:33:36.351 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:33:36.351 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:33:36.462 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:33:36.462 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:33:36.462 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:33:36.465 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:33:37.881 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:33:37.881 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:37.885 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:33:37.885 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:38.008 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:33:38.009 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:33:38.009 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:38.041 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:33:38.041 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:33:38.041 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:38.140 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:33:38.201 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:33:38.201 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:33:38.201 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:33:38.218 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:33:43.992 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 IN ('新市医保', '新省值医保') 
2018-01-22 13:33:43.992 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:33:44.228 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:33:44.229 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 医保类别 in ('新市医保','新省值医保') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:33:44.229 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:33:44.487 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:33:44.488 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:33:44.488 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:33:44.503 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:33:49.460 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:33:49.460 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:49.463 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:33:49.463 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:49.601 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:33:49.602 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:33:49.602 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:49.611 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:33:49.611 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:33:49.611 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:33:49.759 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:33:49.759 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:33:49.759 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:33:49.763 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:33:49.774 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:38:06.119 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:38:06.119 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:38:06.123 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:38:06.546 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:38:06.546 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:38:06.662 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:38:06.662 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:38:06.662 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:38:06.779 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:38:06.780 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:38:06.780 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:38:06.793 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:38:42.781 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:38:42.781 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:38:42.785 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:38:43.184 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:38:43.185 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:38:43.294 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:38:43.294 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:38:43.294 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:38:43.422 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:38:43.423 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:38:43.423 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:38:43.435 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:38:49.370 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:38:49.370 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:49.375 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:38:49.375 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:49.504 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:38:49.505 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:38:49.505 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:49.514 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:38:49.515 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:38:49.515 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:49.650 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:38:49.651 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:38:49.651 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:38:49.654 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:38:49.670 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:38:53.872 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童') 
2018-01-22 13:38:53.872 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:38:53.898 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:38:53.898 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:38:53.898 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:38:53.912 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:38:57.296 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:38:57.296 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:57.298 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:38:57.298 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:57.430 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:38:57.430 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:38:57.430 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:57.437 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:38:57.438 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:38:57.438 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:38:57.590 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:38:57.598 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:38:57.598 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:38:57.598 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:38:57.601 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:16.067 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:43:16.067 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:43:16.071 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:43:16.520 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:43:16.520 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:43:16.626 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:43:16.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:43:16.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:43:16.727 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:43:16.728 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:43:16.728 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:16.730 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:43:19.414 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:43:19.414 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:19.418 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:43:19.418 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:19.536 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:43:19.536 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:43:19.536 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:19.557 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:43:19.558 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:43:19.558 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:19.657 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:43:19.705 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:43:19.705 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:43:19.705 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:19.721 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:23.391 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('成年居民(非从业)', '城乡居民') 
2018-01-22 13:43:23.391 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:43:23.449 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:43:23.449 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('成年居民(非从业)','城乡居民') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:43:23.450 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:43:23.522 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:43:23.523 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:43:23.523 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:23.541 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:26.467 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:43:26.467 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:26.470 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '城乡居民') 
2018-01-22 13:43:26.470 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:26.513 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:43:26.513 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','城乡居民') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:43:26.513 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:26.579 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:43:26.580 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:43:26.580 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:26.583 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:26.609 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:43:26.609 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:43:26.609 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:26.753 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:43:31.024 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:43:31.024 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:31.026 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '城乡居民') 
2018-01-22 13:43:31.026 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:31.063 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:43:31.063 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','城乡居民') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:43:31.063 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:31.102 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:43:31.103 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:43:31.103 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:31.107 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:31.163 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:43:31.164 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:43:31.164 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:31.314 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:43:36.845 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:43:36.845 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:36.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '城乡居民') 
2018-01-22 13:43:36.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:36.887 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:43:36.887 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','城乡居民') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:43:36.887 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:36.927 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:43:36.927 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:43:36.927 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:36.931 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:36.989 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:43:36.989 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:43:36.990 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:37.134 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:43:55.169 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:43:55.169 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:43:55.173 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:43:55.593 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:43:55.593 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:43:55.710 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:43:55.710 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:43:55.710 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:43:55.826 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:43:55.826 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:43:55.827 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:55.845 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:43:57.604 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:43:57.604 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:57.609 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:43:57.609 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:57.741 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:43:57.742 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:43:57.742 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:57.744 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:43:57.744 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:43:57.744 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:43:57.884 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:43:57.884 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:43:57.884 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:43:57.888 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:43:57.900 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:44:01.997 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('成年居民(非从业)', '少年儿童') 
2018-01-22 13:44:01.997 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:02.064 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:44:02.065 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('成年居民(非从业)','少年儿童') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:44:02.065 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:02.143 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:44:02.143 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:44:02.144 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:02.157 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:44:05.262 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:44:05.262 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:05.263 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:44:05.263 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:05.394 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:44:05.394 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:44:05.394 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:05.407 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:44:05.407 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:44:05.408 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:05.535 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:44:05.535 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:44:05.535 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:05.539 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:44:05.551 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:44:14.496 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:44:14.496 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:14.500 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:44:14.500 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:14.634 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:44:14.634 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:44:14.634 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:14.642 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:44:14.642 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:44:14.642 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:14.774 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:44:14.775 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:44:14.775 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:14.780 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:44:14.792 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:44:45.359 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:44:45.359 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:44:45.363 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:44:45.789 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:44:45.789 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:45.905 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:44:45.905 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:44:45.905 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:46.021 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:44:46.021 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:44:46.021 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:46.034 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:44:47.254 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:44:47.255 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:44:47.258 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:44:47.573 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:44:47.573 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:47.578 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:44:47.578 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:47.598 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:44:47.685 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:44:47.685 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:44:47.685 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:47.786 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:44:49.596 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:44:49.596 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:44:49.600 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:44:49.831 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 13:44:49.831 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 13:44:49.838 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 13:44:49.838 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 13:44:49.954 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 13:44:49.978 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 13:44:49.978 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:44:49.978 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:49.995 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:44:53.153 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:44:53.153 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:53.155 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:44:53.155 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:53.156 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:44:53.156 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:44:53.160 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:44:53.174 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:44:53.255 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:44:53.255 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:44:53.255 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:53.356 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:44:54.583 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:44:54.583 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:44:54.585 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:44:54.586 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:54.686 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:44:54.720 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:44:54.720 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:44:54.720 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:54.883 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:44:54.883 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:44:54.883 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:54.899 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:44:58.511 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '少年儿童') 
2018-01-22 13:44:58.511 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:58.578 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:44:58.579 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','少年儿童') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:44:58.579 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:44:58.656 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 1
2018-01-22 13:44:58.657 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:44:58.657 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:44:58.670 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:45:01.314 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:45:01.314 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:45:01.318 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:45:01.318 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:01.435 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:45:01.446 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:45:01.446 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:45:01.447 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:01.580 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:45:01.580 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:45:01.580 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:45:01.583 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:45:04.754 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:45:04.754 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:45:04.757 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:45:04.757 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:04.862 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:45:04.896 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:45:04.896 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:45:04.897 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:05.044 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:45:05.044 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:45:05.044 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:45:05.060 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:45:10.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 13:45:10.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:10.259 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:45:10.259 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:45:10.259 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:10.340 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 1
2018-01-22 13:45:10.340 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:45:10.340 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:45:10.354 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:45:13.695 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:45:13.695 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:45:13.697 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:45:13.697 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:13.817 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:45:13.825 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:45:13.826 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:45:13.826 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:45:13.957 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:45:13.958 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:45:13.958 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:45:13.962 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:04.220 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:46:04.220 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:46:04.223 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:46:04.653 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:46:04.653 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:04.658 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:46:04.659 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:04.659 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:46:04.776 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:46:04.776 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:04.776 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:04.891 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:07.074 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:46:07.074 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:07.077 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:46:07.077 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:07.195 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:07.208 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:07.209 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:07.209 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:07.344 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:46:07.347 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:07.347 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:07.350 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:13.875 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:46:13.875 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:46:13.879 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:46:14.312 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:46:14.313 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:14.317 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:46:14.317 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:14.318 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:46:14.433 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:46:14.433 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:14.433 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:14.550 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:19.827 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:46:19.827 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:19.830 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:46:19.830 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:19.950 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:19.965 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:19.965 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:19.965 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:20.099 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:46:20.099 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:20.099 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:20.103 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:25.656 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '少年儿童') 
2018-01-22 13:46:25.656 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:25.699 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:25.699 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','少年儿童') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:25.699 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:25.749 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 1
2018-01-22 13:46:25.750 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:25.750 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:25.753 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:29.673 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:46:29.673 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:29.676 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:46:29.676 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:29.781 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:29.818 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:29.818 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:29.818 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:29.960 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:46:29.961 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:29.961 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:29.974 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:47.605 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:46:47.606 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:47.608 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:46:47.608 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:47.726 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:47.740 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:47.740 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:47.741 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:47.875 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:46:47.875 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:47.875 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:47.878 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:51.978 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 AND 参保类型 IN ('成年居民(非从业)', '少年儿童') 
2018-01-22 13:46:51.978 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:52.021 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:52.021 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 AND 参保类型 in ('成年居民(非从业)','少年儿童') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:52.021 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:52.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 1
2018-01-22 13:46:52.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:52.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:52.076 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:46:55.307 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:46:55.307 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:46:55.310 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:46:55.310 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:55.415 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:46:55.452 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:46:55.452 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:46:55.452 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:46:55.597 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:46:55.598 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:46:55.598 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:46:55.614 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:50:58.460 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:50:58.460 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:50:58.464 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:50:58.911 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:50:58.911 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:50:58.913 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:50:58.913 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:50:58.931 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:50:59.014 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:50:59.014 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:50:59.014 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:50:59.115 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:51:02.379 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:51:02.379 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:02.382 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:02.382 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:02.481 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:51:02.516 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:51:02.516 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:51:02.516 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:02.646 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:51:02.647 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:02.647 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:02.663 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:05.610 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:51:05.611 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:51:05.614 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:51:05.789 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:51:05.789 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:05.904 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:51:05.905 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:51:05.905 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:06.023 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:51:06.023 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:51:06.023 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:06.037 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:51:07.005 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:07.005 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:07.009 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:07.009 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:07.137 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:07.137 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:07.137 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:07.148 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:07.149 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:07.149 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:07.282 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:07.283 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:07.283 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:07.286 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:07.304 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:08.702 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:08.702 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:08.704 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:08.704 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:08.834 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:08.834 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:08.834 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:08.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:08.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:08.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:08.976 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:08.976 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:08.976 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:08.982 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:09.003 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:09.302 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:09.302 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.306 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:09.307 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.439 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:09.439 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.440 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:09.440 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:09.440 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:09.441 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.441 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.445 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:09.445 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:09.445 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.579 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:09.579 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:09.579 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.583 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:09.583 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:09.583 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.591 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:09.592 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:09.592 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:09.595 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:09.609 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:09.612 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:09.613 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.617 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:09.617 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.729 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:09.734 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:09.735 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:09.735 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:09.750 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:09.750 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:09.750 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.751 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:09.751 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:09.752 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:09.753 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.793 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:09.793 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.795 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:09.795 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.888 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:09.888 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:09.888 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:09.891 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:09.909 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:09.935 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:09.935 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:09.935 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:09.973 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:09.973 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:09.973 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:10.006 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:51:10.006 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:10.009 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:51:10.009 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:10.078 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:10.078 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:10.078 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:10.097 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:10.137 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:10.143 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:51:10.143 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:51:10.143 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:10.159 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:51:10.159 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:51:10.160 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:51:10.282 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:51:10.282 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:51:10.282 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:10.286 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:51:10.305 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:51:36.500 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:51:36.500 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:51:36.505 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:51:40.099 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:51:40.099 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:40.215 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:51:40.216 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:51:40.216 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:40.335 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:51:40.335 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:51:40.335 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:40.352 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:51:58.249 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:51:58.250 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:51:58.254 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:51:58.702 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:51:58.702 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:58.819 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:51:58.819 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:51:58.819 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:51:58.936 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:51:58.936 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:51:58.936 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:51:58.949 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:52:23.162 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:52:23.162 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:52:23.167 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:52:23.592 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:52:23.592 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:52:23.708 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:52:23.708 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:52:23.708 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:52:23.826 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:52:23.826 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:52:23.826 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:52:23.842 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:52:38.713 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:52:38.713 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:52:38.717 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:52:39.137 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:52:39.137 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:52:39.254 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:52:39.254 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:52:39.254 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:52:39.372 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:52:39.372 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:52:39.372 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:52:39.385 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:54:08.335 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:54:08.335 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:54:08.338 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:54:08.766 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:54:08.766 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:54:08.882 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:54:08.882 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:54:08.882 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:54:09.001 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:54:09.001 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:54:09.001 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:54:09.014 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:54:41.506 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:54:41.506 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:41.510 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:54:41.510 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:41.640 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:54:41.641 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:54:41.641 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:41.649 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:54:41.649 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:54:41.649 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:41.781 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:54:41.781 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:54:41.781 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:54:41.785 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:54:41.802 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:54:45.594 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 IN ('少年儿童', '成年居民(非从业)') 
2018-01-22 13:54:45.594 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:54:45.644 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:54:45.644 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND 参保类型 in ('少年儿童','成年居民(非从业)') order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:54:45.644 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:54:45.699 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 1
2018-01-22 13:54:45.699 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:54:45.699 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:54:45.713 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:54:48.404 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 13:54:48.404 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:48.409 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:54:48.409 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:48.546 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 13:54:48.546 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 13:54:48.546 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:48.551 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 13:54:48.551 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 13:54:48.551 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:54:48.695 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 13:54:48.695 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:54:48.695 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:54:48.698 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:54:48.699 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 13:57:06.095 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:57:06.095 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:57:06.099 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:57:06.558 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:57:06.558 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:06.675 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 13:57:06.675 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:06.675 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:06.796 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 13:57:06.796 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 13:57:06.796 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:06.809 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 13:57:07.775 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:57:07.775 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:57:07.779 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:57:08.094 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:57:08.094 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:08.097 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:57:08.097 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:08.110 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:57:08.203 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:57:08.203 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:08.203 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:08.304 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:57:09.212 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:57:09.212 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:09.217 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:57:09.217 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:09.314 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:57:09.355 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:57:09.355 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:09.355 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:09.503 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:57:09.503 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:57:09.503 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:09.523 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:57:12.357 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:57:12.357 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:12.484 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:57:12.484 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主手术 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:12.484 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:12.648 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:57:12.649 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:57:12.649 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:12.664 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:57:17.599 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:57:17.599 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:17.601 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:57:17.601 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:17.721 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:57:17.729 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:57:17.729 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:17.729 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:17.862 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:57:17.862 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:57:17.862 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:17.866 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:57:38.827 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 13:57:38.827 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 13:57:38.831 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 13:57:39.275 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 13:57:39.275 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:39.278 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 13:57:39.278 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:39.281 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 13:57:39.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 13:57:39.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:39.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:39.509 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:57:41.598 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:57:41.598 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:41.600 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:57:41.600 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:41.721 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:57:41.732 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:57:41.732 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:41.732 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:41.869 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:57:41.871 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:57:41.871 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:41.874 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:57:43.510 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:57:43.510 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:43.639 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:57:43.639 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.手术医保编码 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:43.639 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:43.805 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:57:43.806 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:57:43.806 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:43.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 13:57:46.364 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 13:57:46.365 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 13:57:46.366 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 13:57:46.366 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:46.472 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 13:57:46.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 13:57:46.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 13:57:46.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 13:57:46.655 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 13:57:46.656 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 13:57:46.656 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 13:57:46.671 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:00:30.787 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:00:30.788 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:00:30.905 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:00:30.920 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:00:30.920 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:00:31.058 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:00:31.058 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:00:31.058 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:00:31.200 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:00:31.201 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:00:31.201 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:00:31.220 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:00:34.297 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:00:34.297 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:00:34.300 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:00:34.300 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:00:34.425 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:00:34.436 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:00:34.436 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:00:34.436 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:00:34.575 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:00:34.575 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:00:34.575 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:00:34.578 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:00:41.233 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:00:41.233 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:00:41.237 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:00:41.776 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:00:41.776 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:00:41.782 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:00:41.782 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:00:41.782 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:00:41.897 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:00:41.897 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:00:41.898 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:00:42.013 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:17:49.951  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 14:17:49.951  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 14:17:50.089 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 14:17:50.089 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-22 14:17:50.090 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 14:17:50.221 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:17:50.221 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 14:17:50.223 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:17:50.224 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:17:50.224 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 14:17:50.224 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:17:50.224 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 14:17:50.225 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 14:17:50.226 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:17:50.226 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:17:50.226 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 14:17:50.226 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 14:17:50.226 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 14:17:50.228 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 14:17:50.228 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 14:17:50.230 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 14:17:50.230 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:17:50.230 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 14:17:50.233 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-22 14:17:50.238 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 14:17:50.238 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:17:50.238 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 14:17:50.239 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:17:50.239 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:17:50.240 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:17:50.240 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 14:17:50.241 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:17:50.241 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:17:50.241 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 14:17:50.242 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:17:50.242 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:17:50.242 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 14:17:50.243 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 14:17:51.745 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:17:51.745 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:17:51.750 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:17:56.131 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:17:56.131 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:17:56.135 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:18:05.622 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:18:05.622 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:18:05.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:18:06.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:18:06.851 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:18:06.854 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:18:07.146 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 14:18:07.146 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 14:18:07.148 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 14:18:07.148 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 14:18:07.148 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:18:07.148 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 14:18:07.148 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 14(String), 2018-01-22 14(String)
2018-01-22 14:18:07.148 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 14:18:07.164 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 14:18:07.164 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 14:18:07.165 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 14:18:07.167 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 14:18:07.167 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 14:18:07.264 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 14:18:07.268 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 14:18:10.205 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:18:10.205 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:18:10.209 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:18:10.392 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:18:10.392 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 14:18:10.394 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:18:10.395 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:18:10.395 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 14:18:10.395 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 14:18:10.396 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 14:18:10.397 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:18:10.397 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 14:18:10.398 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 14:18:10.398 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:18:10.398 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 14:18:10.400 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-22 14:18:10.401 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:18:10.411 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 14:18:10.411 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:10.411 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 14:18:10.413 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:18:10.413 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:10.413 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 14:18:10.414 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:18:10.414 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:10.414 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 14:18:10.416 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:18:10.416 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:10.416 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 14:18:10.417 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 14:18:16.027 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:18:16.027 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:18:16.031 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:18:16.261 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:18:16.261 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 14:18:16.262 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:18:16.263 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:18:16.263 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 14:18:16.263 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 14:18:16.263 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 14:18:16.263 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:18:16.263 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 14:18:16.264 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 14:18:16.264 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:18:16.265 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 14:18:16.265 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 14:18:16.265 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 14:18:16.265 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:18:16.266 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 14:18:16.266 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:18:16.266 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 14:18:16.268 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-22 14:18:16.276 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 14:18:16.276 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:16.276 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 14:18:16.277 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:18:16.277 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:16.277 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 14:18:16.278 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:18:16.279 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:18:16.279 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:16.279 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 14:18:16.281 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:18:16.281 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:18:16.281 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 14:18:16.282 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 14:20:33.858  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 14:20:33.858  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 14:20:34.086 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 14:20:34.086 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: lqy(String)
2018-01-22 14:20:34.088 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 14:20:36.834 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:20:36.834 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:20:36.839 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:20:54.025 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:20:54.025 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:20:54.030 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:20:54.300 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 14:20:54.300 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 14:20:54.302 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 14:20:54.302 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:20:54.302 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 14:20:54.305 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 14:21:08.630  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 14:21:08.630  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 14:21:08.741 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 14:21:08.741 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 14:21:08.743 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 14:21:10.189 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:10.189 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:10.199 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:21.999 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:22.000 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:22.003 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:23.022 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:23.022 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:23.025 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:23.179 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 14:21:23.179 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 14:21:23.189 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 14:21:23.189 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:23.189 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 14:21:23.192 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 14:21:31.625 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:31.625 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:31.628 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:31.748 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:21:31.748 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:31.869 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:21:31.869 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:31.869 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:31.985 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:21:31.986 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:21:31.986 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:31.999 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:21:34.147 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:34.147 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:34.151 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:34.398 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:21:34.398 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:34.401 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:21:34.401 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:34.414 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:21:34.518 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:21:34.518 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:34.518 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:34.634 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:21:36.187 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:21:36.187 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:36.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:21:36.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:21:36.304 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:21:36.327 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:21:36.328 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:36.328 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:21:36.468 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:21:36.468 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:21:36.468 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:36.483 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:21:38.488 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:21:38.488 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:21:38.626 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:21:38.627 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.疾病编码 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:38.627 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:21:38.799 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:21:38.799 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:21:38.799 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:38.813 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:21:42.670 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:21:42.670 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:42.672 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:21:42.672 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:21:42.792 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:21:42.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:21:42.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:42.810 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:21:42.954 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:21:42.954 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:21:42.954 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:42.966 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:21:46.471 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:46.471 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:46.474 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:21:46.474 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:46.475 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:46.592 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:21:46.592 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:46.592 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:46.708 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:21:46.708 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:21:46.708 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:46.725 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:21:47.834 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:21:47.835 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:47.836 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:47.836 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:47.839 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:21:47.839 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:47.840 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:47.851 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:21:47.993 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:21:47.993 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:47.993 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:48.100 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:21:52.835 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:21:52.835 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:21:52.839 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:21:52.839 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:21:52.839 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:52.955 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:21:52.955 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:21:52.955 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:21:53.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:21:53.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:21:53.072 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:21:53.085 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:22:18.310 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 14:22:18.310 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:22:18.311 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 14:22:18.311 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:22:18.312 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 14:22:18.312 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:22:18.312 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 14:22:18.314 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:22:18.315 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 14:22:18.753 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:22:18.754 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:22:18.757 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:22:18.890 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:22:18.890 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 14:22:18.891 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:22:18.891 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 14:22:18.892 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:22:18.893 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:22:18.894 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:22:18.894 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 14:22:18.895 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 14:22:18.895 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 14:22:18.895 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 14:22:18.895 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 14:22:18.895 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 14:22:18.896 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 14:22:18.896 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:22:18.896 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 14:22:18.896 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:22:18.896 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 14:22:18.898 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-22 14:22:18.901 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:22:18.901 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 14:22:18.902 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:22:18.902 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 14:22:18.903 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:22:18.903 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:22:18.903 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 14:22:18.905 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:22:18.905 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:22:18.905 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 14:22:18.907 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:22:18.907 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:22:18.907 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 14:22:18.908 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 14:22:38.412 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:22:38.412 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:22:38.416 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:22:38.643 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==>  Preparing: with t as ( SELECT * from patient_accounting e WHERE (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) and (to_date(e.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) or to_date(e.入院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60))) AND e.医保类别 <> '现金' AND e.控费类型 = ? ), a as (select t.病人ID from t group by t.病人ID having count(1)>1), b as (select t1.病人ID, max(t1.入院日期) 入院日期 from t t1 where exists (select 1 from a where a.病人ID = t1.病人ID) and t1.当前状态 = '在院' group by t1.病人ID), c as (select t2.病人ID, max(t2.出院日期) 出院日期 from t t2 where exists (select 1 from a where a.病人ID = t2.病人ID) and t2.当前状态 = '出院' group by t2.病人ID), d as (select b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 from b, c where b.病人ID = c.病人ID and to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) select nvl(sum(e.所用医保费用), 0) 总亏损, count(1) 总病例 from t e , d WHERE e.病人ID = d.病人ID and e.出院日期 = d.最近出院日期 ORDER BY e. 最后费用日期 
2018-01-22 14:22:38.643 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : ==> Parameters: 1(String)
2018-01-22 14:22:38.650 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==>  Preparing: WITH t AS (SELECT * FROM patient_accounting e WHERE (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM')) AND (to_date(e.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) OR to_date(e.入院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND e.医保类别 <> '现金' AND e.控费类型 = ?), a AS (SELECT t.病人ID FROM t GROUP BY t.病人ID HAVING count(1) > 1), b AS (SELECT t1.病人ID, max(t1.入院日期) 入院日期 FROM t t1 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t1.病人ID) AND t1.当前状态 = '在院' GROUP BY t1.病人ID), c AS (SELECT t2.病人ID, max(t2.出院日期) 出院日期 FROM t t2 WHERE EXISTS (SELECT 1 FROM a WHERE a.病人ID = t2.病人ID) AND t2.当前状态 = '出院' GROUP BY t2.病人ID), d AS (SELECT b.病人ID, b.入院日期 最近入院日期, c.出院日期 最近出院日期 FROM b, c WHERE b.病人ID = c.病人ID AND to_date(b.入院日期, 'yyyy-MM-dd hh24:mi:ss') - to_date(c.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= 15) SELECT count(0) FROM t e, d WHERE e.病人ID = d.病人ID AND e.出院日期 = d.最近出院日期 
2018-01-22 14:22:38.651 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : ==> Parameters: 1(String)
2018-01-22 14:22:38.769 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findNoSettledPatientTitle    : <==      Total: 1
2018-01-22 14:22:38.781 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findNoSettledPatient_COUNT   : <==      Total: 1
2018-01-22 14:22:38.781 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:22:38.781 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:22:38.785 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:22:39.564 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:22:39.564 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:22:39.568 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:22:39.569 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:22:39.569 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:22:39.674 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:22:39.675 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:22:39.675 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:22:39.782 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:22:39.783 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:22:39.783 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:22:39.785 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:22:41.488 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 14:22:41.488 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:22:41.491 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:22:41.491 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:22:41.619 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 14:22:41.620 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 14:22:41.620 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:22:41.621 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 14:22:41.621 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 14:22:41.623 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:22:41.752 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 14:22:41.760 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 14:22:41.761 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:22:41.761 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:22:41.764 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:28:50.348 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:28:50.349 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:28:50.352 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:28:50.781 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:28:50.781 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:28:50.886 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:28:50.887 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:28:50.887 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:28:50.988 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:28:50.989 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:28:50.989 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:28:50.991 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:28:57.028 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 14:28:57.029 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:28:57.032 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:28:57.032 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:28:57.151 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 14:28:57.152 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 14:28:57.152 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:28:57.162 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 14:28:57.162 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 14:28:57.162 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:28:57.271 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 14:28:57.301 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 14:28:57.301 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:28:57.301 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:28:57.304 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:31:26.206 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:31:26.206 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:31:26.210 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:31:30.829 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:31:30.829 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 14:31:30.830 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:31:30.830 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:31:30.830 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 14:31:30.832 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 14:31:30.832 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:31:30.832 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 14:31:30.832 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 14:31:30.832 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 14:31:30.833 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 14:31:30.833 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 14:31:30.834 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 14:31:30.836 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 14:31:30.836 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 14:31:30.836 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:31:30.837 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 14:31:30.837 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:31:30.837 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 14:31:30.839 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-22 14:31:30.847 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 14:31:30.848 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:31:30.848 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 14:31:30.849 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:31:30.849 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:31:30.849 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 14:31:30.850 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:31:30.850 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:31:30.850 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 14:31:30.851 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 14:31:30.851 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 14:31:30.851 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 14:31:30.853 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 14:35:22.355 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:35:22.355 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:35:22.359 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:35:22.775 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:35:22.775 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:35:22.891 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:35:22.891 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:35:22.891 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:35:23.006 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:35:23.006 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:35:23.006 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:35:23.021 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:35:24.592 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 14:35:24.592 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:35:24.597 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:35:24.597 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:35:24.734 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 14:35:24.735 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 14:35:24.735 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:35:24.739 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 14:35:24.739 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 14:35:24.739 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:35:24.879 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 14:35:24.884 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 14:35:24.884 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:35:24.885 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:35:24.900 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:35:49.702 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:35:49.703 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:35:49.707 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:35:50.282 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:35:50.282 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:35:50.399 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:35:50.399 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:35:50.399 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:35:50.516 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:35:50.516 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:35:50.516 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:35:50.529 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:36:01.138 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 14:36:01.138 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:01.141 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:36:01.141 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:01.279 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 14:36:01.279 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 14:36:01.279 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:01.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 14:36:01.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 14:36:01.283 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:01.435 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 14:36:01.436 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:36:01.436 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:36:01.439 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 14:36:01.450 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:36:54.402 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:36:54.402 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:36:54.406 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:36:54.813 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:36:54.813 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:36:54.927 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:36:54.927 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:36:54.927 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:36:55.041 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:36:55.041 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:36:55.041 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:36:55.056 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:36:56.689 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 14:36:56.689 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:56.693 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:36:56.693 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:56.829 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 14:36:56.829 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 14:36:56.829 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:56.833 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 14:36:56.834 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 14:36:56.834 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:36:56.976 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 14:36:56.976 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:36:56.976 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:36:56.984 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 14:36:57.000 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:39:18.497 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:18.497 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:18.501 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:18.686 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:18.686 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:18.807 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:39:18.807 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:18.807 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:18.923 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:39:18.923 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:39:18.923 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:18.936 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:39:25.166 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:25.166 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:25.170 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:25.429 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:39:25.429 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:25.431 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:25.431 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:25.444 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:39:25.545 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:39:25.546 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:25.546 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:25.626 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:25.626 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:25.630 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:25.661 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:39:25.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getXiangMuJieSuanKKBL_COUNT  : ==>  Preparing: WITH mypatient_accounting AS (SELECT "病人ID", "病人姓名", "医保类别", "参保类型", "住院号", "交易流水号", "疾病编码", "主诊断", "手术医保编码", "主手术", "院内疾病编码", "院内主诊断", "院内手术医保编码", "院内主手术", "科室", "医疗小组", "主治医生", "床位号", "最后费用日期", "入院日期", "出院日期", "支付标准价", "CQ材料费", "CG材料费", "总费用", "所用医保费用", "自理金额", "自费金额", "自负金额", "超限床位费", "西药", "中成药", "中草药", "检查费", "治疗费", "手术费", "化验费", "其他费用", "输血费", "输氧费", "诊疗费", "CT片", "MRI片", "床位费", "婴儿费", "护理费", "放疗费", "自负材料费", "材料费", "麻醉费", "注射费", "新生儿筛查", "院前120急救费", "除去超限床位费", "病种比例", "盈亏标识", "盈利", "当前状态", CASE WHEN "控费类型" = '1' THEN '控费诊断+控费手术' WHEN "控费类型" = '2' THEN '控费诊断+非控费手术' WHEN "控费类型" = '3' THEN '非控费诊断+控费手术' WHEN "控费类型" = '4' THEN '非控费诊断+非控费手术' END AS 控费类型 FROM patient_accounting t WHERE EXISTS (SELECT 1 FROM projectsettlementview t2 WHERE t.交易流水号 = t2.交易流水号 AND to_date(t2.导入时间, 'yyyy-MM-dd hh24:mi:ss') BETWEEN to_date('2017-12', 'yyyy-MM') AND add_months(to_date('2017-12', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND t.医保类别 <> '现金' AND t.当前状态 = ?) SELECT count(0) FROM mypatient_accounting t1 LEFT JOIN (SELECT 交易流水号, sum(扣除金额) 项目结算扣款 FROM projectsettlementview GROUP BY 交易流水号) t2 ON t1.交易流水号 = t2.交易流水号 
2018-01-22 14:39:25.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getXiangMuJieSuanKKBL_COUNT  : ==> Parameters: 出院(String)
2018-01-22 14:39:25.902 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getXiangMuJieSuanKKBL_COUNT  : <==      Total: 1
2018-01-22 14:39:25.903 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('xiangmujsbl') ORDER BY column_id 
2018-01-22 14:39:25.903 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:25.918 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 16
2018-01-22 14:39:26.034 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:39:26.034 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:26.035 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:26.035 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:26.038 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:26.038 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:26.039 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:26.053 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:39:26.148 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:39:26.148 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:26.148 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:26.254 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:39:26.377 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:26.378 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:26.381 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:26.382 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:26.382 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:26.500 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:39:26.501 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:26.501 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:26.617 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:39:26.617 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:39:26.617 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:26.633 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:39:27.122 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:39:27.122 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:27.125 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:27.125 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:27.126 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:27.126 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:27.129 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:27.141 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:39:27.246 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:39:27.247 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:27.247 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:27.362 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:39:27.774 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:27.774 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:27.775 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getXiangMuJieSuanKKBL_COUNT  : ==>  Preparing: WITH mypatient_accounting AS (SELECT "病人ID", "病人姓名", "医保类别", "参保类型", "住院号", "交易流水号", "疾病编码", "主诊断", "手术医保编码", "主手术", "院内疾病编码", "院内主诊断", "院内手术医保编码", "院内主手术", "科室", "医疗小组", "主治医生", "床位号", "最后费用日期", "入院日期", "出院日期", "支付标准价", "CQ材料费", "CG材料费", "总费用", "所用医保费用", "自理金额", "自费金额", "自负金额", "超限床位费", "西药", "中成药", "中草药", "检查费", "治疗费", "手术费", "化验费", "其他费用", "输血费", "输氧费", "诊疗费", "CT片", "MRI片", "床位费", "婴儿费", "护理费", "放疗费", "自负材料费", "材料费", "麻醉费", "注射费", "新生儿筛查", "院前120急救费", "除去超限床位费", "病种比例", "盈亏标识", "盈利", "当前状态", CASE WHEN "控费类型" = '1' THEN '控费诊断+控费手术' WHEN "控费类型" = '2' THEN '控费诊断+非控费手术' WHEN "控费类型" = '3' THEN '非控费诊断+控费手术' WHEN "控费类型" = '4' THEN '非控费诊断+非控费手术' END AS 控费类型 FROM patient_accounting t WHERE EXISTS (SELECT 1 FROM projectsettlementview t2 WHERE t.交易流水号 = t2.交易流水号 AND to_date(t2.导入时间, 'yyyy-MM-dd hh24:mi:ss') BETWEEN to_date('2017-12', 'yyyy-MM') AND add_months(to_date('2017-12', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60))) AND t.医保类别 <> '现金' AND t.当前状态 = ?) SELECT count(0) FROM mypatient_accounting t1 LEFT JOIN (SELECT 交易流水号, sum(扣除金额) 项目结算扣款 FROM projectsettlementview GROUP BY 交易流水号) t2 ON t1.交易流水号 = t2.交易流水号 
2018-01-22 14:39:27.775 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getXiangMuJieSuanKKBL_COUNT  : ==> Parameters: 出院(String)
2018-01-22 14:39:27.777 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:27.792 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getXiangMuJieSuanKKBL_COUNT  : <==      Total: 1
2018-01-22 14:39:27.793 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('xiangmujsbl') ORDER BY column_id 
2018-01-22 14:39:27.793 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:27.806 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 16
2018-01-22 14:39:28.551 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:39:28.551 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:28.552 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:28.552 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:28.553 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:28.553 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:28.556 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:28.567 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:39:28.662 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:39:28.662 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:28.662 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:28.768 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:39:29.041 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:29.041 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:29.043 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:29.044 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:29.045 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:29.158 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:39:29.159 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:29.159 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:29.278 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:39:29.278 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:39:29.278 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:29.293 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:39:57.776 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:39:57.776 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:39:57.777 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:39:57.777 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:39:57.778 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:39:57.779 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:57.781 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:39:57.798 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:39:57.900 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:39:57.901 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:39:57.901 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:39:58.017 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:40:01.966 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:40:01.966 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:40:01.970 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:40:01.970 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:40:02.090 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:40:02.111 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:40:02.111 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:40:02.111 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:40:02.254 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:40:02.255 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:40:02.255 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:40:02.268 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:40:04.649 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:40:04.649 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:40:04.790 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:40:04.791 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主诊断 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:40:04.791 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:40:04.961 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:40:04.961 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:40:04.962 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:40:04.976 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:40:08.127 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:40:08.127 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:40:08.129 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:40:08.129 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:40:08.243 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:40:08.264 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:40:08.265 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:40:08.265 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:40:08.410 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:40:08.410 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:40:08.410 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:40:08.423 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:42:59.199 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:42:59.199 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:42:59.203 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:42:59.676 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:42:59.677 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:42:59.679 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:42:59.679 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:42:59.694 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:42:59.795 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:42:59.795 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:42:59.795 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:42:59.909 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:07.564 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:07.564 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:07.568 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:08.056 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:43:08.056 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:08.058 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:43:08.058 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:08.059 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:08.059 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:08.063 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:08.075 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:43:08.178 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:43:08.178 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:08.178 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:08.294 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:16.235 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:16.235 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:16.239 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:16.686 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:43:16.686 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:16.690 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:43:16.690 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:16.703 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:43:16.807 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:43:16.807 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:16.807 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:16.921 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:27.705 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:27.705 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:27.709 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:28.734 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:43:28.735 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:28.736 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:28.737 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:28.739 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:43:28.739 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:28.741 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:28.751 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:43:28.847 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:43:28.847 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:28.847 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:28.952 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:29.412 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:29.412 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:29.416 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:30.940 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:43:30.941 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:30.944 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:43:30.944 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:31.054 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:31.079 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:43:31.080 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:31.080 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:31.221 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:43:31.221 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:43:31.221 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:31.234 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:43:33.857 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:43:33.857 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:33.996 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:43:33.997 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.疾病编码 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:33.997 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:34.140 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:43:34.142 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:43:34.142 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:34.157 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:43:39.214 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:43:39.214 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:39.216 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:43:39.216 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:39.330 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:39.342 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:43:39.342 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:39.342 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:39.483 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:43:39.483 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:43:39.483 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:39.486 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:43:42.145 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:43:42.145 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:42.147 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:43:42.147 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:42.256 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:42.283 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:43:42.283 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:42.283 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:43:42.428 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:43:42.429 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:43:42.429 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:42.444 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:43:48.658 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:48.658 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:48.662 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:55.783 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:55.783 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:55.787 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:56.274 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:43:56.274 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:56.276 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:56.276 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:56.278 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:43:56.278 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:56.280 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:56.293 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:43:56.395 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:43:56.396 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:56.396 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:56.516 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:43:57.144 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:57.144 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:57.147 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:58.125 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:58.125 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:58.129 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:58.765 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:58.765 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:58.769 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:59.402 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:43:59.402 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:43:59.403 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:43:59.403 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:43:59.404 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:43:59.404 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:59.407 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:43:59.420 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:43:59.512 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:43:59.513 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:43:59.513 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:43:59.618 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:00.310 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:00.310 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:00.314 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:01.355 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:01.355 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:01.359 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:03.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:44:03.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:03.017 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:03.017 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:03.018 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:44:03.018 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:03.022 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:03.024 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:44:03.133 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:44:03.133 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:44:03.134 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:03.251 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:04.884 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:04.884 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:04.888 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:05.168 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:44:05.169 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:05.172 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:44:05.172 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:05.185 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:44:05.280 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:44:05.280 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:44:05.280 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:05.385 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:10.320 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:10.321 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:10.325 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:11.458 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:44:11.458 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:11.460 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:11.460 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:11.462 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:44:11.462 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:11.464 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:44:11.465 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:11.581 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:44:11.581 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:44:11.581 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:11.697 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:11.978 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:11.978 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:11.981 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:13.547 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:13.547 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:13.551 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:15.158 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:15.158 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:15.162 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:16.096 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:16.096 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:16.100 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:16.322 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:16.322 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:16.325 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:16.749 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:44:16.749 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:16.752 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:16.752 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:16.752 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:44:16.753 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:16.757 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:16.768 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:44:16.861 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:44:16.861 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:44:16.861 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:16.966 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:19.504 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:19.505 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:19.508 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:22.039 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:22.039 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:22.043 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:22.218 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:44:22.218 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 14:44:22.364 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 14:44:22.364 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 14:44:22.364 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:22.368 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:44:24.344 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:24.345 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:24.348 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:32.638 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:44:32.638 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:32.639 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:32.639 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:32.642 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:44:32.642 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:32.643 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:32.647 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:44:32.755 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:44:32.756 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:44:32.756 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:32.871 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:35.874 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:35.874 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:35.878 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:36.401 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:44:36.401 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:44:36.405 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:44:36.406 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:36.416 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:44:36.516 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:44:36.516 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:44:36.516 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:44:36.621 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:44:38.566 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:38.566 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:38.570 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:40.635 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:40.635 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:40.639 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:44:43.170 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:44:43.170 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:44:43.173 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:45:24.960 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:45:24.961 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:45:24.964 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:45:25.422 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:45:25.422 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:45:25.427 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:45:25.427 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:45:25.428 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:45:25.542 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:45:25.542 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:45:25.542 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:45:25.656 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:45:28.748 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:45:28.748 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:45:28.750 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:45:28.750 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:45:28.864 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:45:28.877 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:45:28.877 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:45:28.877 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:45:29.017 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:45:29.018 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:45:29.018 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:45:29.021 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:45:30.638 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:45:30.639 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:45:30.771 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:45:30.771 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.手术医保编码 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:45:30.771 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:45:30.913 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:45:30.914 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:45:30.914 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:45:30.917 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:45:33.794 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:45:33.794 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:45:33.796 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:45:33.797 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:45:33.905 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:45:33.930 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:45:33.930 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:45:33.930 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:45:34.072 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:45:34.073 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:45:34.073 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:45:34.085 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:46:44.693 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:46:44.693 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:46:44.808 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:46:44.809 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:46:44.809 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:46:44.925 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:46:44.925 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:46:44.925 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:46:44.940 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:46:47.721 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:46:47.721 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:46:47.725 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:46:48.093 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:46:48.093 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:46:48.208 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:46:48.209 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:46:48.209 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:46:48.324 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:46:48.324 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:46:48.324 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:46:48.342 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:47:19.445 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:47:19.445 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:47:19.449 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:47:19.831 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:47:19.831 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:47:19.833 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:47:19.833 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:47:19.849 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:47:19.942 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:47:19.943 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:47:19.943 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:47:20.048 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:47:28.110 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:47:28.110 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:47:28.114 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:47:28.547 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:47:28.547 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:47:28.551 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:47:28.551 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:47:28.553 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:47:28.666 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:47:28.666 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:47:28.666 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:47:28.779 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:47:44.250 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:47:44.250 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:47:44.254 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:47:46.946 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:47:46.946 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:47:46.949 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:47:46.949 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:47:46.949 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:47:46.949 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:47:46.954 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:47:46.965 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:47:47.069 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:47:47.069 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:47:47.069 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:47:47.188 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:47:47.582 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:47:47.582 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:47:47.586 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:47:50.289 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:47:50.289 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:47:50.293 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:48:07.381 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:48:07.381 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:48:07.384 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:48:07.837 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:48:07.837 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:48:07.841 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:48:07.841 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:48:07.853 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:48:07.958 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:48:07.958 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:48:07.958 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:48:08.072 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:48:17.262 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:48:17.262 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:48:17.266 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:48:17.826 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:48:17.827 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:48:17.829 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:48:17.829 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:48:17.831 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:48:17.831 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:48:17.833 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:48:17.842 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:48:17.939 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:48:17.939 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:48:17.939 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:48:18.045 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:48:20.426 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:48:20.426 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:48:20.430 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:48:20.431 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:48:20.539 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:48:20.565 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:48:20.565 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:48:20.565 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:48:20.707 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:48:20.707 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:48:20.707 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:48:20.720 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:48:22.848 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:48:22.849 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:48:22.988 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:48:22.988 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主手术 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:48:22.988 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:48:23.139 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:48:23.139 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:48:23.139 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:48:23.152 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:50:45.123 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:50:45.123 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:50:45.237 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:50:45.238 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:50:45.238 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:50:45.353 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:50:45.353 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:50:45.353 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:50:45.372 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:51:18.789 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:51:18.789 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:51:18.793 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:51:19.256 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:51:19.256 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:19.370 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:51:19.371 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:19.371 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:19.486 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:51:19.486 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:51:19.486 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:19.501 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:51:38.757 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:51:38.757 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:51:38.760 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:51:39.283 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:51:39.283 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:39.398 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:51:39.398 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:39.398 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:39.512 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:51:39.512 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:51:39.512 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:39.527 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:51:40.969 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:51:40.969 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:51:40.972 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:51:41.280 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:51:41.280 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:41.283 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:51:41.283 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:41.295 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:51:41.391 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:51:41.392 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:41.392 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:41.498 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:51:41.721 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:51:41.721 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:51:41.725 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:51:41.725 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:51:41.725 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:41.840 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 14:51:41.840 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:41.840 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:41.955 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 14:51:41.956 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 14:51:41.956 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:41.970 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 14:51:46.322 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:51:46.322 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:46.324 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:51:46.325 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:46.326 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:51:46.326 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:51:46.330 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:51:46.338 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:51:46.433 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:51:46.433 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:46.433 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:46.544 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:51:49.452 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:51:49.452 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:49.456 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:51:49.456 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:51:49.565 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:51:49.593 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:51:49.593 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:49.593 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:51:49.734 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:51:49.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:51:49.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:49.748 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:51:52.344 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:51:52.344 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:51:52.481 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:51:52.481 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主诊断 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:52.481 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:51:52.625 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:51:52.627 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:51:52.627 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:52.642 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:51:55.636 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:51:55.636 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:51:55.639 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:51:55.639 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:51:55.751 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:51:55.766 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:51:55.766 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:51:55.766 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:51:55.906 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:51:55.906 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:51:55.906 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:51:55.910 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:53:06.733 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:53:06.733 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:53:06.737 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:53:07.038 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:53:07.038 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:53:07.041 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:53:07.041 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:53:07.043 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:53:07.156 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:53:07.156 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:53:07.157 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:53:07.270 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:54:02.971 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:54:02.972 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:54:02.975 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:54:03.297 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:54:03.298 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:54:03.300 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:54:03.301 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:54:03.316 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:54:03.411 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:54:03.411 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:54:03.411 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:54:03.517 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:54:05.669 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:54:05.669 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:54:05.673 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:54:05.837 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:54:05.837 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:54:05.840 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:54:05.840 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:54:05.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:54:05.954 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:54:05.955 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:54:05.955 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:54:06.070 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:59:43.043 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 14:59:43.043 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 14:59:43.047 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 14:59:43.492 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 14:59:43.492 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:59:43.496 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 14:59:43.496 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:59:43.507 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 14:59:43.612 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 14:59:43.613 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:59:43.613 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:59:43.727 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:59:47.921 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:59:47.921 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:59:47.924 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:59:47.924 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:59:48.037 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:59:48.070 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:59:48.070 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:59:48.070 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:59:48.232 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:59:48.232 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:59:48.232 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:59:48.245 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 14:59:54.574 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 14:59:54.574 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 14:59:54.578 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 14:59:54.578 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:59:54.707 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 14:59:54.719 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 14:59:54.719 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 14:59:54.719 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 14:59:54.870 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 14:59:54.870 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 14:59:54.870 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 14:59:54.873 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:00:03.359 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:00:03.359 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:00:03.361 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:00:03.361 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:00:03.474 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:00:03.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:00:03.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:00:03.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:00:03.676 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:00:03.676 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:00:03.676 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:00:03.691 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:01:09.211 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:01:09.211 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:01:09.215 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:01:09.433 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:01:09.433 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:09.563 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:01:09.563 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:01:09.563 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:09.698 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:01:09.698 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:01:09.698 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:09.710 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:01:11.847 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:01:11.847 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:11.850 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:01:11.850 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:01:11.851 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:01:11.851 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:11.854 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:01:11.868 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:01:11.982 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:01:11.982 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:01:11.982 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:12.110 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:01:15.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:01:15.809 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:01:15.813 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:01:15.813 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:01:15.813 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:15.943 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:01:15.943 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:01:15.943 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:16.073 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:01:16.073 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:01:16.073 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:16.085 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:01:17.785 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:01:17.785 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:17.788 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:01:17.788 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:17.933 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:01:17.933 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:01:17.933 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:17.942 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:01:17.942 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:01:17.942 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:18.101 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:01:18.106 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:01:18.107 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:01:18.107 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:18.124 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:01:20.714 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:01:20.714 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:20.894 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:01:20.895 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.主手术 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:01:20.895 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:21.103 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:01:21.104 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:01:21.104 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:21.118 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:01:31.427 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:01:31.427 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:31.582 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:01:31.582 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:01:31.582 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:31.792 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:01:31.792 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:01:31.792 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:31.807 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:01:34.393 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:01:34.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:34.544 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:01:34.545 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.主诊断 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:01:34.545 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:01:34.755 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:01:34.756 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:01:34.756 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:34.775 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:01:43.980 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:01:43.980 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:43.982 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:01:43.982 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:44.124 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:01:44.124 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:01:44.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:44.131 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:01:44.131 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:01:44.132 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:01:44.281 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:01:44.286 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:01:44.287 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:01:44.287 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:01:44.301 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:04:25.166 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:04:25.167 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:04:25.170 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:04:25.596 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:04:25.596 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:04:25.730 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:04:25.730 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:04:25.730 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:04:25.857 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:04:25.858 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:04:25.858 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:04:25.869 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:05:49.935 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:05:49.935 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:05:49.939 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:05:50.524 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:05:50.524 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:05:50.652 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:05:50.652 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:05:50.652 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:05:50.779 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:05:50.780 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:05:50.780 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:05:50.792 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:05:52.894 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:05:52.894 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:05:52.900 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:05:52.900 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:05:53.040 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:05:53.042 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:05:53.042 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:05:53.057 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:05:53.057 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:05:53.057 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:05:53.213 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:05:53.213 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:05:53.213 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:05:53.215 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:05:53.228 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:05:55.128 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:05:55.128 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:05:55.279 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:05:55.279 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.入院日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:05:55.279 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:05:55.487 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:05:55.487 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:05:55.487 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:05:55.510 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:07.394 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:09:07.394 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:09:07.398 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:09:07.841 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:09:07.841 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:07.966 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:09:07.966 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:07.966 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:08.094 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:09:08.094 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:09:08.095 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:08.110 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:09:09.030 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:09:09.030 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:09:09.033 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:09:09.371 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:09:09.371 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:09.374 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:09:09.374 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:09.388 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:09:09.504 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:09:09.504 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:09.504 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:09.636 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:09:11.803 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:09:11.804 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:11.810 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:11.810 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:11.943 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:09:11.963 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:09:11.963 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:11.963 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:12.122 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:09:12.122 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:12.123 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:12.136 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:14.641 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:14.641 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:14.791 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:09:14.791 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主手术 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:14.791 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:14.949 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:09:14.951 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:14.951 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:14.964 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:18.534 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:09:18.534 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:18.536 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:18.536 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:18.660 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:09:18.688 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:09:18.688 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:18.688 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:18.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:09:18.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:18.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:18.859 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:21.888 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:09:21.888 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:21.891 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:21.892 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:22.021 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:09:22.039 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:09:22.039 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:22.039 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:22.200 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:09:22.200 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:22.200 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:22.215 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:23.556 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:23.556 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:23.712 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:09:23.712 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主手术 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:23.712 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:23.866 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:09:23.866 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:23.866 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:23.880 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:28.671 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:09:28.671 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:09:28.674 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:09:28.674 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:28.675 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:09:28.805 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:09:28.805 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:09:28.805 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:28.933 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:09:28.934 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:09:28.934 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:28.946 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:09:29.827 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:09:29.827 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:29.829 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:29.829 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:29.968 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:09:29.968 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:09:29.968 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:29.983 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:09:29.984 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:09:29.984 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:30.136 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:09:30.140 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:09:30.140 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:30.140 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:30.154 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:31.970 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:09:31.970 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:32.120 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:09:32.121 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.科室 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:09:32.121 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:09:32.331 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:09:32.331 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:32.331 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:32.349 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:09:35.379 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:09:35.379 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:35.382 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:09:35.382 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:35.524 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:09:35.524 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:09:35.524 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:35.535 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:09:35.535 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:09:35.535 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:09:35.692 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:09:35.701 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:09:35.701 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:09:35.701 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:09:35.715 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:22:01.232 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:22:01.232 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:22:01.236 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:22:01.652 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:22:01.652 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:22:01.782 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:22:01.782 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:22:01.782 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:22:01.909 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:22:01.909 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:22:01.909 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:22:01.921 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:22:03.201 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:22:03.201 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:22:03.205 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:22:03.512 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:22:03.512 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:22:03.515 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:22:03.515 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:22:03.526 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:22:03.642 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:22:03.642 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:22:03.642 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:22:03.769 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:22:05.043 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:22:05.043 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:22:05.048 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:22:05.048 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:22:05.169 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:22:05.199 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:22:05.199 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:22:05.199 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:22:05.357 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:22:05.357 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:22:05.357 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:22:05.374 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:22:10.197 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:22:10.197 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:22:10.350 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:22:10.350 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.住院号 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:22:10.350 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:22:10.560 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:22:10.560 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:22:10.560 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:22:10.575 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:22:13.249 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:22:13.249 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:22:13.252 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:22:13.252 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:22:13.385 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:22:13.399 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:22:13.399 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:22:13.399 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:22:13.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:22:13.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:22:13.557 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:22:13.572 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:26:30.532 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:26:30.532 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:26:30.536 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:26:31.012 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:26:31.012 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:26:31.016 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:26:31.016 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:26:31.028 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:26:31.148 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:26:31.148 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:26:31.148 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:26:31.279 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:26:33.098 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:26:33.098 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:26:33.102 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:26:33.102 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:26:33.233 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:26:33.253 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:26:33.253 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:26:33.253 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:26:33.410 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:26:33.411 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:26:33.411 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:26:33.424 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:26:35.199 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:26:35.200 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:26:35.356 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:26:35.356 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.住院号 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:26:35.356 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:26:35.516 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:26:35.517 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:26:35.517 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:26:35.532 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:26:41.870 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:26:41.870 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:26:41.873 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:26:41.873 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:26:41.997 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:26:42.023 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:26:42.023 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:26:42.023 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:26:42.180 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:26:42.180 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:26:42.180 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:26:42.196 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:30:35.251 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:30:35.251 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:30:35.254 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:30:35.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:30:35.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:35.748 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:30:35.748 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:35.762 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:30:35.873 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:30:35.874 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:35.874 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:36.005 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:30:37.934 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:30:37.934 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:30:37.938 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:30:38.152 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:30:38.153 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:38.278 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:30:38.278 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:38.278 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:38.407 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:30:38.407 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:30:38.407 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:38.423 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:30:43.289 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:30:43.289 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:30:43.289 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:43.289 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:30:43.291 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:30:43.292 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:43.293 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:30:43.305 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:30:43.405 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:30:43.405 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:43.405 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:43.520 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:30:44.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:30:44.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:30:44.857 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:30:44.858 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:30:44.858 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:44.985 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:30:44.986 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:44.986 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:45.113 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:30:45.114 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:30:45.114 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:45.129 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:30:46.391 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:30:46.391 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:46.393 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:30:46.393 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:46.538 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:30:46.539 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:30:46.539 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:46.541 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:30:46.541 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:30:46.541 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:46.686 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:30:46.687 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:30:46.687 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:46.691 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:30:46.706 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:30:49.515 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:30:49.515 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:49.515 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:30:49.515 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:30:49.516 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:30:49.516 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:49.519 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:30:49.537 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:30:49.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:30:49.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:49.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:49.777 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:30:50.534 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:30:50.535 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:50.539 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:30:50.540 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:50.661 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:30:50.690 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:30:50.690 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:50.690 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:50.847 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:30:50.847 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:30:50.847 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:50.860 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:30:54.095 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:30:54.095 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:30:54.099 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:30:54.099 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:54.231 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:30:54.248 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:30:54.249 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:30:54.249 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:30:54.410 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:30:54.411 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:30:54.411 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:30:54.425 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:31:39.006 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:31:39.006 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:31:39.009 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:31:39.009 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:31:39.010 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:31:39.122 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:31:39.122 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:31:39.122 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:31:39.237 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:31:39.237 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:31:39.237 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:31:39.252 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:31:39.499 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:31:39.499 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:31:39.501 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:31:39.501 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:31:39.503 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:31:39.503 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:31:39.505 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:31:39.516 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:31:39.619 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:31:39.619 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:31:39.619 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:31:39.735 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:31:42.527 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:31:42.527 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:31:42.529 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:31:42.529 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:31:42.643 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:31:42.680 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:31:42.680 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:31:42.680 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:31:42.838 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:31:42.838 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:31:42.838 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:31:42.852 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:31:47.047 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') between to_date('2017-12', 'yyyy-MM') and add_months(to_date('2017-12', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 
2018-01-22 15:31:47.047 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:31:47.050 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:31:47.050 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:31:47.181 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:31:47.195 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:31:47.195 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:31:47.195 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:31:47.346 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:31:47.346 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:31:47.346 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:31:47.350 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:32:01.504 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:32:01.505 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:32:01.508 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:32:01.510 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:32:01.510 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:32:01.640 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:32:01.640 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:32:01.640 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:32:01.768 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:32:01.768 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:32:01.768 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:32:01.782 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:32:02.690 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:32:02.690 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:32:02.692 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:32:02.692 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:32:02.833 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:32:02.834 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:32:02.834 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:32:02.841 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:32:02.841 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:32:02.841 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:32:02.990 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:32:02.990 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:32:02.991 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:32:02.994 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:32:03.007 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:33:41.393 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:33:41.393 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:33:41.397 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:33:41.809 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:33:41.809 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:33:41.931 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:33:41.931 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:33:41.931 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:33:42.045 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:33:42.045 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:33:42.045 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:33:42.061 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:33:44.288 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:33:44.288 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:33:44.292 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:33:44.783 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:33:44.783 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:33:44.783 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:33:44.783 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:33:44.798 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:33:44.899 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:33:44.899 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:33:44.899 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:33:45.014 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:33:46.214 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:33:46.214 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:33:46.362 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx_COUNT    : <==      Total: 1
2018-01-22 15:33:46.362 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:33:46.362 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:33:46.514 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.tuichuyibaokfjsblxx          : <==      Total: 10
2018-01-22 15:33:46.514 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:33:46.514 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:33:46.517 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:34:03.282 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:34:03.282 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:34:03.286 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:34:03.720 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:34:03.720 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:03.724 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:34:03.724 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:34:03.726 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:34:03.857 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:34:03.857 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:34:03.858 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:34:03.985 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:34:06.724 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:34:06.724 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:06.880 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:34:06.881 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:34:06.881 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:07.039 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:34:07.040 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:34:07.040 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:07.054 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:34:09.142 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:34:09.142 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:34:09.299 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:34:09.299 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.住院号 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:34:09.299 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:34:09.504 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:34:09.504 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:34:09.504 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:09.521 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:34:12.581 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:34:12.581 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:12.731 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:34:12.731 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:34:12.732 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:12.886 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:34:12.886 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:34:12.886 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:12.900 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:34:16.048 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:34:16.048 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:16.197 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:34:16.197 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:34:16.198 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:16.353 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:34:16.353 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:34:16.354 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:16.367 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:34:17.526 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? 
2018-01-22 15:34:17.526 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:34:17.678 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:34:17.678 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? order by t.住院号 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:34:17.678 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:34:17.833 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:34:17.833 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:34:17.833 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:17.846 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:34:21.948 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:34:21.948 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:22.101 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:34:22.101 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:34:22.101 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-1 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:34:22.256 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:34:22.256 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:34:22.256 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:34:22.270 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:36:07.421 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:36:07.421 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:36:07.424 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:36:11.379 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:36:11.379 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:36:11.381 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:36:11.381 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:36:11.398 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:36:11.498 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:36:11.499 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:36:11.499 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:36:11.614 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:36:17.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:36:17.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:36:17.877 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:36:18.259 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:36:18.260 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:36:18.264 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:36:18.264 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:36:18.265 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:36:18.393 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:36:18.394 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:36:18.394 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:36:18.522 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:36:34.465 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:36:34.465 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:36:34.469 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:36:35.038 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:36:35.039 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:36:35.041 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:36:35.042 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:36:35.060 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:36:35.155 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:36:35.155 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:36:35.155 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:36:35.270 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:38:38.858 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:38:38.858 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:38:38.861 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:38:38.994 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:38:38.994 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:38:38.996 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:38:38.996 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:38:39.000 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:38:39.126 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:38:39.126 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:38:39.126 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:38:39.254 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:38:57.298 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:38:57.298 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:38:57.302 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:38:57.731 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:38:57.731 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:38:57.734 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:38:57.734 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:38:57.751 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:38:57.852 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:38:57.902 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:38:57.902 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:38:58.016 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:39:02.516 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:39:02.516 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:39:02.520 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:39:02.975 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:39:02.975 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:39:02.980 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:39:02.980 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:39:02.981 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:39:03.109 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:39:03.110 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:39:03.110 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:39:03.239 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:39:17.502 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:39:17.502 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:39:17.506 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:39:21.626 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:39:21.626 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:39:21.630 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:39:21.902 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 15:39:21.902 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 15:39:21.903 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 15:39:21.903 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:39:21.903 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 15:39:21.906 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 15:39:23.870 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:39:23.870 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:39:23.874 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:39:24.038 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:39:24.038 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:39:24.168 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:39:24.168 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:39:24.168 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:39:24.296 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:39:24.296 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:39:24.296 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:39:24.308 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:39:25.298 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:39:25.299 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:39:25.302 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:39:25.555 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:39:25.555 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:39:25.560 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:39:25.560 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:39:25.576 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:39:25.675 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:39:25.675 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:39:25.675 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:39:25.790 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:42:51.816 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:42:51.816 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:42:51.819 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:42:52.437 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:42:52.437 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:42:52.440 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:42:52.440 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:42:52.443 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:42:52.570 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:42:52.570 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:42:52.570 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:42:52.698 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:43:03.550 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:43:03.550 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:43:03.554 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:43:05.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:43:05.246 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:43:05.249 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:43:05.515 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 15:43:05.515 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 15:43:05.516 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 15:43:05.516 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:43:05.516 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 15:43:05.519 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 15:43:07.715 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:43:07.715 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:43:07.719 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:43:07.891 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:43:07.891 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:08.017 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:43:08.017 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:43:08.017 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:08.145 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:43:08.146 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:43:08.146 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:43:08.158 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:43:09.433 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:43:09.433 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:43:09.437 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:43:09.685 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-22 15:43:09.685 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:43:09.688 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:43:09.688 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:09.703 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 58
2018-01-22 15:43:09.802 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-22 15:43:09.802 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:43:09.802 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:09.917 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-22 15:43:10.571 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:43:10.572 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:43:10.574 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:43:10.574 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:10.575 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:43:10.702 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:43:10.703 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:43:10.703 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:10.836 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:43:10.838 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:43:10.838 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:43:10.850 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:43:35.856 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:43:35.857 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:43:35.860 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:43:36.310 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:43:36.311 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:36.439 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:43:36.440 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:43:36.440 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:43:36.568 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:43:36.568 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:43:36.568 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:43:36.581 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:44:15.855 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:44:15.856 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:44:15.859 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:44:16.412 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:44:16.412 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:44:16.543 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:44:16.543 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:44:16.543 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:44:16.675 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:44:16.676 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:44:16.676 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:44:16.687 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:44:59.513 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:44:59.513 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:44:59.516 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:44:59.516 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:44:59.654 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:44:59.654 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:44:59.654 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:44:59.660 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:44:59.660 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:44:59.660 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:44:59.812 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:44:59.812 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:44:59.812 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:44:59.816 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:44:59.816 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:02.015 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:45:02.015 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:02.168 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:45:02.168 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主诊断 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:45:02.168 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:02.380 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:45:02.380 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:45:02.380 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:02.396 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:45:05.557 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:45:05.557 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:05.560 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:45:05.560 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:05.705 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:45:05.706 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:45:05.706 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:05.712 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:45:05.712 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.主诊断 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:45:05.712 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:05.870 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:05.877 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:45:05.878 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:45:05.878 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:05.881 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:45:11.015 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:45:11.015 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:45:11.019 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:45:11.233 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 15:45:11.233 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:45:11.350 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 15:45:11.350 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:45:11.350 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 15:45:11.465 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 15:45:11.465 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 15:45:11.465 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:11.467 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 15:45:13.606 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:45:13.607 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:13.609 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:45:13.610 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:13.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:45:13.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:45:13.747 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:13.765 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:45:13.765 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:45:13.765 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:13.884 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:13.925 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:45:13.925 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:45:13.925 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:13.939 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:45:15.338 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:45:15.338 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:15.494 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:45:15.494 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.手术医保编码 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:45:15.494 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:15.702 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:45:15.702 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:45:15.702 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:15.716 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:45:18.798 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:45:18.798 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:18.801 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 15:45:18.801 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:18.944 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:45:18.944 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:45:18.945 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:18.952 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 15:45:18.952 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.手术医保编码 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:45:18.952 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 15:45:19.107 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 15:45:19.107 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 15:45:19.107 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:19.111 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 15:45:19.118 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:46.398 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:45:46.398 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:45:46.402 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:45:46.734 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:45:46.734 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:45:46.736 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 15:45:46.736 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 15:45:46.737 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:45:46.737 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:45:46.738 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 15:45:46.738 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 15:45:46.747 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 15:45:46.759 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 15:45:46.851 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:45:46.852 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:45:46.852 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:45:46.852 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:46.852 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:45:46.852 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:45:46.866 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:45:47.002 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:56.385 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:45:56.385 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-06-01(String), 2018-01-22(String)
2018-01-22 15:45:56.388 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:45:56.388 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-06-01(String), 2018-01-22(String)
2018-01-22 15:45:56.526 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:45:56.526 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:45:56.527 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-06-01(String), 2018-01-22(String)
2018-01-22 15:45:56.530 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:45:56.530 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:45:56.531 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-06-01(String), 2018-01-22(String)
2018-01-22 15:45:56.662 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-22 15:45:56.662 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:45:56.662 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:56.682 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:45:56.691 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:58.691 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:45:58.691 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:45:58.693 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:45:58.693 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:45:58.828 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:45:58.828 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:45:58.829 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:45:58.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:45:58.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:45:58.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:45:58.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-22 15:45:58.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:45:58.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:45:58.996 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:45:59.000 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:46:02.716 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 15:46:02.716 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:46:02.761 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 15:46:02.761 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:46:02.761 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:46:02.806 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 15:46:05.422 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? GROUP BY t.医保类别) table_count 
2018-01-22 15:46:05.422 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String)
2018-01-22 15:46:05.466 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 15:46:05.466 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? group by t.医保类别 order by 医院向医保申请可支取的均费 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:46:05.466 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String)
2018-01-22 15:46:05.533 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 15:46:07.956 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 15:46:07.957 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:46:08.001 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 15:46:08.001 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:46:08.001 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-06-01(String), 2018-01-27(String)
2018-01-22 15:46:08.046 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 15:46:42.142 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:46:42.142 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:46:42.146 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:46:42.557 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 15:46:42.557 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 15:46:42.558 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:46:42.558 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:46:42.560 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 15:46:42.560 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 15:46:42.561 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:46:42.561 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:46:42.575 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 15:46:42.581 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 15:46:42.661 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:46:42.661 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:46:42.661 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:46:42.665 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:46:42.672 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:46:42.672 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:46:42.672 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:46:42.816 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:46:48.534 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:46:48.534 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-30(String), 2018-01-22(String)
2018-01-22 15:46:48.536 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:46:48.537 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-30(String), 2018-01-22(String)
2018-01-22 15:46:48.638 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:46:48.639 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:46:48.639 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:46:48.642 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:46:48.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:46:48.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:46:48.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-30(String), 2018-01-22(String)
2018-01-22 15:46:48.792 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:46:53.969 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:46:53.969 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-09-01(String), 2018-01-22(String)
2018-01-22 15:46:53.971 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:46:53.971 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-09-01(String), 2018-01-22(String)
2018-01-22 15:46:54.095 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:46:54.095 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:46:54.095 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-09-01(String), 2018-01-22(String)
2018-01-22 15:46:54.110 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:46:54.110 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:46:54.110 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-09-01(String), 2018-01-22(String)
2018-01-22 15:46:54.224 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-22 15:46:54.224 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:46:54.224 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:46:54.227 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:46:54.264 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:46:55.180 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:46:55.180 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:46:55.183 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:46:55.183 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:46:55.305 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:46:55.305 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 15:46:55.305 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:46:55.316 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:46:55.316 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:46:55.316 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:46:55.430 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-22 15:46:55.430 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:46:55.430 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:46:55.433 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:46:55.470 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 15:47:11.919 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 15:47:11.919 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:47:11.965 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 15:47:11.965 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:47:11.965 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:47:12.011 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 15:47:13.997 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? GROUP BY t.医保类别) table_count 
2018-01-22 15:47:13.997 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String)
2018-01-22 15:47:14.040 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 15:47:14.040 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? group by t.医保类别 order by 医院向医保申请可支取的均费 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:47:14.040 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String)
2018-01-22 15:47:14.083 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 15:47:16.803 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getDetail_COUNT              : ==>  Preparing: SELECT count(0) FROM (SELECT t.医保类别, round(avg(t.支付标准价), 2) 支付标准, round(avg(t.支付标准价) * 0.6, 2) "支付标准60%", round(AVG(t.所用医保费用 + t.盈利), 2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT (t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) AS 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) AS 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) AS 耗材均费, round(AVG(t.手术费), 2) AS 手术费均费 FROM patient_accounting t WHERE t.疾病编码 = ? AND t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.医保类别) table_count 
2018-01-22 15:47:16.803 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getDetail_COUNT              : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:47:16.846 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getDetail_COUNT              : <==      Total: 1
2018-01-22 15:47:16.846 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getDetail       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select t.医保类别, round(avg(t.支付标准价),2) 支付标准, round(avg(t.支付标准价) * 0.6,2) "支付标准60%", round(AVG(t.所用医保费用+t.盈利),2) AS 医院向医保申请可支取的均费, sum(t.盈利) AS 医院盈亏, COUNT(DISTINCT(t.住院号)) AS 总人次, round(AVG(t.总费用), 2) AS 总均费, round(AVG(t.CQ材料费), 2) AS CQ类材料均费, round(AVG(t.CG材料费), 2) AS CG类材料均费, round(AVG(t.超限床位费), 2) AS 超限床位均费, round(AVG(t.自理金额 + t.自费金额), 2) as 个人自理自费均费, round(AVG(t.西药 + t.中成药 + t.中草药), 2) as 药品均费, round(AVG(t.材料费 + t.自负材料费), 2) as 耗材均费, round(AVG(t.手术费), 2) as 手术费均费 from patient_accounting t WHERE t.疾病编码 = ? and t.手术医保编码 = ? AND t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.医保类别 order by 支付标准 ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 15:47:16.846 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getDetail       : ==> Parameters: N87.901(String), f33130300400(String), 1(String), 出院(String), 2017-09-01(String), 2018-01-05(String)
2018-01-22 15:47:16.893 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getDetail       : <==      Total: 1
2018-01-22 15:56:32.703 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 15:56:32.704 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 15:56:32.707 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 15:56:32.936 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 15:56:32.936 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:56:32.939 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 15:56:32.939 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:56:32.940 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 15:56:32.940 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 15:56:32.955 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 15:56:32.968 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 15:56:32.968 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 15:56:32.990 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 15:56:33.040 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 15:56:33.041 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 15:56:33.041 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 15:56:33.044 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 15:56:33.047 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 15:56:33.048 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 15:56:33.048 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 15:56:33.191 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 16:09:40.062 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 16:09:40.062 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 16:09:40.065 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 16:09:40.403 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 16:09:40.404 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 16:09:40.405 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 16:09:40.405 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 16:09:40.405 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 16:09:40.408 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 16:09:40.615 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 16:09:40.615 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 16:09:40.619 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 16:09:40.784 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 16:09:40.784 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-22 16:09:40.786 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 16:09:40.789 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 16:09:40.789 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-22 16:09:40.789 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-22 16:09:40.789 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-22 16:09:40.790 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-22 16:09:40.790 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-22 16:09:40.790 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 16:09:40.790 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-22 16:09:40.791 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 16:09:40.791 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 16:09:40.791 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-22 16:09:40.791 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-22 16:09:40.791 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-22 16:09:40.791 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-22 16:09:40.792 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-22 16:09:40.794 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-22 16:09:40.804 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-22 16:09:40.804 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 16:09:40.804 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-22 16:09:40.805 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 16:09:40.805 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 16:09:40.806 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-22 16:09:40.807 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 16:09:40.807 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 16:09:40.807 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-22 16:09:40.808 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 16:09:40.809 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-22 16:09:40.809 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-22 16:09:40.809 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-22 16:09:40.810 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-22 16:18:01.096  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 16:18:01.096  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 16:18:01.419 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 16:18:01.419 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 16:18:01.421 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 16:18:02.555 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 16:18:02.555 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 16:18:02.559 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 16:18:03.440 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 16:18:03.441 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 16:18:03.444 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 16:18:03.669 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-22 16:18:03.669 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-22 16:18:03.670 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-22 16:18:03.670 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 16:18:03.670 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-22 16:18:03.673 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-22 16:18:06.146 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 16:18:06.147 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 16:18:06.151 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 16:18:06.288 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 16:18:06.288 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 16:18:06.430 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 16:18:06.430 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 16:18:06.430 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 16:18:06.568 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 16:18:06.568 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 16:18:06.568 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 16:18:06.583 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 16:18:07.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 16:18:07.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:07.851 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 16:18:07.851 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:07.989 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 16:18:07.989 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 16:18:07.989 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:08.009 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 16:18:08.009 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 16:18:08.009 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:08.163 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 16:18:08.176 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 16:18:08.176 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 16:18:08.176 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 16:18:08.190 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 16:18:22.140 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 16:18:22.140 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:22.143 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 16:18:22.143 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:22.312 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 16:18:22.312 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 16:18:22.312 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:22.318 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 16:18:22.318 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 16:18:22.318 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:18:22.469 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 16:18:22.469 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 16:18:22.469 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 16:18:22.474 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 16:18:22.485 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 16:20:17.533 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 16:20:17.533 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 16:20:17.537 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 16:20:17.883 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 16:20:17.884 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 16:20:18.013 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 16:20:18.013 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 16:20:18.013 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 16:20:18.141 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 16:20:18.142 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 16:20:18.142 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 16:20:18.153 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 16:20:19.847 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 16:20:19.848 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:20:19.853 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 16:20:19.853 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:20:19.988 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 16:20:19.988 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 16:20:19.988 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:20:20.013 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 16:20:20.013 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by t.最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 5 
2018-01-22 16:20:20.013 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : ==> Parameters: 1(String), 出院(String), 2017-12-01 00:00:00(String), 2017-12-31 23:59:59(String)
2018-01-22 16:20:20.163 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 16:20:20.174 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.costMonitoring  : <==      Total: 5
2018-01-22 16:20:20.174 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 16:20:20.174 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 16:20:20.188 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:15:21.291  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 17:15:21.291  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 17:15:21.357 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 17:15:21.357 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 17:15:21.360 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 17:15:22.958 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:15:22.958 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:15:22.961 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:15:30.182 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:15:30.182 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:15:30.186 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:43.580  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 17:16:43.580  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 17:16:43.702 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 17:16:43.702 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 17:16:43.704 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 17:16:44.974 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:44.974 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:44.978 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:46.116 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:46.116 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:46.119 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:46.292 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:16:46.292 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:16:46.475 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:16:46.475 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:16:46.476 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:46.490 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:16:51.009 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:51.009 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:51.013 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:51.217 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 17:16:51.217 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.219 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 17:16:51.219 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 17:16:51.219 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.220 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 17:16:51.221 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 17:16:51.221 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.223 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:16:51.223 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.317 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 17:16:51.318 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 17:16:51.318 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.340 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 17:16:51.340 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 17:16:51.340 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:51.359 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:51.359 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:51.363 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:51.366 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 17:16:51.416 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 17:16:51.758 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 17:16:51.759 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.760 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 17:16:51.760 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 17:16:51.760 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.762 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 17:16:51.762 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:16:51.762 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.762 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 17:16:51.762 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.858 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 17:16:51.858 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 17:16:51.858 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:51.864 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 17:16:51.865 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-01-22 17:16:51.865 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:51.882 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 17:16:51.886 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:51.886 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:51.891 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:51.960 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 17:16:52.283 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:16:52.283 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 4(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:52.348 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 17:16:52.348 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:52.351 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 17:16:52.351 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-01-22 17:16:52.351 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:52.351 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:52.351 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:52.352 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-01-22 17:16:52.353 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 17:16:52.353 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:52.355 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:16:52.355 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:52.355 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:52.450 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 17:16:52.450 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-01-22 17:16:52.450 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:16:52.468 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 17:16:52.468 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-01-22 17:16:52.468 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:52.485 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-01-22 17:16:52.545 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-01-22 17:16:52.794 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:52.795 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:52.798 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:52.991 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 17:16:52.991 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:16:52.993 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:16:52.993 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:16:53.054 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-01-22 17:16:53.054 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeibztz') ORDER BY column_id 
2018-01-22 17:16:53.054 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:53.071 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:16:53.108 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 17:16:53.108 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 17:16:53.109 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:16:53.185 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:16:53.185 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 17:16:53.186 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:53.205 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:16:53.248 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 17:16:53.427 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:16:53.427 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:16:53.431 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:16:53.986 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 17:16:53.986 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:16:53.986 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:16:53.986 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 17(String), 2018-01-22 17(String)
2018-01-22 17:16:53.988 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 17:16:53.988 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 17:16:53.989 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 17:16:53.989 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 17:16:53.994 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 17:16:54.001 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 17:16:54.004 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 17:16:54.004 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 17:16:54.016 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 17:16:54.112 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 17:16:54.120 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 17:28:26.756 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:26.756 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:26.760 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:27.629 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:27.629 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:27.633 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:29.910 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:28:29.910 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 17(String), 2018-01-22 17(String)
2018-01-22 17:28:29.911 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 17:28:29.911 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:28:29.912 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 17:28:29.913 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 17:28:29.913 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 17:28:29.913 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 17:28:29.918 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 17:28:29.923 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 17:28:29.926 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 17:28:29.926 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 17:28:29.938 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 17:28:30.026 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 17:28:30.053 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 17:28:30.224 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-22 17:28:30.224 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-22 17:28:30.349 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-22 17:28:30.349 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-22 17:28:30.349 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-22 17:28:30.477 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-22 17:28:30.478 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-22 17:28:30.478 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:28:30.493 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-22 17:28:31.673 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:31.673 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:31.677 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:32.401 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:32.401 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:32.404 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:33.525 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:28:33.525 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 17(String), 2018-01-22 17(String)
2018-01-22 17:28:33.527 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 17:28:33.527 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:28:33.527 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 17:28:33.527 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 17:28:33.528 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 17:28:33.528 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 17:28:33.530 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:33.530 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:33.534 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 17:28:33.535 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:33.541 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 17:28:33.543 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 17:28:33.543 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 17:28:33.553 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 17:28:33.658 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 17:28:33.673 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 17:28:34.090 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 17:28:34.090 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:28:34.092 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:34.092 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:34.094 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:28:34.094 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:28:34.097 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:34.207 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 17:28:34.207 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 17:28:34.207 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:28:34.254 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:28:34.254 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 17:28:34.254 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:28:34.268 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:28:34.358 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 17:28:35.223 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:35.223 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:35.227 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:35.552 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:28:35.552 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:28:35.554 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:28:35.554 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:28:35.561 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:28:35.561 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:28:35.645 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:35.645 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:35.648 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:35.962 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:28:35.965 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:28:35.985 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:28:36.333 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:28:36.333 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:28:36.485 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:28:36.485 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:28:36.485 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:28:36.499 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:28:51.994 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:51.995 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:51.998 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:28:52.363 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:28:52.363 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:28:52.505 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:28:52.506 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:28:52.506 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:28:52.523 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:28:59.863 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:28:59.863 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:28:59.867 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:29:00.042 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:29:00.042 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:29:00.191 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:29:00.191 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:29:00.191 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:29:00.206 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:38:34.030 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:34.030 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:34.034 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:35.678 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:35.678 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:35.681 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:38:35.681 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:38:35.682 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:35.848 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:38:35.848 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:38:35.848 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:38:35.862 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:38:37.041 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:37.042 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:37.045 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:38.702 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:38.703 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:38.703 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:38:38.703 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:38:38.706 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:38.895 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:38:38.895 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:38:38.895 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:38:38.914 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:38:40.716 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:40.716 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:40.720 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:53.525 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:53.525 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:53.529 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:54.453 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:54.453 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:54.454 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:38:54.454 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:38:54.457 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:54.609 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:38:54.609 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:38:54.610 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:38:54.630 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:38:55.393 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:55.393 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:55.397 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:55.778 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:38:55.778 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:38:55.780 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:38:55.780 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:38:55.785 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:38:55.785 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:38:56.153 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:56.153 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:56.157 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:56.182 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:38:56.183 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:38:56.197 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:38:56.614 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:38:56.614 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:38:56.614 DEBUG 11252 --- [http-nio-9998-exec-2] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:38:56.615 DEBUG 11252 --- [http-nio-9998-exec-2] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:38:56.618 DEBUG 11252 --- [http-nio-9998-exec-1] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-22 17:38:56.618 DEBUG 11252 --- [http-nio-9998-exec-1] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:38:56.884 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:38:56.884 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:38:56.887 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:38:56.887 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:38:56.891 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:38:56.891 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:38:57.019 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-22 17:38:57.019 DEBUG 11252 --- [http-nio-9998-exec-2] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-22 17:38:57.020 DEBUG 11252 --- [http-nio-9998-exec-1] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-22 17:38:57.029 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:38:57.029 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:38:57.033 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:38:57.278 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:38:57.297 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:38:57.315 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:39:09.312 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:09.312 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:09.316 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:21.609 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:21.609 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:21.612 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:22.575 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:22.575 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:22.576 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:39:22.576 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:22.579 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:22.757 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:39:22.757 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:39:22.757 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:39:22.773 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:39:24.438 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:24.438 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:24.442 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:24.618 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:39:24.618 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:24.770 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:39:24.771 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:39:24.771 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:39:24.785 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:39:32.795 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:32.795 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:32.798 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:33.206 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:39:33.206 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:39:33.208 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:39:33.208 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:39:33.212 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:39:33.212 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:33.602 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:39:33.607 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:39:33.611 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:39:35.481 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:35.481 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:35.485 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:35.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:39:35.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:35.783 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:39:35.783 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:39:35.783 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:39:35.787 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:39:35.939 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:39:35.939 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:39:35.942 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:39:35.942 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:39:35.942 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:35.942 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:35.945 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:39:35.946 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:35.946 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:36.342 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:39:36.350 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:39:36.376 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:39:36.994 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:36.994 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:36.997 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:51.523 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:51.524 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:51.528 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:52.544 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:39:52.544 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:52.545 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:52.545 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:52.549 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:52.705 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:39:52.705 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:39:52.705 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:39:52.720 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:39:54.138 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:54.138 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:54.142 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:54.368 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:39:54.368 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:39:54.369 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:39:54.369 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:39:54.373 DEBUG 11252 --- [http-nio-9998-exec-8] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-22 17:39:54.373 DEBUG 11252 --- [http-nio-9998-exec-8] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:54.502 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:54.502 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:54.504 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:39:54.504 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:39:54.506 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:39:54.656 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:39:54.657 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:39:54.657 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:39:54.677 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:39:54.768 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-22 17:39:54.775 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-22 17:39:54.785 DEBUG 11252 --- [http-nio-9998-exec-8] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-22 17:39:59.773 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:39:59.774 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:39:59.777 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:40:00.159 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:40:00.159 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:40:00.160 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:40:00.160 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:40:00.164 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:40:00.164 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:40:00.555 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:40:00.564 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:40:00.567 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:40:08.593 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:40:08.593 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:40:08.597 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:40:08.988 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:40:08.988 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:40:08.990 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:40:08.990 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:40:08.993 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:40:08.993 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:40:09.387 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:40:09.393 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:40:09.406 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:40:18.139 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:40:18.140 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:40:18.143 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:40:18.496 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 17:40:18.496 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 17:40:18.498 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 17:40:18.498 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 17:40:18.501 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 17:40:18.501 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:40:18.892 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 17:40:18.897 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 17:40:18.900 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 17:41:41.969 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:41:41.970 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:41:41.974 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:41:51.564 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:41:51.564 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:41:51.568 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:41:57.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:41:57.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:41:57.249 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:42:21.106 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:42:21.106 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:42:21.110 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:42:31.458 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:42:31.458 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:42:31.461 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:50:03.014 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:50:03.014 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:50:03.018 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:51:58.892 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:51:58.892 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:51:58.896 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:52:16.312 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:52:16.312 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:52:16.316 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:52:21.209 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:52:21.209 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:52:21.213 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:52:21.423 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 17:52:21.423 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 17:52:21.569 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 17:52:21.570 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 17:52:21.570 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 17:52:21.586 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 17:52:41.422 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:52:41.422 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:52:41.426 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:52:43.971 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:52:43.971 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:52:43.975 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:53:21.729 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:53:21.729 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:53:21.733 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:53:30.172 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:53:30.172 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:53:30.176 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:54:47.219 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:54:47.219 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:54:47.223 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:54:49.736 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:54:49.736 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:54:49.740 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:54:51.855 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:54:51.855 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:54:51.859 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:54:53.889 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:54:53.890 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:54:53.893 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 17:57:35.914 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 17:57:35.914 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 17:57:35.918 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:00:43.632 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:00:43.632 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:00:43.636 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:01:58.035 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:01:58.035 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:01:58.039 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:02:07.073 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:02:07.074 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:02:07.078 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:02:33.714 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:02:33.714 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:02:33.718 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:03:38.521 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:03:38.521 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:03:38.525 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:03:39.259 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:03:39.259 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:03:39.263 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:03:39.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:03:39.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:03:39.547 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:03:39.548 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:03:39.548 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:03:39.561 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:03:48.049 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:03:48.049 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:03:48.052 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:03:48.833 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.range.RangeMapper.find_COUNT     : ==>  Preparing: SELECT count(0) FROM range 
2018-01-22 18:03:48.833 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.range.RangeMapper.find_COUNT     : ==> Parameters: 
2018-01-22 18:03:48.834 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.range.RangeMapper.find_COUNT     : <==      Total: 1
2018-01-22 18:03:54.592 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:03:54.592 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:03:54.596 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:04:02.471 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:04:02.471 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:04:02.475 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:04:07.169 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:04:07.169 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:04:07.173 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:04:12.927 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:04:12.927 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:04:12.931 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:18:44.529 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:18:44.530 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:18:44.533 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:18:52.190 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:18:52.191 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:18:52.195 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:19:00.952 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:19:00.953 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:19:00.956 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:19:02.912 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:19:02.912 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:19:02.915 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:19:22.439 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:19:22.439 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:19:22.443 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:22:14.989 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.range.RangeMapper.find_COUNT     : ==>  Preparing: SELECT count(0) FROM range 
2018-01-22 18:22:14.990 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.range.RangeMapper.find_COUNT     : ==> Parameters: 
2018-01-22 18:22:14.990 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.range.RangeMapper.find_COUNT     : <==      Total: 1
2018-01-22 18:22:16.285 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:22:16.285 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:22:16.289 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:22:20.333 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:22:20.333 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:22:20.337 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:22:21.021 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.range.RangeMapper.find_COUNT     : ==>  Preparing: SELECT count(0) FROM range 
2018-01-22 18:22:21.021 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.range.RangeMapper.find_COUNT     : ==> Parameters: 
2018-01-22 18:22:21.022 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.range.RangeMapper.find_COUNT     : <==      Total: 1
2018-01-22 18:22:25.114 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:22:25.114 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:22:25.118 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:22:37.556 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:22:37.556 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:22:37.560 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:03.399 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:03.399 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:03.403 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:07.473 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:07.473 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:07.477 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:07.607 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:32:07.608 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:07.761 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:32:07.762 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:32:07.762 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:32:07.778 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:32:10.558 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:10.559 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:10.562 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:10.858 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 18:32:10.858 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:10.860 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 18:32:10.860 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 18:32:10.861 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 18:32:10.861 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 18:32:10.861 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 18:32:10.861 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:10.873 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 18:32:10.880 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 18:32:10.973 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 18:32:10.974 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 18:32:10.974 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:32:10.975 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 18:32:10.976 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 18:32:10.976 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:10.988 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 18:32:11.120 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 18:32:30.296 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:30.297 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:30.300 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:32.327 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:32.327 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:32.330 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:32.722 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:32.722 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:32.726 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:33.033 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 18:32:33.033 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:33.037 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:32:33.037 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:33.153 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 18:32:33.153 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 18:32:33.153 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:33.188 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:32:33.188 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 18:32:33.188 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:32:33.204 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:32:33.297 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 18:32:35.010 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:35.010 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:35.014 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:35.226 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 18:32:35.226 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:35.228 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:32:35.228 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:35.343 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 18:32:35.343 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 18:32:35.343 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:35.377 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:32:35.377 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-22 18:32:35.377 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:32:35.395 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:32:35.487 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 18:32:46.742 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:46.742 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:46.746 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:48.123 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:48.123 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:48.127 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:50.991 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 18:32:50.991 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 18:32:50.991 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 18:32:50.991 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 18:32:50.994 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 18:32:50.995 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:51.638 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 18:32:51.641 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 18:32:51.641 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 18:32:53.854 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:32:53.854 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:32:53.858 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:32:54.407 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 18:32:54.407 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 18:32:54.407 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 18:32:54.407 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 18:32:54.410 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-22 18:32:54.411 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:32:55.051 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-22 18:32:55.059 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-22 18:32:55.061 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-22 18:37:08.646 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:37:08.646 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:37:08.650 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:37:45.024 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:37:45.024 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:37:45.028 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:37:47.733 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:37:47.733 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:37:47.736 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:37:49.990 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:37:49.990 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:37:49.994 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:37:50.132 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:37:50.132 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:37:50.280 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:37:50.280 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:37:50.280 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:37:50.296 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:38:01.604 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:38:01.604 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:38:01.608 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:40:23.010 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:40:23.010 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:40:23.014 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:40:58.215 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:40:58.215 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:40:58.219 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:41:02.963 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:41:02.963 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:41:02.967 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:41:37.722 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:41:37.722 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:41:37.726 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:42:09.204 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:42:09.205 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:42:09.209 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:42:13.202 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:42:13.203 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:42:13.206 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:42:57.952 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:42:57.952 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:42:57.956 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:43:00.444 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:43:00.444 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:43:00.447 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:43:47.161 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:43:47.162 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:43:47.165 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:43:47.408 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-22 18:43:47.408 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:43:47.410 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-22 18:43:47.410 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:43:47.411 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 18:43:47.412 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 18:43:47.412 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 18:43:47.412 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 18:43:47.417 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 18:43:47.437 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 18:43:47.524 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-22 18:43:47.524 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-22 18:43:47.524 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:43:47.530 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-22 18:43:47.530 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-22 18:43:47.530 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:43:47.539 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-22 18:43:47.738 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-22 18:43:52.495 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:43:52.496 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:43:52.500 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:44:04.510 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:44:04.511 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:44:04.515 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:44:06.194 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:44:06.194 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:44:06.198 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:44:07.667 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:44:07.667 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:44:07.671 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:44:07.810 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:44:07.810 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:44:07.988 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:44:07.988 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:44:07.988 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:44:08.001 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:44:23.126 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:44:23.126 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:44:23.129 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:44:27.508 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:44:27.508 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:44:27.512 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:44:36.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:44:36.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:44:36.249 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:15.551 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:15.551 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:15.555 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:16.181 DEBUG 11252 --- [http-nio-9998-exec-9] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-22 18:45:16.182 DEBUG 11252 --- [http-nio-9998-exec-9] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-22(String)
2018-01-22 18:45:16.184 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 18:45:16.185 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-15(String), 2018-01-22(String)
2018-01-22 18:45:16.189 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-22 18:45:16.189 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:45:16.846 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-22 18:45:16.848 DEBUG 11252 --- [http-nio-9998-exec-9] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-22 18:45:16.848 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-22 18:45:23.613 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:23.613 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:23.617 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:25.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:25.637 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:25.641 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:27.286 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:27.286 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:27.290 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:27.422 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:45:27.422 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:45:27.578 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:45:27.579 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:45:27.579 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:45:27.593 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:45:36.269 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:36.269 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:36.273 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:40.640 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:40.640 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:40.644 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:52.557 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:52.557 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:52.561 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:53.678 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:45:53.678 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:45:53.700 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:45:53.794 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:45:53.794 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:45:53.954 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:45:53.954 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:45:53.954 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:45:53.969 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:46:08.411 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:46:08.411 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:46:08.415 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:46:12.846 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:46:12.846 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:46:12.850 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:46:16.135 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:46:16.135 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:46:16.138 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:46:17.340 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:46:17.340 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:46:17.343 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:46:17.466 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-22 18:46:17.466 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-23(String), 2018-01-22(String)
2018-01-22 18:46:17.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-22 18:46:17.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-22 18:46:17.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 18:46:17.640 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-22 18:46:19.738 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:46:19.739 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:46:19.743 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:47:39.113 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:47:39.113 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:47:39.117 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:47:48.550  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 18:47:48.550  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 18:47:50.504 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 18:47:50.504 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-22 18:47:50.506 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 18:47:51.346 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:47:51.346 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:47:51.350 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 18:54:00.245 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 18:54:00.245 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 18:54:00.248 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:10:43.490 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:10:43.491 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:10:43.494 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:10:46.064 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:10:46.064 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:10:46.067 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:11:00.902 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:11:00.902 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:11:00.906 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:16:31.570  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 19:16:31.571  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 19:16:31.659 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 19:16:31.659 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 19:16:31.661 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 19:16:32.805 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:16:32.806 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:16:32.809 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:17:31.169  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 19:17:31.169  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 19:17:31.259 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 19:17:31.260 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 19:17:31.261 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 19:17:32.944 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:17:32.945 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:17:32.948 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:17:39.793 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:17:39.793 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:17:39.797 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:18:05.612 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:18:05.612 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:18:05.615 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:18:09.774 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:18:09.775 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:18:09.778 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:18:10.225 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 19:18:10.226 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 19(String), 2018-01-22 19(String)
2018-01-22 19:18:10.233 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 19:18:10.233 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 19:18:10.236 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 19:18:10.236 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 19:18:10.237 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 19:18:10.237 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 19:18:10.246 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 19:18:10.247 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 19:18:10.249 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 19:18:10.249 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 19:18:10.256 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 19:18:10.347 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 19:18:10.350 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 19:18:11.245 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:18:11.245 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:18:11.248 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:25:28.754 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:25:28.754 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:25:28.757 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:25:35.670  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 19:25:35.670  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 19:25:50.995  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-22 19:25:50.995  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-22 19:25:51.212 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-22 19:25:51.212 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-22 19:25:51.214 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-22 19:25:52.708 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:25:52.708 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:25:52.711 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:25:55.192 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:25:55.192 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:25:55.200 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:25:57.076 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:25:57.076 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:25:57.080 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:25:57.671 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:25:57.671 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:25:57.674 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:25:58.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-22 19:25:58.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-15 19(String), 2018-01-22 19(String)
2018-01-22 19:25:58.098 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-22 19:25:58.098 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-22 19:25:58.098 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-22 19:25:58.098 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-22 19:25:58.099 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-22 19:25:58.099 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-22 19:25:58.113 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-22 19:25:58.113 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-22 19:25:58.116 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-22 19:25:58.116 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-21 16(String), 2018-01-22 16(String)
2018-01-22 19:25:58.123 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-22 19:25:58.200 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-22 19:25:58.226 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-22 19:25:59.356 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:25:59.356 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:25:59.360 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-22 19:26:29.124 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-22 19:26:29.124 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-22 19:26:29.128 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 11:05:12.327  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/login
2018-01-23 11:05:12.327  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 11:05:13.582  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/login
2018-01-23 11:05:13.582  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 11:05:15.285  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/login
2018-01-23 11:05:15.285  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 11:05:18.264  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/login
2018-01-23 11:05:18.264  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 11:11:28.730  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/login
2018-01-23 11:11:28.731  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 11:18:06.619  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-23 11:18:06.620  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 11:18:06.749 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 11:18:06.749 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-23 11:18:06.849 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 11:18:07.312 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 11:18:07.312 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 11:18:07.329 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:48:39.122  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-23 13:48:39.166  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 13:49:38.764 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 13:49:38.764 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-23 13:49:38.891 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 13:49:40.670 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:49:40.670 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:49:40.696 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:49:42.342 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:49:42.342 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:49:42.347 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:49:43.481 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:49:43.481 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:49:43.592 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:49:44.086 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:49:44.086 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:49:44.145 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:49:44.176 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:49:44.223 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:49:44.251 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:49:44.362 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:49:44.475 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:49:44.545 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:49:44.754 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:49:44.773 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:49:44.895 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:52:54.538 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:52:54.547 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:52:54.569 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:52:54.811 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:52:54.824 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:52:54.974 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:52:54.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 13:52:54.984 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:52:55.168 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 13:53:02.909 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:53:02.910 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:53:02.920 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:53:03.148 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:53:03.149 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:03.374 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:53:03.375 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通','省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 13:53:03.375 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:03.605 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 13:53:03.838 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:53:03.838 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:53:03.848 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:53:03.891 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:53:03.891 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:04.119 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:53:04.119 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 13:53:04.126 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:04.364 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 13:53:04.558 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:53:04.566 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:53:04.591 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:53:04.659 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:53:04.660 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:04.890 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:53:04.890 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 13:53:04.905 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:05.132 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 13:53:05.378 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:53:05.387 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:53:05.409 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:53:05.474 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:53:05.490 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:05.700 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:53:05.714 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 13:53:05.714 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:05.929 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 13:53:06.252 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:53:06.252 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:53:06.264 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:53:06.287 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:53:06.287 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 13:53:06.306 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:53:11.771 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:53:11.771 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:53:11.783 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:53:11.820 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:53:11.820 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-02 16(String), 2018-01-23 16(String)
2018-01-23 13:53:11.969 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:53:12.025 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 13:53:12.026 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-02 16(String), 2018-01-23 16(String)
2018-01-23 13:53:12.176 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 13:54:33.341 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:54:33.342 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:54:33.372 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:54:33.966 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:54:33.966 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:54:33.969 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:54:33.969 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:54:33.970 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:54:33.983 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:54:34.000 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:54:34.135 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:54:34.143 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:54:34.143 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:54:34.241 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:54:34.242 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:54:34.259 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:54:34.289 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:54:34.318 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:55:59.990 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:55:59.990 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:56:00.020 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:56:00.434 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:56:00.452 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:56:00.468 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:56:00.485 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:56:00.498 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:56:00.485 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:56:00.514 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:56:00.519 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:56:00.529 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:56:00.597 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:56:00.597 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:56:00.600 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:56:00.613 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:56:00.634 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:56:00.636 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:56:09.615 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:56:10.195 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:56:10.319 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:56:10.584 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:56:10.584 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:56:10.601 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:56:10.601 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:56:10.613 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:56:10.616 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:56:10.616 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:56:10.639 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:56:10.639 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:56:10.684 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:56:10.684 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:56:10.686 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:56:10.690 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:56:10.701 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:56:10.758 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:56:17.446 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:56:17.446 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:56:17.452 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:56:19.119 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:56:19.119 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:56:19.132 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:56:19.692 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:56:19.719 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:56:19.730 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:56:19.735 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:56:19.736 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:56:19.747 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:56:19.797 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:56:19.805 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:56:19.805 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:56:19.827 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:56:19.838 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:56:19.840 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:56:19.913 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:56:19.918 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:56:19.954 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:56:28.571 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:56:28.571 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:56:28.590 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:56:28.608 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:56:28.617 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-09-01 16(String), 2018-01-23 16(String)
2018-01-23 13:56:28.619 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:58:42.568 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:58:42.568 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:58:42.584 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:58:43.368 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:58:43.414 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:58:43.416 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:58:43.423 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:58:43.430 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:58:43.431 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:58:43.441 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:58:43.441 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:58:43.456 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:58:43.466 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:58:43.468 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:58:43.468 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:58:43.468 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:58:43.470 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 13:58:43.523 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:59:51.245 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 13:59:51.245 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 13:59:51.261 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 13:59:52.106 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 13:59:52.106 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 13:59:52.188 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 13:59:52.189 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 13:59:52.200 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 13:59:52.223 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 13:59:52.223 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 13:59:52.224 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 13:59:52.242 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 13(String), 2018-01-23 13(String)
2018-01-23 13:59:52.267 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 13:59:52.309 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 13:59:52.355 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 13:59:52.431 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 13:59:52.431 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 13:59:52.433 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:02:39.928 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:02:39.929 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:02:39.959 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:02:40.664 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:02:40.665 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:02:40.675 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:02:40.676 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:02:40.701 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:02:40.704 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:02:40.718 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:02:40.719 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:02:40.719 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:02:40.789 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:02:40.789 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:02:40.828 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:02:40.845 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:02:40.888 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:02:40.928 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:03:13.920 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:03:13.920 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:03:13.937 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:03:14.754 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:03:14.771 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:03:14.793 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:03:14.806 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:03:14.842 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:03:14.868 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:03:14.868 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:03:15.005 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:03:15.018 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:03:15.032 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:03:15.034 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:03:15.040 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:03:15.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:03:15.129 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:03:15.149 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:03:59.429 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:03:59.430 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:03:59.442 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:03:59.484 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:03:59.484 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-10 16(String), 2018-01-23 16(String)
2018-01-23 14:03:59.608 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:04:06.858 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:04:06.863 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:04:06.880 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:04:06.913 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:04:06.928 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-10 16(String), 2018-01-27 16(String)
2018-01-23 14:04:07.044 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:04:19.590 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:04:19.590 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:04:19.635 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:04:20.308 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:04:20.308 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:04:20.319 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:04:20.319 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:04:20.332 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:04:20.338 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:04:20.338 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:04:20.351 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:04:20.364 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:04:20.422 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:04:20.435 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:04:20.437 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:04:20.447 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:04:20.508 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:04:20.547 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:05:00.200 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:05:00.200 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:05:00.226 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:05:00.266 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:05:00.266 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:05:00.372 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:05:05.558 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:05:05.558 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:05:05.618 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:05:06.343 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:05:06.356 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:05:06.386 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:05:06.420 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:05:06.420 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:05:06.429 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:05:06.430 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:05:06.437 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:05:06.473 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:05:06.505 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:05:06.516 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:05:06.522 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:05:06.524 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:05:06.544 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:05:06.617 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:06:07.508 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:06:07.509 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:06:07.526 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:06:08.483 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:06:08.483 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:06:08.484 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:06:08.510 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:06:08.570 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:06:08.582 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:06:08.615 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:06:08.654 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:06:08.654 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:06:08.695 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:06:08.714 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:06:08.753 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:06:08.786 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:06:08.788 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:06:08.799 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:06:17.188 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:06:17.193 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:06:17.207 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:06:17.243 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:06:17.243 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:06:17.245 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:06:20.530 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:06:20.531 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:06:20.542 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:06:20.573 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:06:20.584 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-24 16(String)
2018-01-23 14:06:20.585 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:07:28.754 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:07:28.759 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:07:28.772 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:07:28.785 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:07:28.786 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-24 16(String)
2018-01-23 14:07:28.792 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:07:31.008 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:07:31.023 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:07:31.038 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:07:31.861 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:07:31.861 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:07:31.861 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:07:31.861 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:07:31.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:07:31.883 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:07:31.895 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:07:31.895 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:07:31.914 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:07:31.915 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:07:31.922 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:07:31.975 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:07:31.976 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:07:32.022 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:07:32.083 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:09:39.985 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:09:39.995 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:09:40.007 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:09:40.023 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:09:40.024 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:09:40.025 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:09:44.608 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:09:44.608 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:09:44.617 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:09:45.467 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:09:45.469 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:09:45.476 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:09:45.476 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:09:45.492 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:09:45.493 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:09:45.513 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:09:45.541 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:09:45.541 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:09:45.613 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:09:45.615 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:09:45.615 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:09:45.619 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:09:45.632 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:09:45.641 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:09:53.705 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:09:53.705 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:09:53.762 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:09:54.573 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:09:54.573 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:09:54.583 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:09:54.594 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:09:54.632 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:09:54.632 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:09:54.646 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:09:54.647 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:09:54.678 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:09:54.684 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:09:54.685 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:09:54.689 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:09:54.692 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:09:54.707 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:09:54.792 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:10:21.728 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:10:21.737 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:10:21.760 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:10:22.618 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:10:22.618 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:10:22.619 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:10:22.630 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:10:22.630 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:10:22.630 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:10:22.637 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:10:22.637 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:10:22.666 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:10:22.711 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:10:22.756 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:10:22.791 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:10:22.805 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:10:22.806 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:10:22.808 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:10:32.720 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:10:32.720 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:10:32.737 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:10:33.477 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:10:33.477 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:10:33.508 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:10:33.519 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:10:33.530 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:10:33.530 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:10:33.543 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:10:33.570 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:10:33.573 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:10:33.587 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:10:33.697 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:10:33.702 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:10:33.705 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:10:33.709 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:10:33.772 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:10:40.674 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:10:40.674 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:10:40.771 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:10:41.467 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:10:41.501 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:10:41.514 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:10:41.545 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:10:41.557 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:10:41.558 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:10:41.560 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:10:41.560 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:10:41.574 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:10:41.622 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:10:41.623 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:10:51.696 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:10:51.774 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:10:51.783 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:10:51.828 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:11:06.050 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:11:06.050 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:11:06.088 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:11:06.931 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:11:06.931 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:11:06.950 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:11:06.950 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:11:06.995 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:11:07.036 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:11:07.047 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:11:07.108 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:11:07.187 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:11:07.232 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:11:07.237 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:11:07.254 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:11:07.254 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:11:07.256 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:11:07.380 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:11:54.461 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:11:54.462 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:11:54.472 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:11:55.198 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:11:55.227 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:11:55.251 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:11:55.251 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:11:55.274 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:11:55.274 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:11:55.294 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:11:55.744 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:11:55.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:11:55.746 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:11:55.782 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:11:55.934 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:11:55.974 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:11:56.013 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:11:56.225 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:19.566 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:12:19.567 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:12:19.637 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:12:27.122 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:12:27.131 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:12:27.160 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:12:27.856 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:27.869 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:12:27.869 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:12:27.922 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:12:27.922 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:27.923 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:12:27.955 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:12:27.965 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:12:27.967 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:27.990 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:12:28.028 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:28.028 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:12:28.081 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:12:28.099 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:12:28.236 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:37.602 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:37.602 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:37.616 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:37.632 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:37.633 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:37.839 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:37.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通','省异地就医','现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:37.863 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:37.872 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:37.872 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:37.890 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:37.944 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:37.991 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:38.110 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 14:12:38.207 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:38.230 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通','省异地就医','现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:38.230 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:38.454 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 14:12:45.446 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:45.447 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:45.469 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:45.518 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:45.521 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:45.735 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:45.735 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通','省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:45.735 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:45.745 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:45.745 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:45.764 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:45.809 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:45.809 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:45.949 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 14:12:46.006 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:46.007 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保','新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:46.017 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:46.206 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:46.206 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:46.219 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 7
2018-01-23 14:12:46.230 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:46.260 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:46.274 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:46.466 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:46.467 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:46.467 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:46.530 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:47.168 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 14:12:47.168 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:47.191 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:47.191 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:47.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:47.257 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:47.368 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:47.383 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:47.425 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:47.445 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:47.445 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:47.445 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:47.484 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:47.550 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:47.569 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:47.617 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:47.617 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:47.627 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:47.629 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:47.640 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:47.650 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新市医保','新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:12:47.696 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:47.854 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 14:12:47.917 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 14:12:48.168 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:48.168 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:48.180 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:48.236 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:48.244 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:48.245 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:54.432 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:54.432 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:54.452 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:54.482 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:54.483 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-23 16(String)
2018-01-23 14:12:54.484 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:57.118 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:57.118 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:57.145 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:57.164 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:57.165 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-13 16(String)
2018-01-23 14:12:57.166 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:12:57.436 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:12:57.437 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:12:57.448 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:12:57.477 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:12:57.477 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-12-01 16(String), 2018-01-13 16(String)
2018-01-23 14:12:57.479 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:13:05.291 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:13:05.293 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:13:05.305 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:13:05.319 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:13:05.326 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-06 16(String), 2018-01-13 16(String)
2018-01-23 14:13:05.327 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:13:08.065 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:13:08.065 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:13:08.076 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:13:08.092 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:13:08.092 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-06 16(String), 2018-01-07 16(String)
2018-01-23 14:13:08.094 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:13:19.693 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:13:19.699 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:13:19.713 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:13:19.751 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc 
2018-01-23 14:13:19.755 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-06(String), 2018-01-07(String)
2018-01-23 14:13:19.771 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 0
2018-01-23 14:13:48.116 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:13:48.118 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:13:48.133 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:13:48.743 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:13:48.764 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:13:48.774 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:13:48.774 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:13:48.785 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:13:48.820 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:13:48.845 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:13:48.866 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:13:48.867 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:13:48.901 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:13:48.925 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:13:48.926 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:13:48.971 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:13:48.979 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:13:49.093 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:01.009 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:14:01.022 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:14:01.103 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:14:01.740 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:01.779 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:01.781 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:14:01.810 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:14:01.811 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:01.919 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:14:01.939 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:14:01.968 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:14:01.925 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:14:01.951 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:01.968 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:14:01.968 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:14:02.008 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:14:02.089 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:14:02.144 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:05.602 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:05.608 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:05.623 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:05.625 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:05.636 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:14:05.814 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:06.329 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:06.338 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:06.351 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:06.394 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:06.394 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:14:06.593 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:07.132 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:07.133 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:07.149 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:07.170 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:07.170 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:14:07.329 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:07.489 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:07.490 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:07.502 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:07.510 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:07.514 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:14:07.675 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:07.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:07.854 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:07.867 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:07.870 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:07.870 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:14:07.871 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:10.420 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:10.420 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:10.435 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:10.436 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc 
2018-01-23 14:14:10.436 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2018-01-22(String), 2018-01-23(String)
2018-01-23 14:14:10.449 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 0
2018-01-23 14:14:22.842 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:22.842 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:22.853 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:22.880 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('其他') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:22.895 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:14:22.897 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:26.988 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:26.989 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:27.003 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:27.036 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新省值医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:27.037 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:14:27.038 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:28.118 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:28.118 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:28.130 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:28.182 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新省值医保', '新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:14:28.182 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:14:28.400 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:14:28.435 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新省值医保','新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:14:28.436 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01 16(String), 2018-01-23 16(String)
2018-01-23 14:14:28.663 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 14:14:31.735 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:14:31.736 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:14:31.748 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:14:31.775 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==>  Preparing: SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(distinct t.住院号), 0) AS 病例数 FROM ( select 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 in ('新省值医保','新市医保') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 group by 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术 ) t group by t.疾病编码, t.主诊断, t.手术医保编码, t.主手术 ORDER BY 病例数 desc 
2018-01-23 14:14:31.784 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : ==> Parameters: 1(String), 出院(String), 2017-10-01(String), 2018-01-23(String)
2018-01-23 14:14:32.017 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport       : <==      Total: 5
2018-01-23 14:55:46.932  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-23 14:55:46.932  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.121  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/getParams
2018-01-23 14:55:47.137  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/getCondition
2018-01-23 14:55:47.146  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.146  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.162  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/getNotices
2018-01-23 14:55:47.178  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/getCondiValues
2018-01-23 14:55:47.360  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.193  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.362 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 14:55:47.388  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/getDoctors
2018-01-23 14:55:47.388  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/warn/find
2018-01-23 14:55:47.413 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: zlp(String)
2018-01-23 14:55:47.413  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.413  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 14:55:47.509 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 14:55:47.543 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: zlp(String)
2018-01-23 14:55:47.588 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 14:55:47.687 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 14:55:47.736 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 14:55:47.736 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: zlp(String)
2018-01-23 14:55:47.755 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: zlp(String)
2018-01-23 14:55:47.778 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 14:55:47.801 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 14:55:47.962 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 14:55:47.999 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 14:55:48.004 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: zlp(String)
2018-01-23 14:55:48.513 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 14:55:49.890 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:55:49.890 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:55:49.902 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:55:57.312 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:55:57.313 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:55:57.337 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:55:58.250 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:55:58.256 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:55:58.278 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:55:58.677 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 14:55:58.677 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 14:55:58.733 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 14:55:58.779 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 14:55:58.779 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 14:55:58.791 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 14(String), 2018-01-23 14(String)
2018-01-23 14:55:58.809 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 14:55:58.827 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 14:55:58.833 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:55:58.863 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 14:55:58.908 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 14:55:58.931 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 14:55:58.997 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 14:55:58.999 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 14:55:59.123 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 14:56:02.740 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:56:02.740 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:56:02.771 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:56:03.099 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-23 14:56:03.100 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 14:56:03.246 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-23 14:56:03.246 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-23 14:56:03.246 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-23 14:56:03.246 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-23 14:56:03.329 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-23 14:56:03.339 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-23 14:56:03.350 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-23 14:56:03.358 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-23 14:56:03.373 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-23 14:56:03.373 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-23 14:56:03.386 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-23 14:56:03.528 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-23 14:56:03.605 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-23 14:56:03.744 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-23 14:56:03.744 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-23 14:56:03.782 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-23 14:56:03.782 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-23 14:56:03.782 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-23 14:56:03.792 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-23 14:56:03.792 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-23 14:56:03.792 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-23 14:56:03.811 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-23 14:56:03.813 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-23 14:56:03.813 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-23 14:56:03.821 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-23 14:56:03.828 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-23 14:56:03.835 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-23 14:56:03.850 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-23 14:56:03.873 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:56:03.888 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-23 14:56:04.244 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-23 14:56:39.161 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 14:56:39.161 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 14:56:39.194 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 14:56:39.306 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-23 14:56:39.316 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-23 14:56:39.318 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-23 14:56:39.326 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-23 14:56:39.326 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-23 14:56:39.439 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-23 15:14:18.682  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-23 15:14:18.694  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 15:14:18.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 15:14:18.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-23 15:14:18.851 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 15:14:20.576 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 15:14:20.592 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 15:14:20.610 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 15:14:49.314 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 15:14:49.325 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 15:14:49.350 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 15:15:11.102 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 15:15:11.103 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 15:15:11.133 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 15:15:11.795 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 15:15:11.818 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 15:15:11.819 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 15:15:11.836 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 15:15:11.859 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 15:15:11.871 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 15:15:12.047 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 15:15:12.047 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 15:15:12.056 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 15(String), 2018-01-23 15(String)
2018-01-23 15:15:12.105 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 15:15:12.113 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 15:15:12.113 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 15:15:12.147 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 15:15:12.226 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 15:15:12.299 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 15:15:14.854 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 15:15:14.854 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 15:15:14.877 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 16:05:01.511  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-23 16:05:01.541  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 16:05:02.065 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 16:05:02.155 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-23 16:05:02.292 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 16:05:04.359 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 16:05:04.360 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 16:05:04.371 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 16:05:08.951 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 16:05:08.952 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 16:05:09.001 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 16:05:09.704 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 16:05:09.704 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 16:05:09.768 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 16:05:09.815 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 16:05:09.815 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 16:05:09.830 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 16:05:09.832 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 16:05:09.832 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 16(String), 2018-01-23 16(String)
2018-01-23 16:05:09.872 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 16:05:09.879 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 16:05:09.947 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 16:05:09.982 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 16:05:10.007 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 16:05:10.040 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 16:05:10.178 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 17:19:28.151  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-23 17:19:28.151  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-23 17:19:28.557 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-23 17:19:28.557 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-23 17:19:28.586 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-23 17:19:29.510 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 17:19:29.510 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 17:19:29.550 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 17:19:31.831 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 17:19:31.837 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 17:19:31.848 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 17:19:32.295 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 17:19:32.295 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 17:19:32.303 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 17:19:32.303 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 17:19:32.307 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 17:19:32.314 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 17:19:32.328 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 17:19:32.337 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 17:19:32.337 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 17(String), 2018-01-23 17(String)
2018-01-23 17:19:32.379 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 17:19:32.391 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 17:19:32.392 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 17:19:32.426 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-23 17:19:32.466 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 17:19:32.579 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 17:19:33.830 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 17:19:33.838 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 17:19:33.843 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 17:22:17.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-23 17:22:17.660 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-23 17:22:17.672 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-23 17:22:17.701 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-23 17:22:17.706 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-16 17(String), 2018-01-23 17(String)
2018-01-23 17:22:17.717 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-23 17:22:17.747 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-22 16(String), 2018-01-23 16(String)
2018-01-23 17:22:17.843 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-23 17:22:17.846 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-23 17:22:17.847 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-23 17:22:17.859 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-23 17:22:17.873 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-23 17:22:17.883 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-23 17:22:17.909 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-23 17:22:17.913 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-23 17:22:17.916 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-23 17:22:17.957 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-23 17:22:18.001 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:09:24.787  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/costMonitoring
2018-01-24 10:09:24.802  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 10:09:24.787  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/getTitle
2018-01-24 10:09:24.787  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 10:09:24.804  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 10:09:24.804  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 10:09:32.424 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-24 10:09:32.871 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-24 10:09:34.000 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-24 10:09:37.274 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:09:37.274 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:09:37.339 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:09:56.947 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:09:56.947 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:09:56.972 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:09:58.157 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:09:58.189 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:09:58.234 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:09:58.335 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:09:58.335 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:09:58.443 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:09:58.443 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:09:58.509 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:09:58.516 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:09:58.546 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:09:58.583 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:09:58.656 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:09:59.226 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:09:59.226 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:09:59.441 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:10:20.697 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:10:20.706 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:10:20.753 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:10:21.169 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:10:21.169 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:10:21.368 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:10:21.561 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:10:21.562 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:10:21.620 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:10:21.620 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:10:21.801 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:10:21.811 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:10:21.812 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:10:21.837 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:10:21.881 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:27:37.423 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:27:37.423 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:27:37.443 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:33.289  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 10:30:33.289  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 10:30:38.430 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-24 10:30:38.430 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-24 10:30:38.465 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-24 10:30:39.428 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:39.428 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:39.460 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:41.283 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:41.284 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:41.318 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:41.759 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:30:41.759 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:41.764 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:30:41.766 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:30:41.779 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:30:41.797 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:30:41.822 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:30:41.867 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:30:41.997 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:30:42.022 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:30:42.362 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:30:42.408 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:30:42.429 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:30:42.503 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:30:42.543 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:30:45.118 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:45.119 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:45.132 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:45.496 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:30:45.497 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:45.525 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:30:45.525 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:45.657 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:30:45.691 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:30:45.691 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:30:45.691 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:45.705 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:45.706 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:45.723 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:45.735 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:30:45.735 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:30:45.736 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:45.973 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:30:46.381 DEBUG 11252 --- [http-nio-9998-exec-7] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:30:46.390 DEBUG 11252 --- [http-nio-9998-exec-7] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:30:46.450 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:30:46.460 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:30:46.516 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:30:46.516 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:47.044 DEBUG 11252 --- [http-nio-9998-exec-7] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:30:47.095 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:30:47.149 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:30:48.655 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:48.655 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:48.679 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:48.882 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:30:48.887 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:49.035 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:30:49.035 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 10:30:49.035 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:49.065 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:30:49.240 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:49.240 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:49.262 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:49.700 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:30:49.701 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:30:49.832 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 10:30:49.840 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:50.103 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:30:50.104 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:30:50.105 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:50.105 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:50.115 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 10:30:50.144 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:50.232 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 10:30:50.312 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:30:50.340 DEBUG 11252 --- [http-nio-9998-exec-7] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:30:50.341 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:30:50.347 DEBUG 11252 --- [http-nio-9998-exec-7] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:30:50.395 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:30:50.395 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:30:50.499 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 10:30:50.741 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:30:50.805 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:30:50.856 DEBUG 11252 --- [http-nio-9998-exec-7] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:30:52.156 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:52.156 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:52.193 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:52.410 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-24 10:30:52.419 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-24 10:30:52.420 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-24 10:30:52.432 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:30:52.455 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-24 10:30:52.555 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-24 10:30:52.740 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:52.740 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:52.752 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:53.160 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 10:30:53.222 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:53.351 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:30:53.415 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-24 10:30:53.415 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-24 10:30:53.415 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-24 10:30:53.436 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-24 10:30:53.436 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-24 10:30:53.437 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-24 10:30:53.470 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-24 10:30:53.476 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-24 10:30:53.506 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-24 10:30:53.488 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-24 10:30:53.567 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-24 10:30:53.575 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-24 10:30:53.755 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:30:53.814 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-24 10:30:53.837 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-24 10:30:53.837 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:30:53.861 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-24 10:30:53.863 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-24 10:30:53.863 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:30:53.970 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-24 10:30:54.024 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-24 10:30:54.024 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-24 10:30:54.024 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:30:54.024 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-24 10:30:54.024 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-24 10:30:54.026 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-24 10:30:54.026 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:30:54.026 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-24 10:30:54.038 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-24 10:30:54.181 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-24 10:30:54.618 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:54.650 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:54.670 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:54.926 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-24 10:30:54.933 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:30:55.085 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:55.085 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:55.101 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:55.115 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-24 10:30:55.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:30:55.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:30:55.289 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-24 10:30:55.327 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:55.395 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 60
2018-01-24 10:30:55.421 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-24 10:30:55.421 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-24 10:30:55.421 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:55.446 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-24 10:30:55.565 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-24 10:30:55.573 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:30:55.700 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-24 10:30:55.739 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:30:55.751 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:30:55.876 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-24 10:30:58.542 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:30:58.564 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:30:58.564 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:30:58.564 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:30:58.565 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:30:58.591 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:30:58.603 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:30:58.604 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:30:58.604 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:30:58.604 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:30:58.619 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:30:58.658 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:30:58.735 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:30:58.848 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:30:58.861 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:30:58.872 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:30:58.882 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:30:59.050 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:32:16.328 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:16.360 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:32:16.360 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:16.365 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:16.427 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:16.437 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:32:16.437 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:16.500 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:32:16.521 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:32:16.528 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:16.587 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:32:16.587 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:32:16.588 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:32:16.603 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:32:16.705 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:32:16.793 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:16.793 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:16.801 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:32:16.827 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:32:16.862 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:32:16.876 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:16.877 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:32:16.934 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:32:16.934 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:17.507 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:32:17.559 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:32:17.602 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:32:19.534 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:19.534 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:19.561 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:32:19.562 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:19.565 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:19.711 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:32:19.712 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 10:32:19.740 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:32:19.765 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:32:20.130 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:32:20.131 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:32:20.140 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:20.140 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:20.231 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:32:20.239 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:20.264 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:32:20.282 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 10:32:20.299 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:20.539 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 10:32:20.661 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 10:32:20.708 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 10:32:21.425 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:21.480 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:21.557 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:32:21.557 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:32:21.579 DEBUG 11252 --- [http-nio-9998-exec-2] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:32:21.598 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:32:21.621 DEBUG 11252 --- [http-nio-9998-exec-2] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:32:21.629 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:21.720 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:22.010 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:32:22.014 DEBUG 11252 --- [http-nio-9998-exec-2] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:32:22.036 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:32:23.437 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==>  Preparing: SELECT count(0) FROM disease 
2018-01-24 10:32:23.438 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.find_COUNT       : ==> Parameters: 
2018-01-24 10:32:23.439 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.find_COUNT       : <==      Total: 1
2018-01-24 10:32:23.445 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.mapper.disease.DiseaseMapper.find  : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT * FROM disease ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:32:23.446 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:23.446 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:23.446 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.mapper.disease.DiseaseMapper.find  : ==> Parameters: 
2018-01-24 10:32:23.486 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:23.495 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.mapper.disease.DiseaseMapper.find  : <==      Total: 10
2018-01-24 10:32:25.089 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 10:32:25.089 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:32:25.172 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==>  Preparing: SELECT count(0) FROM early_warning t 
2018-01-24 10:32:25.172 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : ==> Parameters: 
2018-01-24 10:32:25.173 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.w.EarlyWarningMapper.find_COUNT  : <==      Total: 1
2018-01-24 10:32:25.173 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-24 10:32:25.173 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-24 10:32:25.175 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==>  Preparing: SELECT distinct deptcode code, dept name from doctor t 
2018-01-24 10:32:25.175 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==>  Preparing: select code, name from rule_dictionary t WHERE type = ? 
2018-01-24 10:32:25.182 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 2(String)
2018-01-24 10:32:25.182 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 3(String)
2018-01-24 10:32:25.182 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.getDoctors  : ==> Parameters: 
2018-01-24 10:32:25.183 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-24 10:32:25.184 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:32:25.192 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from early_warning t ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:32:25.192 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : ==> Parameters: 
2018-01-24 10:32:25.192 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : ==> Parameters: 1(String)
2018-01-24 10:32:25.224 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.w.E.getSelectOption              : <==      Total: 8
2018-01-24 10:32:25.262 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.warn.EarlyWarningMapper.find     : <==      Total: 6
2018-01-24 10:32:25.262 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.w.E.getSelectOption              : <==      Total: 2
2018-01-24 10:32:25.289 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.EarlyWarningMapper.getDoctors  : <==      Total: 4
2018-01-24 10:32:25.312 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:32:25.312 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 1(String)
2018-01-24 10:32:25.318 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:25.318 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:25.339 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-24 10:32:25.339 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:32:25.339 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 2(String)
2018-01-24 10:32:25.342 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:25.342 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-24 10:32:25.342 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:32:25.342 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 3(String)
2018-01-24 10:32:25.343 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 1
2018-01-24 10:32:25.372 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==>  Preparing: SELECT code, name, telephone from doctor t WHERE deptcode = ? 
2018-01-24 10:32:25.372 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : ==> Parameters: 4(String)
2018-01-24 10:32:25.415 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.w.E.getDoctorsChildren           : <==      Total: 3
2018-01-24 10:32:26.942 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:26.942 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:26.995 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:27.007 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-24 10:32:27.017 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:32:27.142 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-24 10:32:27.149 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:32:27.160 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:32:27.303 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-24 10:32:27.303 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-24 10:32:27.304 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:32:27.318 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-24 10:32:27.698 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-24 10:32:27.698 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:32:27.723 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:27.730 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:27.743 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-24 10:32:27.749 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:32:27.757 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:27.759 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 60
2018-01-24 10:32:27.859 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-24 10:32:27.860 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 10:32:27.860 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-24 10:32:27.983 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-24 10:32:33.817 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:33.817 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:33.821 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:35.071 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:35.073 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:32:35.105 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:35.105 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:32:35.107 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:32:35.107 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:32:35.133 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:32:35.158 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:35.174 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:32:35.181 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:32:35.193 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:32:35.199 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:32:35.270 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:32:35.279 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:32:35.309 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:32:35.309 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:32:35.409 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:32:35.475 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:32:49.755 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:32:49.764 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:32:49.782 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:32:49.782 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:32:49.816 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:32:49.816 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:32:49.844 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:32:49.893 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:32:49.895 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:32:50.423 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:32:50.481 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:32:50.559 DEBUG 11252 --- [http-nio-9998-exec-9] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:33:02.329 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:02.329 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:02.344 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:33:02.388 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:02.389 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:33:02.403 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:02.415 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:02.527 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:33:02.539 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:33:02.546 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:02.555 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:33:02.557 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:33:02.557 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:02.583 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:33:02.725 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:33:06.425 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:33:06.532 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:33:06.534 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:33:06.548 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:06.561 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:06.572 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:06.584 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:33:06.595 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:06.595 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:33:06.621 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:33:06.621 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:33:06.637 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:33:06.648 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:33:06.648 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:33:06.717 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:33:06.738 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:06.767 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:33:06.854 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:33:08.385 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:08.385 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:08.391 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:33:08.391 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:08.393 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:08.541 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:33:08.578 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 10:33:08.578 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:08.593 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:33:09.042 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:09.053 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:09.097 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:33:09.097 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:09.106 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:33:09.116 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:09.135 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 10:33:09.148 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:33:09.164 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:09.498 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 10:33:09.577 DEBUG 11252 --- [http-nio-9998-exec-6] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:33:09.590 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 10:33:09.594 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 10:33:09.602 DEBUG 11252 --- [http-nio-9998-exec-6] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:33:09.671 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:09.671 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:33:09.729 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:09.729 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:09.741 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:33:09.746 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:09.753 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:10.064 DEBUG 11252 --- [http-nio-9998-exec-6] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:33:10.094 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:33:10.162 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:33:11.391 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:11.391 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:11.392 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:33:11.405 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:33:11.418 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:11.425 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:11.425 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:33:11.460 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 10:33:11.460 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:11.827 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 10:33:11.850 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 10:33:11.878 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 10:33:12.082 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:12.082 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:12.130 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:33:12.130 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:12.137 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:12.278 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:33:12.320 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 10:33:12.321 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:12.336 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:33:13.607 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:33:13.607 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:33:13.647 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:33:13.647 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:33:13.696 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:33:13.705 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:13.706 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:33:13.727 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:13.738 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:13.751 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:33:13.751 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:13.765 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:33:13.769 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:33:13.778 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:13.813 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:33:13.832 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:33:13.855 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:33:14.017 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:33:14.207 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:14.207 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:14.239 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:14.306 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:33:14.450 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:14.562 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:33:14.727 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:33:14.751 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:14.796 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:33:14.811 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:14.893 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:33:14.962 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:33:14.962 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:33:14.963 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:15.001 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:33:15.591 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:15.602 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:15.620 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:33:15.621 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:33:15.635 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:15.644 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:15.645 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:33:15.676 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:33:15.685 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:16.264 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:33:16.317 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:33:16.344 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:33:16.537 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:16.574 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:16.658 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:16.658 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:33:16.674 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:16.729 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:33:16.730 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:16.831 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:33:16.845 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:33:16.846 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:33:16.875 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:33:16.876 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:33:16.876 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:16.892 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:33:17.010 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:33:19.514 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 10:33:19.514 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 10:33:19.539 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 10:33:19.539 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:33:19.546 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:33:19.546 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:33:19.551 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 10:33:19.563 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 10:33:19.588 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 10:33:19.604 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:33:19.604 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 10:33:19.653 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:33:19.654 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 10(String), 2018-01-24 10(String)
2018-01-24 10:33:19.655 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 10:33:19.655 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 10:33:19.698 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 10:33:19.756 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 10:33:19.846 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 10:34:15.039 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:34:15.040 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:34:15.089 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 10:34:15.090 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:34:15.090 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 10:34:15.090 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:34:15.127 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:34:15.231 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 10:34:15.265 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 10:34:15.266 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:34:15.269 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 10:34:15.270 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 10:34:15.270 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 10:34:15.298 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 10:34:15.424 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 10:34:15.809 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 10:34:15.825 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 10:34:15.840 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 10:34:15.858 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 10:34:15.859 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:34:15.871 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:34:15.873 DEBUG 11252 --- [http-nio-9998-exec-4] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 10:34:15.873 DEBUG 11252 --- [http-nio-9998-exec-4] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 10:34:15.877 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 10:34:16.484 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 10:34:16.512 DEBUG 11252 --- [http-nio-9998-exec-4] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 10:34:16.532 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 10:38:35.447 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 10:38:35.455 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 10:38:35.467 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:37:47.317  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 13:37:47.318  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 13:37:58.408 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-24 13:37:58.432 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-24 13:37:58.434 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-24 13:37:59.514 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:37:59.514 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:37:59.524 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:38:20.428 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:38:20.428 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:38:20.433 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:41:20.401 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:41:20.401 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:41:20.412 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:43:54.947 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:43:54.948 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:43:54.969 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:49:12.772 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:49:12.788 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:49:12.801 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:49:14.808 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:49:14.808 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:49:14.826 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:49:26.433 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:49:26.433 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:49:26.470 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:49:30.265 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:49:30.265 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:49:30.282 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:49:32.070 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:49:32.070 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:49:32.081 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:49:37.916 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:49:37.916 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:49:37.921 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:50:01.715 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:50:01.731 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:50:01.749 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:50:04.731 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:50:04.731 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:50:04.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:50:05.798 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:50:05.798 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:50:05.812 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 13:50:08.295 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 13:50:08.301 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 13:50:08.306 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:04:16.965 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:04:16.965 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:04:16.994 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:05:23.202 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:05:23.202 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:05:23.233 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:05:53.885 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:05:53.885 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:05:53.891 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:06:03.022 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:06:03.022 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:06:03.035 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:06:15.491 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:06:15.499 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:06:15.504 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:06:32.910 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:06:32.910 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:06:32.944 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:06:34.952 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:06:34.952 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:06:34.987 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:06:35.606 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:06:35.606 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:06:35.633 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:06:35.648 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:06:35.650 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:06:35.684 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:06:35.684 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:06:35.700 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:06:35.702 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:06:35.718 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:06:35.727 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:06:35.753 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:06:35.766 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:06:35.766 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:06:35.909 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:07:04.565 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:07:04.565 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:07:04.578 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:14.400 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:14.408 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:14.478 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:17.150 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:17.150 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:17.178 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:17.926 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:17.928 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:17.961 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:18.331 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:18:18.331 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:18:18.345 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:18:18.346 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:18:18.355 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:18:18.376 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:18:18.383 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:18:18.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:18:18.394 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:18:18.434 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:18:18.434 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:18:18.460 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:18:18.491 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:18:18.529 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:18:18.650 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:18:19.389 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:19.416 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:19.436 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:49.429 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:49.435 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:49.443 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:50.421 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:50.442 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:50.456 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:18:50.456 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:18:50.474 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:18:50.480 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:18:50.484 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:50.485 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:18:50.498 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:18:50.510 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:18:50.528 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:18:50.528 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:18:50.690 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:18:50.708 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:18:50.723 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:18:50.767 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:18:50.800 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:18:51.010 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:18:54.548 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:18:54.549 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:18:54.568 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:18:54.899 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 14:18:54.911 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 14:18:55.004 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:18:55.010 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 14:18:55.021 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 14:18:55.055 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:18:55.313 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 14:18:55.452 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 14:18:55.467 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 14:19:05.856 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:19:05.856 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:19:05.874 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:19:05.980 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 14:19:05.980 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:19:06.126 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 14:19:06.127 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-24 14:19:06.127 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:19:06.178 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 14:19:22.596 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:19:22.596 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:19:22.628 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:19:23.228 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 14:19:23.259 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 14:19:23.273 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:19:23.312 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 14:19:23.366 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 14:19:23.367 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:19:23.932 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 14:19:23.950 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 14:19:24.004 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 14:19:56.387 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:19:56.387 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:19:56.438 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:19:57.281 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:19:57.301 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 14:19:57.319 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 14:19:57.352 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 14:19:57.362 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 14:19:57.363 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:19:57.987 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 14:19:58.001 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 14:19:58.049 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 14:20:34.031 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:20:34.032 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:20:34.051 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:20:34.797 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 14:20:34.798 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 14:20:35.024 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:20:35.024 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 14:20:35.070 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 14:20:35.070 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:20:35.594 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 14:20:35.718 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 14:20:35.746 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 14:22:15.027 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:22:15.027 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:22:15.058 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:22:15.961 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 14:22:15.990 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 14:22:16.010 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:22:16.045 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 14:22:16.176 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 14:22:16.188 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:22:16.649 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 14:22:16.700 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 14:22:16.859 DEBUG 11252 --- [http-nio-9998-exec-5] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 14:22:21.578 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:22:21.588 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:22:21.638 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:23:15.373 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:23:15.382 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:23:15.431 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:23:50.517 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:23:50.517 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:23:50.555 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:00.906  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 14:24:00.906  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 14:24:01.110 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-24 14:24:01.110 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-24 14:24:01.120 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-24 14:24:02.378 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:02.391 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:02.407 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:08.159 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:08.170 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:08.178 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:20.456 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:20.456 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:20.496 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:22.533 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:22.538 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:22.574 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:25.232 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:25.232 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:25.264 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:26.522 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:26.534 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:26.566 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:34.894 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:34.895 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:34.918 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:43.553 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:43.553 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:43.576 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:24:50.267 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:24:50.267 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:24:50.283 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:25:24.008 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:25:24.008 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:25:24.025 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:26:46.563 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:26:46.563 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:26:46.602 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:26:53.863 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:26:53.863 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:26:53.875 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:26:55.075 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.range.RangeMapper.find_COUNT     : ==>  Preparing: SELECT count(0) FROM range 
2018-01-24 14:26:55.075 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.range.RangeMapper.find_COUNT     : ==> Parameters: 
2018-01-24 14:26:55.076 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.range.RangeMapper.find_COUNT     : <==      Total: 1
2018-01-24 14:26:57.353 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:26:57.353 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:26:57.387 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:11.103 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:32:11.104 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:32:11.138 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:12.784 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:32:12.784 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:32:12.834 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:13.302 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:32:13.329 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:32:13.337 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:32:13.350 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:32:13.368 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:32:13.375 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:32:13.383 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:32:13.384 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:32:13.395 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:32:13.450 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:32:13.457 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:32:13.457 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:32:13.473 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:32:13.487 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:32:13.643 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:32:16.527 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:32:16.531 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:32:16.555 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:16.916 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 14:32:16.933 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:16.950 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 14:32:16.950 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:17.077 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 14:32:17.083 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 14:32:17.104 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 14:32:17.157 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:32:17.184 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:32:17.192 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:32:17.194 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:32:17.194 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:32:17.206 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:32:17.222 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 14:32:17.259 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:32:17.259 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:32:17.308 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 14:32:17.345 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:32:17.465 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:17.381 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:32:17.425 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:32:17.463 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:32:17.479 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:32:17.478 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:32:17.546 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:32:17.547 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:32:17.594 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:17.639 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:32:17.716 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 14:32:17.768 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:32:18.442 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:32:18.442 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:32:18.487 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 14:32:18.529 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:18.601 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 14:32:18.637 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:18.645 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:18.789 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 14:32:18.793 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 14:32:18.797 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 14:32:18.840 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:32:18.870 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 14:32:18.904 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 14:32:18.929 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:19.129 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 14:32:20.906 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:32:20.912 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:32:20.931 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:32:21.344 DEBUG 11252 --- [http-nio-9998-exec-1] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 14:32:21.344 DEBUG 11252 --- [http-nio-9998-exec-1] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 14:32:21.399 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-24 14:32:21.399 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:32:21.406 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:32:21.439 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 14:32:22.027 DEBUG 11252 --- [http-nio-9998-exec-1] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-24 14:32:22.085 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-24 14:32:22.125 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-24 14:33:11.058 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:33:11.058 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:33:11.093 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:33:12.695 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:33:12.723 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:33:12.735 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:33:12.767 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:33:12.776 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:33:12.777 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:33:12.787 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:33:12.795 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:33:12.805 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:33:12.806 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:33:12.807 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:33:12.824 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:33:12.908 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:33:12.919 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:33:12.920 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:33:12.944 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:33:12.963 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:33:13.124 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:33:54.987 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:33:54.987 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:33:55.003 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:33:57.793 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:33:57.793 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:33:57.817 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:00.161 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:00.173 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:00.209 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:01.225 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:01.225 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:01.262 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:01.813 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:34:01.833 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:34:01.857 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:34:01.857 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:01.870 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:34:01.887 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:34:01.899 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:34:01.914 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:34:01.963 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:34:01.982 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:34:02.011 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:34:02.022 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:34:02.035 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:34:02.128 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:34:02.202 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:34:03.162 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:03.174 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:03.205 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:03.943 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:03.954 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:34:03.955 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:34:03.966 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:03.975 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:34:04.005 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:34:04.011 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:34:04.011 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:34:04.027 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:04.048 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:34:04.048 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:04.072 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:34:04.114 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:34:04.130 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:34:04.135 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:34:04.274 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:34:04.280 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:34:04.471 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:34:04.909 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:04.927 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:04.945 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:05.667 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:05.667 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:05.689 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:34:05.699 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:05.711 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:34:05.711 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:34:05.712 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:34:05.734 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:34:05.735 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:34:05.822 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:34:05.822 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:34:05.836 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:05.908 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:34:05.940 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:34:05.963 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:34:05.973 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:34:06.007 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:34:06.084 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:06.084 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:06.111 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:06.129 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:34:06.679 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:06.679 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:34:06.679 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:06.724 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:34:06.732 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:06.738 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:34:06.738 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:34:06.738 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:34:06.739 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:34:06.744 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:34:06.744 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:34:06.857 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:06.861 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:34:06.871 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:34:06.904 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:34:06.972 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:34:06.972 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:34:07.172 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:34:07.570 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:07.579 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:07.621 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:18.900 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:18.901 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:18.927 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:22.442 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:22.442 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:22.452 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:30.699 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:30.699 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:30.722 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:49.136 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:49.149 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:49.171 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:51.380 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:51.380 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:51.401 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:52.291 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:52.302 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:52.340 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:52.729 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:34:52.729 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:52.741 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:34:52.780 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:34:52.793 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:34:52.851 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:34:52.852 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:34:52.864 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:34:52.881 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:34:52.892 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:34:52.964 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:34:52.964 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:34:52.986 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:34:52.997 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:34:53.145 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:34:56.859 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:56.870 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:56.882 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:57.120 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 14:34:57.125 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 14:34:57.131 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:34:57.131 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:34:57.259 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 14:34:57.272 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 14:34:57.275 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 14:34:57.305 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:34:57.305 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 14:34:57.323 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:57.346 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 14:34:57.469 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 14:34:59.096 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:34:59.096 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:34:59.147 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 14:34:59.179 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:34:59.202 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:34:59.202 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 14(String), 2018-01-24 14(String)
2018-01-24 14:34:59.208 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:34:59.208 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:34:59.239 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 14:34:59.248 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:34:59.249 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:34:59.284 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:34:59.285 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 14:34:59.330 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 14:34:59.330 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 14:34:59.339 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 14:34:59.345 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:34:59.552 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 14:35:00.236 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 14:35:00.245 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:35:00.245 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:35:00.249 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 14:35:00.257 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:35:00.257 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:35:00.329 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:35:00.383 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 14:35:00.416 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 14:35:00.417 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:35:00.431 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 14:35:00.431 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 14:35:00.431 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:35:00.451 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 14:35:00.565 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 14:41:25.522 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:41:25.523 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:41:25.556 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:46:47.944 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:46:47.944 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:46:47.961 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:46:48.480 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 14:46:48.517 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 14:46:48.574 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 14:46:48.618 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 14:46:48.618 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 14:46:48.639 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 14:46:48.679 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:46:48.715 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 14:46:48.723 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:46:48.744 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 14:46:48.833 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 14:46:48.867 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 14:46:48.875 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 14:46:48.875 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 14:46:48.902 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 14:46:48.903 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 14:46:48.904 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 14:46:49.060 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 14:48:09.568 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:48:09.569 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:48:09.574 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 14:48:28.681 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 14:48:28.694 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 14:48:28.725 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 15:36:30.459  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 15:36:30.459  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 15:36:30.558 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-24 15:36:30.559 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-24 15:36:30.568 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-24 15:36:30.767 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 15:36:30.800 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:30.856 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 15:36:30.873 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:30.974 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 15:36:30.988 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 15:36:30.994 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 15:36:30.994 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 15:36:30.994 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 15:36:31.005 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:31.037 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 15:36:31.183 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 15:36:31.967 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 15:36:31.980 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 15:36:31.999 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 15:36:33.312 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 15:36:33.312 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 15:36:33.345 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 15:36:33.642 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 15:36:33.650 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 15:36:33.663 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 15:36:33.674 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 15:36:33.684 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 15:36:33.684 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 15:36:33.686 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 15:36:33.710 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 15:36:33.710 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 15(String), 2018-01-24 15(String)
2018-01-24 15:36:33.765 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 15:36:33.797 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 15:36:33.823 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 15:36:33.824 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 15:36:33.835 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 15:36:34.010 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 15:36:35.419 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 15:36:35.419 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 15:36:35.456 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 15:36:35.713 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 15:36:35.752 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:35.778 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 15:36:35.778 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:35.897 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 15:36:35.946 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 15:36:35.951 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 15:36:35.955 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 15:36:35.956 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 15:36:35.956 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:35.960 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 15:36:36.115 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 15:36:39.141 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 15:36:39.154 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 15:36:39.174 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 15:36:39.641 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 15:36:39.641 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 15:36:39.652 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 15:36:39.690 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 15:36:39.701 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 15:36:39.721 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:39.739 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 15:36:39.811 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 15:36:39.811 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:39.870 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 15:36:39.870 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 15:36:39.933 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 15:36:39.934 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 15:36:39.943 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 15:36:39.944 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 15:36:39.955 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 15:36:39.983 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 15:36:40.063 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 16:04:41.991 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 16:04:42.032 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:42.055 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 16:04:42.158 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 16:04:42.172 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:42.317 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 16:04:42.451 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 16:04:42.466 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 16:04:42.509 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:42.629 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:43.042 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-24 16:04:43.042 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 16:04:43.042 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:04:43.093 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 16:04:43.101 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 16:04:45.189 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 16:04:45.307 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:45.504 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 16:04:45.563 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 16:04:45.598 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:45.677 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 16:04:45.722 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 16:04:45.782 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:45.900 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 16:04:45.922 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:46.159 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 16:04:46.160 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-24 16:04:46.262 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 16:04:46.262 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:04:46.401 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 16:04:47.408 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 16:04:47.463 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:47.653 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 16:04:47.654 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:47.708 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 16:04:47.850 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 16:04:47.911 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 16:04:47.976 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:48.067 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 16:04:48.199 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 16:04:48.175 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-24 16:04:48.199 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 16:04:48.240 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:04:48.393 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 16:04:48.416 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 16:53:15.519  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 16:53:15.535  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 16:53:15.877  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/getMedicares
2018-01-24 16:53:15.877  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 16:53:15.900  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/getTitle
2018-01-24 16:53:15.900  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 16:53:15.936  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/findDisease
2018-01-24 16:53:15.936  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 16:53:15.964  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/findMedicare
2018-01-24 16:53:15.964  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 16:53:16.155  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-24 16:53:16.155  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-24 16:53:17.552 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-24 16:53:17.553 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-24 16:53:17.574 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-24 16:53:18.633 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 16:53:18.633 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 16:53:18.648 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 16:53:21.372 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 16:53:21.374 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 16:53:21.396 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 16:53:22.349 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 16:53:22.349 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 16:53:22.370 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 16:53:22.706 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-24 16:53:22.706 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:53:22.729 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 16:53:22.729 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-24 16:53:22.756 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 16:53:22.813 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 16:53:22.813 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 16:53:22.819 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 16:53:22.995 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-24 16:53:22.995 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-23 16(String), 2018-01-24 16(String)
2018-01-24 16:53:22.996 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-17 16(String), 2018-01-24 16(String)
2018-01-24 16:53:23.019 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 16:53:23.033 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 16:53:23.174 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-24 16:53:23.175 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-24 16:53:24.309 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 16:53:24.310 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 16:53:24.335 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 16:53:24.608 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 16:53:24.610 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 16:53:24.621 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:24.626 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:24.758 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 16:53:24.778 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 16:53:24.778 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 16:53:24.778 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:53:24.817 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 16:53:24.822 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 16:53:24.834 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:25.021 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 16:53:25.707 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 16:53:25.707 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 16:53:25.730 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 16:53:26.104 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 16:53:26.117 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:26.211 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 16:53:26.211 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 16:53:26.225 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 16:53:26.233 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 16:53:26.251 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 16:53:26.280 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 16:53:26.287 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 16:53:26.297 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:26.335 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 16:53:26.409 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 16:53:26.428 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:26.452 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 16:53:26.459 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:53:26.522 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 16:53:26.546 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 16:53:26.635 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 16:53:31.235 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 16:53:31.235 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 16:53:31.273 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 16:53:31.588 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-24 16:53:31.626 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-24 16:53:31.646 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-24 16:53:31.655 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-24 16:53:31.680 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 16:53:31.710 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:31.728 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 16:53:31.733 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:31.733 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-24 16:53:31.754 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-24 16:53:31.843 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 16:53:31.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 16:53:31.844 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 16:53:31.848 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 16:53:31.881 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 16:53:31.894 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 16:53:31.917 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 16:53:32.072 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 17:09:19.484 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-24 17:09:19.494 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 17:09:19.666 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-24 17:09:19.672 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getMedicares    : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * from ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as "支付标准60%", round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利)/COUNT(DISTINCT(DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用),2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, --round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round(AVG(DRGS.自理金额),2) as 病例自理均费, round(AVG(DRGS.自费金额),2) as 病例自费均费, round(AVG(DRGS.自负金额),2) as 病例自负均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) t order by 疾病名称 ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-24 17:09:19.685 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getMedicares    : ==> Parameters: 1(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 17:09:19.712 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 17:09:19.713 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 17:09:19.891 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.getMedicares    : <==      Total: 7
2018-01-24 17:09:19.892 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-24 17:09:19.892 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 17:09:19.897 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 17:09:19.923 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-24 17:09:19.931 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 17:09:19.932 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 17:09:20.188 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 17:22:53.948 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 17:22:53.948 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 17:22:53.953 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 17:22:54.376 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-24 17:22:54.422 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 17:22:54.474 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-24 17:22:54.475 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 17:22:54.580 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-24 17:22:54.604 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-24 17:22:54.610 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 17:22:54.625 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-24 17:22:54.626 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-24 17:22:54.626 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-24 17:22:54.646 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-24 17:22:54.758 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-24 17:46:32.338 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-24 17:46:32.338 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-24 17:46:32.353 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-24 17:46:33.079 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 17:46:33.100 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-24 17:46:33.113 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-17(String), 2018-01-24(String)
2018-01-24 17:46:33.122 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 17:46:33.171 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-24 17:46:33.171 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-25(String), 2018-01-24(String)
2018-01-24 17:46:33.547 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-24 17:46:33.566 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 17:46:33.585 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-24 17:46:42.363 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 17:46:42.363 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-24(String)
2018-01-24 17:46:42.787 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 17:46:46.849 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 17:46:46.849 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 17:46:47.256 DEBUG 11252 --- [http-nio-9998-exec-1] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-24 17:46:48.513 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-24 17:46:48.524 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2017-12-01(String), 2018-01-24(String)
2018-01-24 17:46:48.973 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 10:31:40.222  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportPieChart
2018-01-25 10:31:40.222  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-25 10:31:41.796 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-25 10:31:41.817 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-25 10:31:41.880 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-25 10:31:43.149 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 10:31:43.149 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 10:31:43.168 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 10:31:44.505 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 10:31:44.517 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 10:31:44.543 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 10:31:44.878 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 10:31:44.933 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-25 10:31:44.941 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-18 10(String), 2018-01-25 10(String)
2018-01-25 10:31:44.952 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-25 10:31:44.952 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-25 10:31:44.966 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 10:31:44.999 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-25 10:31:44.999 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-25 10:31:45.007 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-25 10:31:45.042 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-25 10:31:45.064 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-25 10:31:45.126 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-25 10:31:45.156 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-25 10:31:45.172 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-24 16(String), 2018-01-25 16(String)
2018-01-25 10:31:45.356 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-25 10:31:47.791 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 10:31:47.791 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 10:31:47.807 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 10:31:48.010 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-25 10:31:48.010 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 在院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 10:31:48.173 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-25 10:31:48.180 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor2') ORDER BY column_id 
2018-01-25 10:31:48.181 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 10:31:48.212 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-25 10:31:49.477 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 10:31:49.478 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 10:31:49.495 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 10:31:49.802 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 10:31:49.802 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-25(String)
2018-01-25 10:31:49.832 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 10:31:49.832 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-18(String), 2018-01-25(String)
2018-01-25 10:31:49.834 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-25 10:31:49.849 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 10:31:50.216 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 10:31:50.232 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-25 10:31:50.248 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-25 10:31:51.821 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 10:31:51.833 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 10:31:51.865 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 10:31:52.291 DEBUG 11252 --- [http-nio-9998-exec-1] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 10:31:52.291 DEBUG 11252 --- [http-nio-9998-exec-1] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-25(String)
2018-01-25 10:31:52.338 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 10:31:52.353 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 在院(String), 2018-01-18(String), 2018-01-25(String)
2018-01-25 10:31:52.354 DEBUG 11252 --- [http-nio-9998-exec-7] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-01-25 10:31:52.373 DEBUG 11252 --- [http-nio-9998-exec-7] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 在院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 10:31:52.763 DEBUG 11252 --- [http-nio-9998-exec-1] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-01-25 10:31:52.765 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-01-25 10:31:52.810 DEBUG 11252 --- [http-nio-9998-exec-7] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-01-25 10:31:57.117 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 10:31:57.132 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-25 10:31:57.142 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-25(String)
2018-01-25 10:31:57.152 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 10:31:57.161 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 10:31:57.169 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 10:31:57.182 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-18(String), 2018-01-25(String)
2018-01-25 10:31:57.182 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 10:31:57.202 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 10:31:57.568 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 10:31:57.572 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-25 10:31:57.583 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-25 10:32:15.651 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 10:32:15.674 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2017-12-01(String), 2018-01-25(String)
2018-01-25 10:32:16.108 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 10:32:17.275 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 10:32:17.284 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2017-12-01(String), 2018-01-31(String)
2018-01-25 10:32:17.706 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 11:20:11.770  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-25 11:20:11.770  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-25 11:20:12.046 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-25 11:20:12.047 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-25 11:20:12.059 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-25 11:20:12.556 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 11:20:12.583 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 在院(String), 2018-01-18(String), 2018-01-25(String)
2018-01-25 11:20:12.594 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-25 11:20:12.594 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 在院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 11:20:12.595 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.当前状态 = ? AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.入院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 11:20:12.615 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 在院(String), 2018-01-01(String), 2018-01-25(String)
2018-01-25 11:20:12.991 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-25 11:20:13.016 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-25 11:20:13.071 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 11:20:13.614 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 11:20:13.620 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 11:20:13.652 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 11:20:14.942 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 11:20:14.943 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 11:20:14.972 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 11:20:15.370 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-25 11:20:15.370 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-25 11:20:15.383 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-25 11:20:15.388 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-25 11:20:15.439 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-25 11:20:15.439 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 11:20:15.439 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 11:20:15.440 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-18 11(String), 2018-01-25 11(String)
2018-01-25 11:20:15.441 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-25 11:20:15.452 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-25 11:20:15.507 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-25 11:20:15.507 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-24 16(String), 2018-01-25 16(String)
2018-01-25 11:20:15.511 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-25 11:20:15.556 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-25 11:20:15.696 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-25 11:20:35.011 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 11:20:35.011 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 11:20:35.044 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 11:20:35.373 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('out_medicare') ORDER BY column_id 
2018-01-25 11:20:35.389 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 11:20:35.428 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 60
2018-01-25 11:20:35.451 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损定额结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数, nvl(sum(t2.盈利), 0) 止损金额 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-25 11:20:35.457 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : ==> Parameters: 1(String), 出院(String)
2018-01-25 11:20:35.595 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl_COUNT      : <==      Total: 1
2018-01-25 11:20:35.596 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损定额结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数, nvl(sum(t2.盈利),0) 止损金额 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-25 11:20:35.596 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : ==> Parameters: 1(String), 出院(String)
2018-01-25 11:20:35.720 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.tuichuyibaokfjsbl            : <==      Total: 1
2018-01-25 11:20:36.298 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 11:20:36.298 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 11:20:36.320 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 11:20:36.696 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') || '-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM') 统计时间, sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) 医保结算金额, count(1) 总病例, count(DISTINCT (CASE WHEN t.盈亏标识 = 0 THEN t.住院号 END)) 亏损病例数, sum(CASE WHEN t.盈亏标识 = 0 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 亏损医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 1 THEN t.住院号 END)) 盈利病例数, sum(CASE WHEN t.盈亏标识 = 1 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 盈利医保结算金额, count(DISTINCT (CASE WHEN t.盈亏标识 = 2 THEN t.住院号 END)) 实付病例数, sum(CASE WHEN t.盈亏标识 = 2 THEN (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) ELSE 0 END) 实付医保结算金额, floor(count(DISTINCT t.住院号) * 0.15) 可申请退出病例数, count(DISTINCT t2.住院号) 实际退出病例数 FROM patient_accounting t LEFT OUTER JOIN drgs.out_medicare t2 ON t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'), 1) - (1 / (24 * 60 * 60)) GROUP BY to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'yyyy-MM')) table_count 
2018-01-25 11:20:36.696 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : ==> Parameters: 1(String), 出院(String)
2018-01-25 11:20:36.868 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findMedicareSettlementList_COUNT : <==      Total: 1
2018-01-25 11:20:36.884 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM')||'-01 00:00:00' startdate, max(to_char(last_day(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')), 'yyyy-MM-dd')) || ' 23:59:59' enddate, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') 统计时间, sum(t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) 医保结算金额 , count(1) 总病例, count(distinct(case when t.盈亏标识 = 0 then t.住院号 end)) 亏损病例数, sum(case when t.盈亏标识 = 0 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 亏损医保结算金额, count(distinct(case when t.盈亏标识 = 1 then t.住院号 end)) 盈利病例数, sum(case when t.盈亏标识 = 1 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 盈利医保结算金额, count(distinct(case when t.盈亏标识 = 2 then t.住院号 end)) 实付病例数, sum(case when t.盈亏标识 = 2 then (t.支付标准价+t.CG材料费+t.CQ材料费+t.超限床位费- t.自理金额-t.自费金额) else 0 end) 实付医保结算金额, floor(count(distinct t.住院号)*0.15) 可申请退出病例数, count(distinct t2.住院号) 实际退出病例数 from patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') >= to_date('2017-12', 'yyyy-MM') and to_date(t.出院日期,'yyyy-MM-dd hh24:mi:ss') <= add_months(to_date('2018-01', 'yyyy-MM'),1) - (1/(24*60*60)) group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM') ) TMP_PAGE WHERE ROWNUM <= 10 
2018-01-25 11:20:36.890 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : ==> Parameters: 1(String), 出院(String)
2018-01-25 11:20:37.026 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareSettlementList   : <==      Total: 1
2018-01-25 11:20:37.027 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare_settlement_list') ORDER BY column_id 
2018-01-25 11:20:37.027 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 11:20:37.050 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 11
2018-01-25 11:20:40.318 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 11:20:40.318 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 11:20:40.340 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 11:20:40.698 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-25 11:20:40.698 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-25 11:20:40.723 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-01-25 11:20:40.723 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 11:20:40.730 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-25 11:20:40.766 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 11:20:40.767 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-25 11:20:40.767 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-25 11:20:40.773 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-25 11:20:40.810 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-25 11:20:40.832 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-01-25 11:20:40.832 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-01-25 11:20:40.842 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 11:20:40.846 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-01-25 11:20:40.895 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-25 11:20:40.909 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-25 11:20:40.934 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 11:20:41.097 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-25 11:20:41.419 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 11:20:41.419 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 11:20:41.466 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 11:20:41.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 11:20:41.874 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-18(String), 2018-01-25(String)
2018-01-25 11:20:41.900 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-25 11:20:41.900 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 11:20:41.909 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 11:20:41.923 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-25(String)
2018-01-25 11:20:42.548 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-25 11:20:42.556 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 11:20:42.560 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-25 11:34:48.570 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 11:34:48.603 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-01-25(String)
2018-01-25 11:34:49.266 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 11:34:50.441 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 11:34:50.447 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-01-25(String)
2018-01-25 11:34:51.095 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 16:53:11.301  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-25 16:53:11.302  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-25 16:53:12.753 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-25 16:53:12.753 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-25 16:53:12.756 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-25 16:53:13.936 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 16:53:13.937 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 16:53:13.964 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 16:53:15.171 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 16:53:15.172 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 16:53:15.188 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 16:53:15.566 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-25 16:53:15.566 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-25 16:53:15.586 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-25 16:53:15.613 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-25 16:53:15.613 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-25 16:53:15.613 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-25 16:53:15.613 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-25 16:53:15.616 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 16:53:15.660 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-18 16(String), 2018-01-25 16(String)
2018-01-25 16:53:15.667 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-25 16:53:15.667 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-24 16(String), 2018-01-25 16(String)
2018-01-25 16:53:15.669 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-25 16:53:15.715 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-25 16:53:15.779 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-25 16:53:15.856 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-25 16:53:17.809 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-25 16:53:17.810 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-25 16:53:17.826 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-25 16:53:18.132 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-25 16:53:18.133 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-25(String)
2018-01-25 16:53:18.180 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-25 16:53:18.180 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-25 16:53:18.187 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-18(String), 2018-01-25(String)
2018-01-25 16:53:18.187 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-26(String), 2018-01-25(String)
2018-01-25 16:53:18.794 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-25 16:53:18.828 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-25 16:53:18.833 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-30 14:02:05.832  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-30 14:02:05.832  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-30 14:02:07.539 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-30 14:02:07.548 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-30 14:02:07.572 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-30 14:02:08.632 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 14:02:08.632 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 14:02:08.636 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:06:14.403  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-30 15:06:14.403  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-30 15:06:14.556 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-30 15:06:14.556 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-30 15:06:14.558 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-30 15:06:15.875 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:06:15.875 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:06:15.878 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:34.126 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:09:34.127 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:09:34.130 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:41.507  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-30 15:09:41.507  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-30 15:09:41.641 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-30 15:09:41.641 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-30 15:09:41.642 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-30 15:09:42.815 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:09:42.815 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:09:42.818 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:43.023 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:09:43.023 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:09:43.027 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:44.535 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:09:44.535 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:09:44.539 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:45.204 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-30 15:09:45.205 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-30 15:09:45.205 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-30 15:09:45.205 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-30 15:09:45.206 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-30 15:09:45.208 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-30 15:09:45.208 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-30 15:09:45.222 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-30 15:09:45.226 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-30 15:09:45.240 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-23 15(String), 2018-01-30 15(String)
2018-01-30 15:09:45.284 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-30 15:09:45.305 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-30 15:09:45.321 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-29 16(String), 2018-01-30 16(String)
2018-01-30 15:09:45.354 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-30 15:09:45.560 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-30 15:09:52.412 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:09:52.412 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:09:52.416 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:52.973 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-30 15:09:52.974 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-23 15(String), 2018-01-30 15(String)
2018-01-30 15:09:52.975 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-30 15:09:52.976 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-30 15:09:52.977 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-30 15:09:52.977 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-30 15:09:52.980 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-30 15:09:52.980 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-30 15:09:52.982 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-30 15:09:53.025 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-30 15:09:53.031 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-30 15:09:53.041 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-29 16(String), 2018-01-30 16(String)
2018-01-30 15:09:53.076 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-30 15:09:53.086 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-30 15:09:53.247 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-30 15:09:55.548 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:09:55.548 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:09:55.569 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:09:55.891 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-30 15:09:55.892 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-23(String), 2018-01-30(String)
2018-01-30 15:09:55.901 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-30 15:09:55.901 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-30(String)
2018-01-30 15:09:55.913 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-30 15:09:55.913 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-31(String), 2018-01-30(String)
2018-01-30 15:09:56.545 DEBUG 11252 --- [http-nio-9998-exec-4] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-30 15:09:56.549 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-30 15:09:56.578 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-30 15:10:04.161 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 15:10:04.162 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 15:10:04.165 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 15:20:45.400 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-30 15:20:45.400 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-01-30(String)
2018-01-30 15:20:46.071 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-30 15:20:47.030 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-30 15:20:47.030 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-01-30(String)
2018-01-30 15:20:47.700 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-30 16:10:37.429  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-30 16:10:37.439  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-30 16:10:46.808 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-30 16:10:46.809 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-01-30 16:10:46.810 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-30 16:10:48.631 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 16:10:48.631 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 16:10:48.635 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 16:12:16.658  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-30 16:12:16.658  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-30 17:17:20.336 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-30 17:17:20.336 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-30 17:17:20.343 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-30 17:17:21.910 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 17:17:21.910 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 17:17:21.956 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 17:17:27.368 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 17:17:27.383 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 17:17:27.412 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 17:17:29.052 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 17:17:29.052 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 17:17:29.057 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 17:17:29.471 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-30 17:17:29.471 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-30 17:17:29.477 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-30 17:17:29.478 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-23 17(String), 2018-01-30 17(String)
2018-01-30 17:17:29.512 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-30 17:17:29.512 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-30 17:17:29.532 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-30 17:17:29.544 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-30 17:17:29.544 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-30 17:17:29.545 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-30 17:17:29.548 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-30 17:17:29.548 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-29 16(String), 2018-01-30 16(String)
2018-01-30 17:17:29.555 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-30 17:17:29.594 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-30 17:17:29.715 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-30 17:17:34.802 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 17:17:34.802 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 17:17:34.806 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 17:17:35.758 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 17:17:35.758 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 17:17:35.780 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 17:17:36.165 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-30 17:17:36.165 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-30 17:17:36.174 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-30 17:17:36.182 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-30 17:17:36.182 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-30 17:17:36.187 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-30 17:17:36.197 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-30 17:17:36.197 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-30 17:17:36.198 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-30 17:17:36.208 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-30 17:17:36.208 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-29 16(String), 2018-01-30 16(String)
2018-01-30 17:17:36.223 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-30 17:17:36.223 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-23 17(String), 2018-01-30 17(String)
2018-01-30 17:17:36.338 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-30 17:17:36.373 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-30 17:17:39.037 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-30 17:17:39.037 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-30 17:17:39.041 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-30 17:17:39.344 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-30 17:17:39.344 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-30(String)
2018-01-30 17:17:39.346 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-30 17:17:39.346 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-23(String), 2018-01-30(String)
2018-01-30 17:17:39.349 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-30 17:17:39.349 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2017-12-31(String), 2018-01-30(String)
2018-01-30 17:17:39.986 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-30 17:17:39.996 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-30 17:17:40.002 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-31 09:41:47.890  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportPieChart
2018-01-31 09:41:47.891  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-31 09:41:49.428 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-31 09:41:49.428 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-31 09:41:49.430 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-31 09:41:50.383 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 09:41:50.395 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 09:41:50.400 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 09:41:58.195 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 09:41:58.195 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 09:41:58.199 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 09:41:59.315 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 09:41:59.316 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 09:41:59.319 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 09:41:59.741 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 09:41:59.759 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-24 09(String), 2018-01-31 09(String)
2018-01-31 09:41:59.985 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-31 09:41:59.985 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-31 09:42:00.002 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-31 09:42:00.044 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-31 09:42:00.067 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-31 09:42:00.079 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-31 09:42:00.098 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 09:42:00.126 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 09:42:00.139 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-31 09:42:00.139 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-31 09:42:00.225 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-31 09:42:00.226 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-30 16(String), 2018-01-31 16(String)
2018-01-31 09:42:00.425 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-31 09:42:09.701 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 09:42:09.710 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 09:42:09.741 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 09:42:10.621 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 09:42:10.621 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 09:42:10.671 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 09:42:10.904 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 09:42:10.937 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-24 09(String), 2018-01-31 09(String)
2018-01-31 09:42:10.966 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-31 09:42:10.977 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 09:42:10.977 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-31 09:42:10.984 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-31 09:42:11.004 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-31 09:42:11.023 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-31 09:42:11.048 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-31 09:42:11.052 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 09:42:11.065 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-31 09:42:11.144 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-31 09:42:11.147 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-30 16(String), 2018-01-31 16(String)
2018-01-31 09:42:11.174 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-31 09:42:11.316 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-31 09:42:18.703 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 09:42:18.722 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 09:42:18.740 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 09:42:19.077 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 09:42:19.078 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 09:42:19.090 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 09:42:19.120 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-31 09:42:19.129 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-24(String), 2018-01-31(String)
2018-01-31 09:42:19.130 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 09:42:19.707 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 09:42:19.784 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-31 09:42:19.789 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-31 10:36:50.779  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportPieChart
2018-01-31 10:36:50.779  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-31 10:36:50.977 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-31 10:36:50.986 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-31 10:36:50.988 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-31 10:36:52.416 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 10:36:52.416 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 10:36:52.439 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 10:36:53.827 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 10:36:53.828 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 10:36:53.856 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 10:36:54.270 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-31 10:36:54.270 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 10:36:54.284 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 10:36:54.285 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-31 10:36:54.285 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-31 10:36:54.294 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-31 10:36:54.294 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-31 10:36:54.296 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-31 10:36:54.307 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-24 10(String), 2018-01-31 10(String)
2018-01-31 10:36:54.346 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-31 10:36:54.373 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-31 10:36:54.467 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 10:36:54.473 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-31 10:36:54.474 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-30 16(String), 2018-01-31 16(String)
2018-01-31 10:36:54.641 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-31 10:36:59.500 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 10:36:59.500 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 10:36:59.515 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 10:37:00.256 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-31 10:37:00.256 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-31 10:37:00.257 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-31 10:37:00.258 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-31 10:37:00.259 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 10:37:00.259 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-31 10:37:00.261 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-31 10:37:00.266 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 10:37:00.417 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-24 10(String), 2018-01-31 10(String)
2018-01-31 10:37:00.430 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-31 10:37:00.434 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-31 10:37:00.440 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-30 16(String), 2018-01-31 16(String)
2018-01-31 10:37:00.467 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-31 10:37:00.618 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 10:37:00.625 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-31 10:37:10.525 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-31 10:37:10.525 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-31 10:37:10.562 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 10:37:10.563 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-24 10(String), 2018-01-31 10(String)
2018-01-31 10:37:10.588 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-31 10:37:10.588 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-31 10:37:10.641 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-31 10:37:10.641 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 10:37:10.642 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-31 10:37:10.664 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-31 10:37:10.710 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 10:37:10.710 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 10:37:10.750 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 10:37:10.775 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-31 10:37:10.775 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-30 16(String), 2018-01-31 16(String)
2018-01-31 10:37:10.776 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-31 10:37:10.783 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 10:37:10.977 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-31 10:37:14.234 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select EXTRACT(HOUR FROM to_timestamp(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '时' AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= sysdate-12/24 group by EXTRACT(HOUR FROM to_timestamp(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(HOUR FROM to_timestamp(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-01-31 10:37:14.234 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String)
2018-01-31 10:37:14.367 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 10:37:23.425 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 10:37:23.425 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 10:37:23.446 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 10:37:23.788 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-01-31 10:37:23.804 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 10:37:23.873 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-01-31 10:37:23.873 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 10:37:23.969 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-01-31 10:37:24.017 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-01-31 10:37:24.025 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-01-31 10:37:24.035 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-01-31 10:37:24.035 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 10:37:24.035 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 10:37:24.056 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-01-31 10:37:24.182 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-01-31 10:37:25.808 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 10:37:25.809 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 10:37:25.834 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 10:37:25.875 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 10:37:25.885 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-24(String), 2018-01-31(String)
2018-01-31 10:37:25.886 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 10:37:25.886 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 10:37:25.988 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-31 10:37:26.002 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 10:37:26.493 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-31 10:37:26.616 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 10:37:26.655 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-31 10:37:28.587 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 10:37:28.588 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-31(String)
2018-01-31 10:37:29.253 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 10:37:30.428 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 10:37:30.428 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-17(String), 2018-01-18(String)
2018-01-31 10:37:31.088 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 10:38:10.579 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 10:38:10.579 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-08(String), 2018-01-18(String)
2018-01-31 10:38:11.237 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 11:49:56.686  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportChart
2018-01-31 11:49:56.700  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportPieChart
2018-01-31 11:49:56.708  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-31 11:49:56.708  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-31 11:49:56.723  INFO 11252 --- [http-nio-9998-exec-3] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-01-31 11:49:56.741  INFO 11252 --- [http-nio-9998-exec-3] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-31 11:49:56.746  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findCostHospitalReportForm
2018-01-31 11:49:56.746  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-01-31 11:49:56.950 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-01-31 11:49:56.951 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-01-31 11:49:57.031 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-01-31 11:49:58.261 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 11:49:58.262 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 11:49:58.273 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 11:49:59.422 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 11:49:59.422 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 11:49:59.464 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 11:49:59.876 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-01-31 11:49:59.877 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-01-31 11:49:59.888 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-01-31 11:49:59.923 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 11:50:00.100 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-24 11(String), 2018-01-31 11(String)
2018-01-31 11:50:00.109 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-01-31 11:50:00.109 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-01-31 11:50:00.124 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-01-31 11:50:00.124 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-30 16(String), 2018-01-31 16(String)
2018-01-31 11:50:00.132 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-01-31 11:50:00.132 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-01-31 11:50:00.172 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-01-31 11:50:00.245 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-01-31 11:50:00.253 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-01-31 11:50:00.302 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-01-31 11:50:01.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 11:50:01.126 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 11:50:01.169 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 11:50:01.570 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 11:50:01.587 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 11:50:01.605 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 11:50:01.606 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-24(String), 2018-01-31(String)
2018-01-31 11:50:01.713 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-31 11:50:01.713 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 11:50:02.262 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 11:50:02.266 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-31 11:50:02.386 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-01-31 11:50:07.777 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-01-31 11:50:07.803 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-01-31 11:50:07.805 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-01-31 11:50:07.806 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-24(String), 2018-01-31(String)
2018-01-31 11:50:07.822 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-01-31 11:50:07.860 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-01-31 11:50:07.873 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 11:50:07.893 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-01-31 11:50:07.897 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-01(String), 2018-01-31(String)
2018-01-31 11:50:08.487 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-01-31 11:50:08.543 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-01-31 11:50:08.559 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 09:35:39.934  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 09:35:39.935  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 09:35:41.727 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 09:35:41.745 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 09:35:41.794 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 09:36:02.964 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 09:36:02.970 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 09:36:02.989 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 09:36:07.089 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 09:36:07.103 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 09:36:07.157 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 09:36:41.745 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 09:36:41.754 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 09:36:41.786 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 09:36:43.660 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 09:36:43.661 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 09:36:43.682 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 09:36:44.120 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 09:36:44.121 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 09:36:44.150 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 09:36:44.224 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 09:36:44.240 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 09:36:44.245 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 09(String), 2018-02-01 09(String)
2018-02-01 09:36:44.256 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 09:36:44.266 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 09:36:44.302 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 09:36:44.327 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 09:36:44.356 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 09:36:44.441 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 09:36:44.583 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 09:36:44.597 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 09:36:44.779 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 09:36:47.215 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 09:36:47.227 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 09:36:47.246 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 09:36:47.586 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 09:36:47.615 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 09:36:47.658 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 09:36:47.679 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 09:36:47.680 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 09:36:47.699 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 09:36:48.311 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 09:36:48.312 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 09:36:48.370 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 09:38:20.878 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 09:38:20.897 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 09:38:21.564 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 09:38:24.235 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 09:38:24.236 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 09:38:24.922 DEBUG 11252 --- [http-nio-9998-exec-7] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 09:58:14.806  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 09:58:14.806  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 09:58:15.018 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 09:58:15.018 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-02-01 09:58:15.048 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 09:58:16.366 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 09:58:16.376 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 09:58:16.433 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:13.830  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportChart
2018-02-01 10:10:13.830  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 10:10:14.016 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 10:10:14.016 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 10:10:14.027 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 10:10:15.325 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:15.335 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:15.437 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:16.552 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:16.566 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:16.593 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:17.011 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:10:17.031 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 10:10:17.031 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 10:10:17.055 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 10(String), 2018-02-01 10(String)
2018-02-01 10:10:17.160 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 10:10:17.160 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 10:10:17.161 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 10:10:17.174 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 10:10:17.175 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 10:10:17.181 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 10:10:17.216 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 10:10:17.349 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 10:10:17.356 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 10:10:17.375 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 10:10:17.554 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 10:10:20.900 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:20.900 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:20.936 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:21.258 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:10:21.274 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:10:21.281 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:10:21.324 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 10:10:21.362 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 10:10:21.362 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:21.935 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:10:21.960 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:10:21.990 DEBUG 11252 --- [http-nio-9998-exec-3] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 10:10:23.555 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:10:23.555 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 10:10:24.210 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:10:31.137 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:10:31.149 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 10:10:31.837 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:10:35.126 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:35.126 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:35.139 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:35.674 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:10:35.674 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 10:10:35.800 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:10:35.801 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:10:35.855 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-02-01 10:10:35.856 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:36.310 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:36.310 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:36.323 DEBUG 11252 --- [http-nio-9998-exec-4] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-02-01 10:10:36.323 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:36.450 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-02-01 10:10:36.525 DEBUG 11252 --- [http-nio-9998-exec-5] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-02-01 10:10:36.658 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 10:10:36.682 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 10:10:36.696 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 10:10:36.696 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 10:10:36.743 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 10:10:36.875 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 10:10:36.921 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-02-01 10:10:36.940 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:37.024 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-02-01 10:10:37.025 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:37.124 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-02-01 10:10:37.134 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-02-01 10:10:37.159 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-02-01 10:10:37.162 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 10:10:37.164 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-02-01 10:10:37.164 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:37.181 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-02-01 10:10:37.320 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-02-01 10:10:37.882 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:37.883 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:37.917 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:10:37.917 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:10:37.927 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:10:37.961 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 10:10:38.038 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:38.078 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 10:10:38.088 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:38.589 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:10:38.678 DEBUG 11252 --- [http-nio-9998-exec-6] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:10:38.773 DEBUG 11252 --- [http-nio-9998-exec-7] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 10:10:48.130 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:10:48.130 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:10:48.149 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:10:48.478 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:10:48.489 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:10:48.490 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:10:48.513 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 10:10:48.531 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 10:10:48.531 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:10:49.176 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:10:49.179 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:10:49.206 DEBUG 11252 --- [http-nio-9998-exec-9] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 10:11:24.397 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:11:24.397 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 10:11:25.106 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:11:26.341 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:11:26.349 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 10:11:26.991 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:13:11.822 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:13:11.836 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 10:13:12.497 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:13:14.181 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:13:14.182 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-27(String)
2018-02-01 10:13:14.866 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:14:08.096 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:14:08.096 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-27(String)
2018-02-01 10:14:08.799 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:14:12.602 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:14:12.606 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-26(String)
2018-02-01 10:14:13.284 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:16:35.382 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' order by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' 
2018-02-01 10:16:35.382 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:16:36.108 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:36.804 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:16:36.804 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:16:37.489 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:37.659 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(YEAR FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '年' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(YEAR FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(YEAR FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:16:37.660 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:16:38.287 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:38.316 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' order by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' 
2018-02-01 10:16:38.320 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:16:38.965 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:40.431 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:16:40.433 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-23(String), 2018-02-01(String)
2018-02-01 10:16:41.100 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:42.672 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:16:42.672 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-23(String), 2018-02-14(String)
2018-02-01 10:16:43.333 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:43.515 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' order by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' 
2018-02-01 10:16:43.516 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-23(String), 2018-02-14(String)
2018-02-01 10:16:44.192 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:45.965 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:16:45.965 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-22(String), 2018-02-14(String)
2018-02-01 10:16:46.633 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:47.903 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:16:47.903 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-22(String), 2018-02-09(String)
2018-02-01 10:16:48.552 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:48.673 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:16:48.695 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-22(String), 2018-02-09(String)
2018-02-01 10:16:49.342 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:16:53.573 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:16:53.579 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-09(String)
2018-02-01 10:16:54.246 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 10:16:55.264 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:16:55.275 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:16:55.943 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 10:16:58.045 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' order by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' 
2018-02-01 10:16:58.051 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:16:58.725 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 3
2018-02-01 10:16:59.979 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:16:59.979 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:01.309 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' order by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' 
2018-02-01 10:17:01.328 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:01.986 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 3
2018-02-01 10:17:02.221 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:17:02.271 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:02.287 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 10
2018-02-01 10:17:02.898 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 10:17:04.756 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(YEAR FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '年' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(YEAR FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(YEAR FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:17:04.757 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:05.442 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 10:17:06.965 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 10:17:06.965 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:07.642 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 10:17:09.746 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' order by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'YYYY')||'年第'||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'), 'WW')||'周' 
2018-02-01 10:17:09.747 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:10.420 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 3
2018-02-01 10:17:16.846 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:17:16.846 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-21(String)
2018-02-01 10:17:17.494 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 10
2018-02-01 10:33:08.787  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 10:33:08.788  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 10:33:09.032 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 10:33:09.032 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: sym(String)
2018-02-01 10:33:09.117 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 10:33:10.138 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:33:10.138 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:33:10.207 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:38:09.880 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 10:38:09.966 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 10:38:10.105 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 10:38:10.105 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 10:38:10.121 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 10:38:10.127 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 10:38:10.764 DEBUG 11252 --- [http-nio-9998-exec-8] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 10:38:10.769 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 10:38:10.770 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 10:38:11.057 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:38:11.057 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:38:11.132 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 10:52:47.729 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 10:52:47.729 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 10:52:47.751 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 11:02:38.370 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 11:02:38.381 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 11:02:39.086 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 11:02:40.060 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 11:02:40.081 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-20(String)
2018-02-01 11:02:40.763 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 11:02:58.102 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 11:02:58.236 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 11:02:58.237 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 11:02:58.242 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 11:02:58.254 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 11:02:58.320 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 11:02:58.350 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 11:02:58.360 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 11:02:58.360 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 11:02:58.920 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 11:02:58.956 DEBUG 11252 --- [http-nio-9998-exec-3] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 11:02:59.034 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 11:18:57.171 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 11:18:57.171 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 11:18:57.220 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 11:18:57.870 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 11:18:57.894 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 11:18:57.894 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 11:18:57.935 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 11:18:57.938 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 11:18:57.945 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 11:18:58.577 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 11:18:58.584 DEBUG 11252 --- [http-nio-9998-exec-4] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 11:18:58.590 DEBUG 11252 --- [http-nio-9998-exec-9] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 11:21:30.777 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 11:21:30.787 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 11:21:30.808 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 11:21:31.344 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 11:21:31.400 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 11:21:31.536 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 11:21:31.537 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 11:21:31.552 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 11:21:31.553 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 11:21:32.160 DEBUG 11252 --- [http-nio-9998-exec-5] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 11:21:32.162 DEBUG 11252 --- [http-nio-9998-exec-10] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 11:21:32.177 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 11:24:36.957 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 11:24:36.958 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 11:24:37.622 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 11:24:38.405 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 11:24:38.406 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-22(String)
2018-02-01 11:24:39.095 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 11:24:41.981 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 11:24:41.989 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-22(String)
2018-02-01 11:24:42.782 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 10
2018-02-01 13:46:26.784  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 13:46:26.784  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 13:46:27.054  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportPieChart
2018-02-01 13:46:27.109  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findCostHospitalReportForm
2018-02-01 13:46:27.122  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 13:46:27.142  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 13:46:27.158  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportChart
2018-02-01 13:46:27.159  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 13:46:29.426 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 13:46:29.464 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 13:46:29.553 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 13:46:42.997 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 13:46:42.997 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 13:46:43.014 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 13:46:46.985 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 13:46:46.985 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 13:46:46.999 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 13:46:47.530 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 13:46:47.551 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 13:46:47.575 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 13:46:47.576 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 13:46:47.593 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 13:46:47.598 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 13:46:47.599 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 13:46:47.600 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 13(String), 2018-02-01 13(String)
2018-02-01 13:46:47.611 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 13:46:47.674 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 13:46:47.769 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 13:46:47.806 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 13:46:47.812 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 13:46:47.821 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 13:46:48.000 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 15:12:44.780  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/getMedicareDateReport
2018-02-01 15:12:44.780  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:44.819  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/findDisease
2018-02-01 15:12:44.928  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:44.976  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/findMedicare
2018-02-01 15:12:44.976  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findDateReportChart
2018-02-01 15:12:44.977  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:44.977  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:45.043  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 15:12:45.043  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:45.090  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 15:12:45.091  INFO 11252 --- [http-nio-9998-exec-9] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:45.091 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 15:12:45.095  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 15:12:45.112  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 15:12:45.132  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:45.133  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:45.268 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 15:12:45.344  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 15:12:45.357  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 15:12:45.438 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 15:12:45.591 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 15:12:45.591 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 15:12:45.603 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 15:12:45.621 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 15:12:45.679 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 15:12:45.688 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 15:12:45.696 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 15:12:45.705 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 15:12:45.720 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 15:12:45.722 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 15:12:45.733 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 15:12:45.733 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 15:12:45.734 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 15:12:45.820 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 15:12:45.898 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 16:21:48.492  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 16:21:48.492  INFO 11252 --- [http-nio-9998-exec-1] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 16:21:48.677 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 16:21:48.677 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 16:21:48.678 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 16:22:00.824 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:00.824 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:00.837 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:01.385 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 16:22:01.385 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 16:22:01.422 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 16:22:01.422 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 16:22:01.424 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 16:22:01.475 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 16:22:01.476 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 16:22:01.477 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:22:01.477 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 16(String), 2018-02-01 16(String)
2018-02-01 16:22:01.477 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 16:22:01.477 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 16:22:01.489 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 16:22:01.638 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 16:22:01.638 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 16:22:01.643 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 16:22:05.861 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:22:05.861 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 16:22:05.861 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 16:22:05.861 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 16(String), 2018-02-01 16(String)
2018-02-01 16:22:05.872 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 16:22:05.872 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 16:22:05.879 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 16:22:05.885 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 16:22:05.964 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 16:22:05.964 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 16:22:06.008 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 16:22:06.033 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:06.034 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:06.037 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:06.079 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 16:22:06.079 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 16:22:06.143 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 16:22:06.227 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 16:22:06.906 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:06.906 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:06.909 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:07.282 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-02-01 16:22:07.282 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:07.317 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==>  Preparing: SELECT count(0) FROM costmonitoring t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-01 16:22:07.317 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:07.426 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-02-01 16:22:07.467 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.costMonitoring_COUNT         : <==      Total: 1
2018-02-01 16:22:07.467 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('constmonitor1') ORDER BY column_id 
2018-02-01 16:22:07.467 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 16:22:07.474 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-02-01 16:22:07.475 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:07.493 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 29
2018-02-01 16:22:07.606 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-02-01 16:22:08.612 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:08.612 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:08.627 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:08.889 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==>  Preparing: WITH t as ( select DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 as 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6*DRGS.支付标准价 as 百分之六十支付按标准起付最低价, round(AVG(DRGS.所用医保费用+DRGS.盈利),2) AS 医院向医保申请可支取的均费, sum(DRGS.盈利) AS 总盈亏, COUNT(DISTINCT(DRGS.住院号)) AS 总人次, round(AVG(DRGS.总费用),2) AS 总均费, round(AVG(DRGS.CQ材料费),2) AS CQ类材料均费, round(AVG(DRGS.CG材料费),2) AS CG类材料均费, --round(AVG(DRGS.超限床位费),2) AS 超标床位均费, round(AVG(DRGS.超限床位费),2) AS 超限床位均费, round(AVG(DRGS.自理金额+DRGS.自费金额),2) as 个人自理自费均费, round( AVG(DRGS.西药+DRGS.中成药+DRGS.中草药),2) as 药品均费, round(AVG(DRGS.材料费+DRGS.自负材料费),2) as 耗材均费, round(AVG(DRGS.手术费),2) as 手术费均费 from patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND DRGS.当前状态 = ? AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价 ) select nvl(sum(t.总盈亏), 0) 净盈亏, nvl(sum(t.总人次), 0) 总病例, count(1) 总病种, nvl(max(case when t.总盈亏 = (select min(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大亏损病种, nvl(max(case when t.总盈亏 = (select max(总盈亏) from t) then t.疾病名称 ||'/'|| t.手术医保名称 end), '无') 最大盈利病种 from t 
2018-02-01 16:22:08.889 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:08.890 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 16:22:08.890 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 16:22:08.905 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 16:22:08.919 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 16:22:08.919 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 16:22:08.958 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 16:22:08.992 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getMedicares_COUNT           : ==>  Preparing: SELECT count(0) FROM (SELECT DRGS.疾病编码, DRGS.主诊断 AS 疾病名称, DRGS.手术医保编码, DRGS.主手术 AS 手术医保名称, DRGS.支付标准价 AS 支付标准, 0.6 * DRGS.支付标准价 AS "支付标准60%", round(AVG(DRGS.所用医保费用 + DRGS.盈利), 2) AS 所用医保均费, sum(DRGS.盈利) AS 病种总盈亏, COUNT(DISTINCT (DRGS.住院号)) AS 总病例数, round(sum(DRGS.盈利) / COUNT(DISTINCT (DRGS.住院号)), 2) AS 病例均盈亏, round(AVG(DRGS.总费用), 2) AS 病例医疗均费, round(AVG(DRGS.CQ材料费), 2) AS CQ类材料均费, round(AVG(DRGS.CG材料费), 2) AS CG类材料均费, round(AVG(DRGS.超限床位费), 2) AS 超限床位均费, round(AVG(DRGS.自理金额), 2) AS 病例自理均费, round(AVG(DRGS.自费金额), 2) AS 病例自费均费, round(AVG(DRGS.自负金额), 2) AS 病例自负均费, round(AVG(DRGS.西药 + DRGS.中成药 + DRGS.中草药), 2) AS 药品均费, round(AVG(DRGS.材料费 + DRGS.自负材料费), 2) AS 耗材均费, round(AVG(DRGS.手术费), 2) AS 手术费均费 FROM patient_accounting DRGS WHERE DRGS.控费类型 = ? AND DRGS.医保类别 <> '现金' AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(DRGS.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY DRGS.疾病编码, DRGS.主诊断, DRGS.手术医保编码, DRGS.主手术, DRGS.支付标准价) t 
2018-02-01 16:22:09.007 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getMedicares_COUNT           : ==> Parameters: 1(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:09.022 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.disease.MedicareMapper.getTitle  : <==      Total: 1
2018-02-01 16:22:09.033 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==>  Preparing: WITH t AS ( select t.*,t2.住院号 as 实际退出病例数, t3.交易流水号, t3.项目结算扣款 FROM patient_accounting t left outer join drgs.out_medicare t2 on t.住院号 = t2.住院号 left outer join (select 交易流水号, sum(扣除金额) 项目结算扣款 from projectsettlementview group by 交易流水号) t3 on t.交易流水号 = t3.交易流水号 WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) SELECT nvl(sum(case when t.盈利 < 0 then t.盈利 else 0 end), 0) 亏金额, nvl(sum(case when t.盈利 > 0 then t.盈利 else 0 end), 0) 盈利额, nvl(max(case when t.盈利 = (select min(盈利) from t) then t.住院号 end), '无') 最大亏损病例住院号, nvl(max(case when t.盈利 = (select max(盈利) from t) then t.住院号 end), '无') 最大盈利病例住院号, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.疾病编码 || t.手术医保编码 end)), 0) 亏损病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.疾病编码 || t.手术医保编码 end)), 0) 盈利病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.疾病编码 || t.手术医保编码 end)), 0) 实付病种数, nvl(count(DISTINCT(case when t.盈亏标识 = 0 then t.住院号 end)), 0) 亏损病例数, nvl(sum(case when t.盈亏标识 = 0 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 亏损定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 1 then t.住院号 end)), 0) 盈利病例数, nvl(sum(case when t.盈亏标识 = 1 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 盈利定额结算金额, nvl(count(DISTINCT(case when t.盈亏标识 = 2 then t.住院号 end)), 0) 实付病例数, nvl(sum(case when t.盈亏标识 = 2 then (t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额) else 0 end), 0) 实付定额结算金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额), 0) 定额结算金额, nvl(floor(count(DISTINCT(t.住院号)) * 0.15), 0) 可申请退出病例数, nvl(sum(t.所用医保费用),0 ) 项目结算金额, nvl(sum(t.项目结算扣款),0) 项目扣款金额, nvl(sum(t.支付标准价 + t.CG材料费 + t.CQ材料费 + t.超限床位费 - t.自理金额 - t.自费金额 -t.所用医保费用+t.项目结算扣款),0) 盈亏结算金额, count(DISTINCT t.实际退出病例数) 实际退出病例数 FROM t 
2018-02-01 16:22:09.033 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : ==> Parameters: 1(String), 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:09.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.getMedicares_COUNT           : <==      Total: 1
2018-02-01 16:22:09.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medicare') ORDER BY column_id 
2018-02-01 16:22:09.125 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 16:22:09.151 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 20
2018-02-01 16:22:09.160 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.getTitleMsg     : <==      Total: 1
2018-02-01 16:22:09.586 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:09.586 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:09.612 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:10.017 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:22:10.017 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 16:22:10.032 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 16:22:10.102 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 16:22:10.113 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 16:22:10.125 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:10.366 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 16:22:10.376 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 16:22:10.384 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 16:22:10.384 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 16:22:10.392 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 16:22:10.408 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 16:22:10.481 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 16:22:10.481 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 16:22:10.581 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 16:22:10.581 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 16:22:10.587 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:22:10.608 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 16(String), 2018-02-01 16(String)
2018-02-01 16:22:10.686 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 16:22:10.697 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 16:22:10.738 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 16:22:10.741 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:10.741 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:10.764 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 16:22:10.793 DEBUG 11252 --- [http-nio-9998-exec-2] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 16:22:10.795 DEBUG 11252 --- [http-nio-9998-exec-6] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 16:22:10.950 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:19.657 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:19.658 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:19.669 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:20.057 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 16:22:20.076 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 16:22:20.131 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:22:20.132 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 16:22:20.132 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-02-01 16:22:20.139 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:20.751 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-02-01 16:22:20.788 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-02-01 16:22:20.790 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-02-01 16:22:24.283 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 16:22:24.283 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 16:22:24.305 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:22:24.342 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 16:22:24.345 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 16:22:24.354 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 16:22:24.356 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 16:22:24.380 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 16:22:24.385 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 16:22:24.986 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 16:22:25.009 DEBUG 11252 --- [http-nio-9998-exec-8] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 16:22:25.052 DEBUG 11252 --- [http-nio-9998-exec-2] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 16:23:13.485 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 16:23:13.486 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 16:23:14.137 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 16:23:14.944 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) || '月' AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) order by EXTRACT(MONTH FROM to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss')) 
2018-02-01 16:23:14.945 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 16:23:15.589 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 1
2018-02-01 16:23:33.068 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 16:23:33.071 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 16:23:33.896 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 10
2018-02-01 17:09:52.100  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportChart
2018-02-01 17:09:52.100  INFO 11252 --- [http-nio-9998-exec-6] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 17:09:52.108  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findPerHospitalReportPieChart
2018-02-01 17:09:52.111  INFO 11252 --- [http-nio-9998-exec-2] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 17:09:52.128  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findCostHospitalReportForm
2018-02-01 17:09:52.128  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 17:09:52.140  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-01 17:09:52.140  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-01 17:09:52.445 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-01 17:09:52.445 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-01 17:09:52.468 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-01 17:09:58.627 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:09:58.627 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:09:58.664 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:10:00.354 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:10:00.354 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:10:00.371 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:10:00.820 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-01 17:10:00.842 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-01 17:10:00.856 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 17:10:00.880 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-01 17:10:00.881 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-01 17:10:00.881 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-01 17:10:00.894 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-01 17:10:00.910 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 17:10:00.932 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-01 17:10:00.960 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-25 17(String), 2018-02-01 17(String)
2018-02-01 17:10:01.085 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-01 17:10:01.109 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-01 17:10:01.118 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-01-31 16(String), 2018-02-01 16(String)
2018-02-01 17:10:01.124 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-01 17:10:01.284 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-01 17:10:02.241 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:10:02.253 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:10:02.276 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:10:02.724 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 17:10:02.737 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:10:02.751 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 17:10:02.752 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 17:10:02.797 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-02-01 17:10:02.819 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 17:10:03.245 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:10:03.246 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:10:03.283 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:10:03.389 DEBUG 11252 --- [http-nio-9998-exec-5] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-02-01 17:10:03.424 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-02-01 17:10:03.489 DEBUG 11252 --- [http-nio-9998-exec-3] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-02-01 17:10:03.641 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(distinct(case when t.控费类型 = 1 then t.住院号 end)) doublecontrol, count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费诊断+非控费手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费诊断+控费手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 17:10:03.697 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 17:10:03.711 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==>  Preparing: select * from ( select count(distinct(case when t.控费类型 = 1 then t.住院号 end)) "控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 2 then t.住院号 end)) "控费主诊断+非控费主手术", count(distinct(case when t.控费类型 = 3 then t.住院号 end)) "非控费主诊断+控费主手术", count(distinct(case when t.控费类型 = 4 then t.住院号 end)) "非控费诊断+非控费手术" from ( select t.控费类型 , t.住院号 from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by t.住院号,t.控费类型 ) t ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 17:10:03.721 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:10:03.901 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END) "控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 2 THEN 1 ELSE 0 END) "控费诊断+非控费手术病例数", sum(CASE WHEN t.控费类型 = 3 THEN 1 ELSE 0 END) "非控费诊断+控费手术病例数", sum(CASE WHEN t.控费类型 = 4 THEN 1 ELSE 0 END) "非控费诊断+非控费手术病例数", round(((sum(CASE WHEN t.控费类型 = 1 THEN 1 ELSE 0 END)) / count(1)), 2) * 100 || '%' "控费诊断+控费手术病例数比例" FROM (SELECT t.科室, t.控费类型 FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室, t.住院号, t.控费类型) t GROUP BY t.科室) table_count 
2018-02-01 17:10:03.901 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 17:10:04.380 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findPerHospitalReportChart   : <==      Total: 0
2018-02-01 17:10:04.382 DEBUG 11252 --- [http-nio-9998-exec-10] .f.d.m.d.M.findPerHospitalReportPieChart : <==      Total: 4
2018-02-01 17:10:04.541 DEBUG 11252 --- [http-nio-9998-exec-1] d.m.d.M.findCostHospitalReportForm_COUNT : <==      Total: 1
2018-02-01 17:12:32.837 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==>  Preparing: select * from ( select sum(case when t.控费类型 = 1 then t.总费用 else 0 end) "控费主诊断+控费主手术", sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费主诊断+非控费主手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费主诊断+控费主手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 ) unpivot (count for item in ("控费主诊断+控费主手术","控费主诊断+非控费主手术","非控费主诊断+控费主手术","非控费诊断+非控费手术") ) 
2018-02-01 17:12:32.838 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : ==> Parameters: 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:32.838 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findCostHospitalReportChart  : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, sum(case when t.控费类型 = 1 then t.总费用 else 0 end) doublecontrol, sum(case when t.控费类型 = 2 then t.总费用 else 0 end) "控费诊断+非控费手术", sum(case when t.控费类型 = 3 then t.总费用 else 0 end) "非控费诊断+控费手术", sum(case when t.控费类型 = 4 then t.总费用 else 0 end) "非控费诊断+非控费手术" from patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-01 17:12:32.850 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findCostHospitalReportChart  : ==> Parameters: 出院(String), 2018-01-25(String), 2018-02-01(String)
2018-02-01 17:12:33.028 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.科室, sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END) "控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 2 THEN t.总费用 ELSE 0 END) "控费诊断+非控费手术总费用", sum(CASE WHEN t.控费类型 = 3 THEN t.总费用 ELSE 0 END) "非控费诊断+控费手术总费用", sum(CASE WHEN t.控费类型 = 4 THEN t.总费用 ELSE 0 END) "非控费诊断+非控费手术总费用", round(((sum(CASE WHEN t.控费类型 = 1 THEN t.总费用 ELSE 0 END)) / sum(t.总费用)), 2) * 100 || '%' "控费诊断+控费手术总费用比例" FROM patient_accounting t WHERE t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY t.科室) table_count 
2018-02-01 17:12:33.029 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : ==> Parameters: 出院(String), 2018-01-02(String), 2018-02-01(String)
2018-02-01 17:12:33.476 DEBUG 11252 --- [http-nio-9998-exec-3] f.d.m.d.M.findCostHospitalReportPieChart : <==      Total: 0
2018-02-01 17:12:33.511 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findCostHospitalReportChart  : <==      Total: 0
2018-02-01 17:12:33.516 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:12:33.516 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:12:33.521 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:12:33.695 DEBUG 11252 --- [http-nio-9998-exec-10] indCostHospitalReportTotalCostForm_COUNT : <==      Total: 1
2018-02-01 17:12:35.579 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:12:35.579 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:12:35.600 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:12:36.016 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:12:36.046 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:36.048 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:12:36.049 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:12:36.060 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:36.062 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:12:36.078 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:12:36.078 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:36.093 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-01 17:12:36.094 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:36.190 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:12:36.199 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-01 17:12:36.224 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:12:36.231 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:36.243 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-01 17:12:36.257 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 17:12:36.329 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-01 17:12:36.358 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:12:47.874 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:12:47.874 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:12:47.879 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:12:48.127 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:12:48.127 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:48.129 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:12:48.129 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:12:48.129 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:48.130 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:12:48.130 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:12:48.130 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:48.203 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-01 17:12:48.203 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:48.227 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:12:48.227 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:12:48.227 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 2(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:48.309 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-01 17:12:48.309 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizsstz') ORDER BY column_id 
2018-02-01 17:12:48.309 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 17:12:48.328 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-01 17:12:48.328 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:12:49.853 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-01 17:12:49.853 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-01 17:12:49.910 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-01 17:12:49.910 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:49.911 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:12:49.912 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:49.913 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:12:49.913 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:12:49.913 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:49.932 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-01 17:12:49.942 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:12:49.953 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:12:49.953 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:50.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-01 17:12:50.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-01 17:12:50.016 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 17:12:50.035 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-01 17:12:50.052 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:12:50.053 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:12:50.085 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-01(String)
2018-02-01 17:12:50.182 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:18:36.652 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-01 17:18:36.652 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 17:18:36.757 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-01 17:18:36.790 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ             : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-02-01 17:18:36.790 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ             : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 17:18:36.912 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:18:36.912 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 17:18:36.934 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:18:36.945 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:18:36.945 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 17:18:36.969 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:18:36.990 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:18:36.990 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 17:18:37.090 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.findFeiKongFeiTZ             : <==      Total: 1
2018-02-01 17:18:37.103 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-01 17:18:37.103 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 17:18:37.107 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:18:37.116 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:18:37.116 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-01(String)
2018-02-01 17:18:37.121 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-01 17:18:37.231 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:18:37.804 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-01 17:18:37.804 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 17:18:37.806 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:18:37.806 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 17:18:37.819 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:18:37.819 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-01 17:18:37.820 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 17:18:37.842 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-01 17:18:37.842 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:18:37.843 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 17:18:37.910 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-01 17:18:37.911 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ             : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-02-01 17:18:37.911 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ             : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 17:18:37.953 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:18:37.954 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-01 17:18:37.954 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-01 17:18:38.072 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.M.findFeiKongFeiTZ             : <==      Total: 1
2018-02-01 17:18:38.072 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-01 17:18:38.082 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-01 17:18:38.084 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-01 17:18:38.102 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-01 17:24:00.478 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findZhiFuBZ     : ==>  Preparing: select t.id,t.diseasecode,t.diseasename,t.medicarecode,t.medicarename,t.payment from disease t 
2018-02-01 17:24:00.478 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findZhiFuBZ     : ==> Parameters: 
2018-02-01 17:24:00.565 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.d.MedicareMapper.findZhiFuBZ     : <==      Total: 108
2018-02-02 09:24:08.486  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-02 09:24:08.496  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-02 09:24:08.605  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/getFeiKongFeiTitle
2018-02-02 09:24:08.605  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-02 09:24:08.689  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/findFeiKongFeiTZ
2018-02-02 09:24:08.705  INFO 11252 --- [http-nio-9998-exec-7] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-02 09:24:10.272 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-02 09:24:10.357 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-02 09:24:10.696 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-02 10:39:24.470  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-02 10:39:24.470  INFO 11252 --- [http-nio-9998-exec-10] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-02 10:39:24.716 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-02 10:39:24.717 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-02 10:39:24.758 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-02 11:34:13.597  INFO 11252 --- [http-nio-9998-exec-3] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-02 11:34:13.597  INFO 11252 --- [http-nio-9998-exec-3] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-02 11:34:13.942 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-02 11:34:13.963 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-02 11:34:13.975 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-05 09:33:35.620  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-05 09:33:35.647  INFO 11252 --- [http-nio-9998-exec-5] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-05 09:33:36.151 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-05 09:33:36.245 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-05 09:33:36.384 DEBUG 11252 --- [http-nio-9998-exec-6] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-05 10:51:24.599  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/disease/getFilterData
2018-02-05 10:51:24.599  INFO 11252 --- [http-nio-9998-exec-8] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-05 10:51:24.827 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==>  Preparing: select * from portal.base_user t where t.login_name = ? 
2018-02-05 10:51:24.827 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : ==> Parameters: admin(String)
2018-02-05 10:51:24.855 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.user.UserMapper.findUserByLogin  : <==      Total: 1
2018-02-05 10:51:25.048  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : 访问接口=======/drgs/webservice/medicare/getFeiKongFeiTitle
2018-02-05 10:51:25.048  INFO 11252 --- [http-nio-9998-exec-4] c.f.drgs.shiro.cas.filter.UserFilter     : http://172.16.3.18:8082/cas/login?service=http://172.16.7.44:9998/drgs/shiro-cas
2018-02-05 10:51:33.172 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-05 10:51:33.173 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-05 10:51:33.190 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-05 10:51:36.472 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-05 10:51:36.473 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-05 10:51:36.515 DEBUG 11252 --- [http-nio-9998-exec-9] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-05 10:51:40.231 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-05 10:51:40.241 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-05 10:51:40.297 DEBUG 11252 --- [http-nio-9998-exec-3] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-05 10:51:40.824 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==>  Preparing: select distinct t.diseasecode id, t.bak dspell, t.diseasename text from disease t 
2018-02-05 10:51:40.839 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : ==> Parameters: 
2018-02-05 10:51:40.861 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==>  Preparing: select distinct t.medicarecode id, t.bak1 mspell, t.medicarename text from disease t 
2018-02-05 10:51:40.918 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('medciare_complete_datareport') ORDER BY column_id 
2018-02-05 10:51:40.935 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : ==> Parameters: 
2018-02-05 10:51:40.941 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-05 10:51:40.961 DEBUG 11252 --- [http-nio-9998-exec-10] c.f.d.m.d.DiseaseMapper.findDisease      : <==      Total: 47
2018-02-05 10:51:40.971 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 6
2018-02-05 10:51:40.995 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==>  Preparing: select to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') AS sign, to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') AS name, count(DISTINCT t.住院号) 病例数 from patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1/24 group by to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'MM')||'-' ||to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'dd') ,to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd') order by to_date(to_char(to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss'),'yyyy-MM-dd'),'yyyy-MM-dd') 
2018-02-05 10:51:41.050 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : ==> Parameters: 1(String), 出院(String), 2018-01-29 10(String), 2018-02-05 10(String)
2018-02-05 10:51:41.151 DEBUG 11252 --- [http-nio-9998-exec-2] c.f.d.m.d.M.findDateReportChart          : <==      Total: 0
2018-02-05 10:51:41.175 DEBUG 11252 --- [http-nio-9998-exec-8] c.f.d.m.d.DiseaseMapper.findMedicare     : <==      Total: 100
2018-02-05 10:51:41.189 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==>  Preparing: SELECT count(0) FROM (SELECT t.疾病编码 疾病编码, t.主诊断 疾病名称, t.手术医保编码 手术医保编码, t.主手术 手术医保名称, avg(t.支付标准价) 支付标准, nvl(count(DISTINCT t.住院号), 0) AS 病例数 FROM (SELECT 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术, avg(支付标准价) 支付标准价 FROM patient_accounting t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.医保类别 IN ('新市医保', '新省值医保', '新省一卡通', '省异地就医', '现金') AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 GROUP BY 住院号, 疾病编码, 主诊断, 手术医保编码, 主手术) t GROUP BY t.疾病编码, t.主诊断, t.手术医保编码, t.主手术) table_count 
2018-02-05 10:51:41.209 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : ==> Parameters: 1(String), 出院(String), 2018-02-04 16(String), 2018-02-05 16(String)
2018-02-05 10:51:41.473 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findMedicareDateReport_COUNT : <==      Total: 1
2018-02-05 10:51:42.835 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==>  Preparing: select text, value, type from drgs_dictionary 
2018-02-05 10:51:42.835 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : ==> Parameters: 
2018-02-05 10:51:42.854 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.DiseaseMapper.getFilterData    : <==      Total: 39
2018-02-05 10:51:43.209 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-05 10:51:43.217 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-05(String)
2018-02-05 10:51:43.218 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-05 10:51:43.252 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-05 10:51:43.252 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-05(String)
2018-02-05 10:51:43.293 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-05 10:51:43.305 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-05 10:51:43.347 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-05(String)
2018-02-05 10:51:43.347 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-05 10:51:43.348 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-05(String)
2018-02-05 10:51:43.447 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-05 10:51:43.467 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-05 10:51:43.484 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-05 10:51:43.521 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2018-01-01(String), 2018-02-05(String)
2018-02-05 10:51:43.535 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-05 10:51:43.536 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-05 10:51:43.582 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-05 10:51:43.619 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-05 11:00:47.973 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-05 11:00:47.976 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-05(String)
2018-02-05 11:00:48.007 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-05 11:00:48.127 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-05 11:00:48.145 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-05(String)
2018-02-05 11:00:48.160 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-05 11:00:48.175 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-05(String)
2018-02-05 11:00:48.212 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-05 11:00:48.242 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-05 11:00:48.242 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-05(String)
2018-02-05 11:00:48.250 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-05 11:00:48.301 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ             : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-02-05 11:00:48.301 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ             : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-05(String)
2018-02-05 11:00:48.395 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-05 11:00:48.412 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-05 11:00:48.412 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-05(String)
2018-02-05 11:00:48.486 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.M.findFeiKongFeiTZ             : <==      Total: 1
2018-02-05 11:00:48.498 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-05 11:00:48.498 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-05 11:00:48.536 DEBUG 11252 --- [http-nio-9998-exec-1] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-05 11:00:48.539 DEBUG 11252 --- [http-nio-9998-exec-7] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-05 11:00:49.337 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-05 11:00:49.367 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-05 11:00:49.400 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-05 11:00:49.407 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==>  Preparing: SELECT count(0) FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') + 1 
2018-02-05 11:00:49.407 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-05 11:00:49.419 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==>  Preparing: select nvl(count(distinct t.住院号),0) 调整病例数, nvl(sum(t.调整后盈利),0) 调整后盈利 from noncontrolup t WHERE t.启用状态标识 = 1 AND t.调整原因 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 
2018-02-05 11:00:49.480 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-05 11:00:49.519 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle1          : <==      Total: 1
2018-02-05 11:00:49.544 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ_COUNT       : <==      Total: 1
2018-02-05 11:00:49.564 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ             : ==>  Preparing: SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( select * FROM feikongfeitzdata t WHERE t.控费类型 = ? AND t.医保类别 <> '现金' AND t.当前状态 = ? AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(t.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 order by 最后费用日期 desc ) TMP_PAGE WHERE ROWNUM <= 10 
2018-02-05 11:00:49.581 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-05 11:00:49.612 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-05 11:00:49.613 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ             : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-05 11:00:49.727 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
2018-02-05 11:00:49.823 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==>  Preparing: select count(1) 总病例 from ( select 住院号 from patient_accounting p WHERE p.控费类型 = ? AND p.医保类别 <> '现金' AND p.当前状态 = ? AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') >= to_date(?, 'yyyy-MM-dd hh24:mi:ss') AND to_date(p.出院日期, 'yyyy-MM-dd hh24:mi:ss') < to_date(?, 'yyyy-MM-dd hh24:mi:ss') +1 group by 住院号 ) p 
2018-02-05 11:00:49.824 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : ==> Parameters: 3(String), 出院(String), 2017-12-01(String), 2018-02-28(String)
2018-02-05 11:00:49.879 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.M.findFeiKongFeiTZ             : <==      Total: 1
2018-02-05 11:00:49.880 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==>  Preparing: select COLUMN_NAME as COLUMN_NAME,DATA_TYPE as DATA_TYPE from user_tab_cols where table_name = upper('feikongfeizzdtz') ORDER BY column_id 
2018-02-05 11:00:49.898 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : ==> Parameters: 
2018-02-05 11:00:49.937 DEBUG 11252 --- [http-nio-9998-exec-5] c.f.d.m.d.MedicareMapper.findcolType     : <==      Total: 32
2018-02-05 11:00:49.957 DEBUG 11252 --- [http-nio-9998-exec-4] c.f.d.m.d.M.getFeiKongFeiTitle2          : <==      Total: 1
